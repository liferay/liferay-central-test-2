<?xml version="1.0"?>

<project name="modules" basedir="." default="compile">
	<property name="project.dir" value="../.." />

	<import file="../../build-common-java.xml" />

	<target name="clean">
		<delete dir="${app.server.parent.dir}/osgi" />

		<gradle-execute
			gradleTask="clean"
		/>
	</target>

	<target name="compile">
		<gradle-execute
			gradleTask="compileJava"
		/>
	</target>

	<target name="deploy">
		<mkdir dir="${app.server.parent.dir}/osgi/core" />
		<mkdir dir="${app.server.parent.dir}/osgi/portal" />

		<copy todir="${app.server.parent.dir}/osgi/core" preservelastmodified="true">
			<fileset dir="${project.dir}/osgi/lib/${module.framework.implementation}/core" includes="*.jar" />
		</copy>

		<copy todir="${app.server.parent.dir}/osgi/portal" preservelastmodified="true">
			<fileset dir="${project.dir}/osgi/lib/common/portal" includes="*.jar" />
			<fileset dir="${project.dir}/osgi/lib/${module.framework.implementation}/portal" includes="*.jar" />
		</copy>

		<gradle-execute
			gradleTask="deploy"
		/>
	</target>

	<target name="jar">
		<gradle-execute
			gradleTask="jar"
		/>
	</target>

	<target name="test">
		<gradle-execute
			gradleTask="test"
		/>
	</target>
</project>