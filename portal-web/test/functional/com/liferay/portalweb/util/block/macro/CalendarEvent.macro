<definition>
	<command name="addAllDayEventViaScheduler">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="#sikuliClick" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_FIELD_PNG" />
		<execute function="#type" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />

		<if>
			<isset var="calendarName" />
			<then>
				<execute function="#select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</then>
		</if>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_SAVE_BUTTON" value1="Save" />
	</command>

	<command name="addCommentPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute macro="CalendarEvent#assertDialogBoxPresentCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />
		<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_BE_THE_FIRST" value1="Be the first." />

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">

					<if>
						<condition function="#isElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_ADD_COMMENT_LINK" />
						<then>
							<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_ADD_COMMENT_LINK" value1="Add Comment" />
							<execute function="#makeVisible" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" />
							<execute function="#type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />
						</then>
						<else>
							<execute function="#type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />
						</else>
					</if>

					<if>
						<condition function="#isElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" />
						<then>
							<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
						</then>
						<else>
							<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_REPLY_BUTTON" value1="Reply" />
						</else>
					</if>

					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#SUCCESS_MESSAGE" value1="Your request processed successfully." />
				</for>
			</then>
			<else>
				<execute function="#type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />

				<if>
					<condition function="#isElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" />
					<then>
						<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
					</then>
					<else>
						<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_REPLY_BUTTON" value1="Reply" />
					</else>
				</if>

				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#SUCCESS_MESSAGE" value1="Your request processed successfully." />
			</else>
		</if>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_eventComment" value="${eventComment}" />
					<var name="key_user" value="${user}" />

					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_eventComment" value="${eventComment}" />
				<var name="key_user" value="${user}" />

				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="addPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#click" locator1="PGCalendar#ADD_EVENT_BUTTON" value1="Add Event" />
		<execute function="#assertClick" locator1="PGCalendar#ADD_EVENT_BUTTON" value1="Add Event" />

		<execute function="#selectFrame" locator1="PGCalendarAddevent#ADD_EVENT_IFRAME" />
		<execute function="#pause" value1="1000" />
		<execute function="#type" locator1="PGCalendarAddevent#TITLE_FIELD" value1="${eventTitle}" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#START_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#START_DATE_TIME" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#END_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#END_DATE_TIME" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="#assertNotChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="#assertNotChecked" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />

				<var locator="END_DATE" name="endDate" path="PGCalendarAddevent" />
				<var locator="END_DATE_TIME" name="endDateTime" path="PGCalendarAddevent" />
				<var locator="START_DATE" name="startDate" path="PGCalendarAddevent" />
				<var locator="START_DATE_TIME" name="startDateTime" path="PGCalendarAddevent" />

				<execute macro="CalendarEvent#selectCalendarPG" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>

				<execute macro="CalendarEvent#savePGCmd" />

				<var name="key_endDate" value="${endDate}" />
				<var name="key_endDateTime" value="${endDateTime}" />
				<var name="key_startDate" value="${startDate}" />
				<var name="key_startDateTime" value="${startDateTime}" />

				<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR" />
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR_TITLE" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<var name="endDateTime" value="11:59 PM" />
					<var name="startDateTime" value="12:00 AM" />

					<execute function="#check" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
					<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#START_DATE_TIME" />
					<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#END_DATE_TIME" />

					<var locator="END_DATE" name="endDate" path="PGCalendarAddevent" />
					<var locator="START_DATE" name="startDate" path="PGCalendarAddevent" />

					<execute macro="CalendarEvent#selectCalendarPG" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>

					<execute macro="CalendarEvent#savePGCmd" />

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<if>
						<equals arg1="${reminders}" arg2="true" />
						<then>
							<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_WITH_REMINDER" />
							<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_TITLE_WITH_REMINDER" value1="${eventTitle}" />
						</then>
						<else>
							<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY" />
							<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_TITLE" value1="${eventTitle}" />
						</else>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<var locator="END_DATE" name="endDate" path="PGCalendarAddevent" />
					<var locator="END_DATE_TIME" name="endDateTime" path="PGCalendarAddevent" />
					<var locator="START_DATE" name="startDate" path="PGCalendarAddevent" />
					<var locator="START_DATE_TIME" name="startDateTime" path="PGCalendarAddevent" />

					<execute function="#check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
					<execute function="#select" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
					<execute function="#assertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
					<execute function="#assertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />

					<if>
						<isset var="position" />
						<then>
							<execute function="#click" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_RADIO" />
							<execute function="#select" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_POSITION_DROPDOWN" value1="${position}" />
							<execute function="#select" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_WEEKDAY_DROPDOWN" value1="${weekday}" />
						</then>
					</if>

					<if>
						<isset var="numberOfOccurrences" />
						<then>
							<execute function="#click" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_RADIO" />
							<execute function="#pause" value1="1000" />
							<execute function="#type" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_FIELD" value1="${numberOfOccurrences}" />
						</then>
					</if>

					<execute function="#pause" value1="1000" />
					<execute function="#click" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" />
					<execute function="#pause" value1="1000" />

					<if>
						<and>
							<isset var="position" />
							<isset var="numberOfOccurrences" />
						</and>
						<then>
							<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency} On ${position} ${weekday}, ${numberOfOccurrences} Times" />
						</then>
						<elseif>
							<isset var="position" />
							<then>
								<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency} On ${position} ${weekday}" />
							</then>
						</elseif>
						<elseif>
							<isset var="numberOfOccurrences" />
							<then>
								<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency}, ${numberOfOccurrences} Times" />
							</then>
						</elseif>
					</if>

					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
					<execute function="#click" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
					<execute function="#check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />

					<execute macro="CalendarEvent#selectCalendarPG" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>

					<execute macro="CalendarEvent#savePGCmd" />

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addCommentPG">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>

		<if>
			<equals arg1="${addRSVPEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addRSVPPG">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="rsvp" value="${rsvp}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="addRSVPPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
		<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_rsvp" value="${rsvp}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_ACTIVE" value1="${rsvp}" />
		<execute function="#pause" value1="3000" />
		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
		<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_INACTIVE" value1="${rsvp}" />
	</command>

	<command name="addSetTimePG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#assertClick" locator1="PGCalendar#ADD_EVENT_BUTTON" value1="Add Event" />

		<execute function="#selectFrame" locator1="PGCalendarAddevent#ADD_EVENT_IFRAME" />
		<execute function="#type" locator1="PGCalendarAddevent#TITLE_FIELD" value1="${eventTitle}" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#START_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#START_DATE_TIME" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#END_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#END_DATE_TIME" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="#assertNotChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="#assertNotChecked" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
				<execute function="#type" locator1="PGCalendarAddevent#START_DATE_TIME" value1="${setStartDateTime}" />
				<execute function="#type" locator1="PGCalendarAddevent#END_DATE_TIME" value1="${setEndDateTime}" />

				<var locator="START_DATE" name="startDate" path="PGCalendarAddevent" />
				<var name="endDate" value="${startDate}" />

				<execute function="#type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />

				<execute macro="CalendarEvent#selectCalendarPG" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>

				<execute macro="CalendarEvent#savePGCmd" />

				<var name="key_endDate" value="${endDate}" />
				<var name="key_endDateTime" value="${setEndDateTime}" />
				<var name="key_startDate" value="${startDate}" />
				<var name="key_startDateTime" value="${setStartDateTime}" />

				<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR" />
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR_TITLE" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="#type" locator1="PGCalendarAddevent#START_DATE_TIME" value1="${setStartDateTime}" />
					<execute function="#type" locator1="PGCalendarAddevent#END_DATE_TIME" value1="${setEndDateTime}" />

					<var locator="START_DATE" name="startDate" path="PGCalendarAddevent" />
					<var name="endDate" value="${startDate}" />

					<execute function="#type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />
					<execute function="#check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
					<execute function="#assertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="Daily" />
					<execute function="#assertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />
					<execute function="#click" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_RADIO" />
					<execute function="#type" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_FIELD" value1="1" />
					<execute function="#click" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" />
					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" value1="Daily, 1 Times" />
					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
					<execute function="#check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="Daily, 1 Times" />

					<execute macro="CalendarEvent#selectCalendarPG" />

					<execute function="#click" locator1="PGCalendarAddevent#SAVE_BUTTON" />
					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
					<execute function="#selectFrame" value1="relative=top" />

					<execute macro="Page#gotoPG">
						<var name="pageName" value="${pageName}" />
					</execute>

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${setEndDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${setStartDateTime}" />

					<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addCommentPG">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${setEndDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${setStartDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="assertDialogBoxPresentCmd">
		<if>
			<equals arg1="${schedulerEventDialogBox}" arg2="false" />
			<then>
				<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</then>
			<else>
				<execute function="#assertSelectedLabel" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</else>
		</if>
	</command>

	<command name="changeCalendarViaQuickEditPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
		<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarDefaultName}" />
		<execute function="#select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_SAVE_BUTTON" value1="Save" />

		<if>
			<condition function="#isElementPresent" locator1="PGCalendarRecurringEventDialogBox#RECURRING_EVENT_DIALOG_BOX_HEADER" />
			<then>
				<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series" />
			</then>
		</if>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
	</command>

	<command name="changeViewPG">
		<if>
			<equals arg1="${viewType}" arg2="Day" />
			<then>
				<if>
					<condition function="#isElementNotPresent" locator1="PGCalendar#VIEW_DAY_BUTTON_ACTIVE" />
					<then>
						<execute function="#assertClick" locator1="PGCalendar#VIEW_DAY_BUTTON" value1="${viewType}" />
					</then>
				</if>

				<execute function="#assertElementPresent" locator1="PGCalendarDayView#SCHEDULER_VIEW_DAY" />
			</then>
			<elseif>
				<equals arg1="${viewType}" arg2="Week" />
				<then>
					<if>
						<condition function="#isElementNotPresent" locator1="PGCalendar#VIEW_WEEK_BUTTON_ACTIVE" />
						<then>
							<execute function="#assertClick" locator1="PGCalendar#VIEW_WEEK_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_VIEW_WEEK" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${viewType}" arg2="Month" />
				<then>
					<if>
						<condition function="#isElementNotPresent" locator1="PGCalendar#VIEW_MONTH_BUTTON_ACTIVE" />
						<then>
							<execute function="#assertClick" locator1="PGCalendar#VIEW_MONTH_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="#assertElementPresent" locator1="PGCalendarMonthView#SCHEDULER_VIEW_MONTH" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${viewType}" arg2="Agenda" />
				<then>
					<if>
						<condition function="#isElementNotPresent" locator1="PGCalendar#VIEW_AGENDA_BUTTON_ACTIVE" />
						<then>
							<execute function="#assertClick" locator1="PGCalendar#VIEW_AGENDA_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="#assertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_VIEW_AGENDA" />
				</then>
			</elseif>
		</if>
	</command>

	<command name="deleteCommentPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<condition function="#isVisible" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" />
			<then>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
			</then>
			<else>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE_GUEST" value1="${eventTitle}" />
			</else>
		</if>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_eventComment" value="${eventComment}" />

		<if>
			<equals arg1="${soPage}" arg2="true" />
			<then>
				<execute function="#assertClickNoError" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="#confirm" locator1="PGCalendarVieweventdetails#CONFIRMATION" value1="Are you sure you want to delete the selected comment?" />
			</then>
			<else>
				<execute function="#assertClickNoError" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="#confirm" locator1="PGCalendarVieweventdetails#CONFIRMATION" value1="Are you sure you want to delete this? It will be deleted immediately." />
			</else>
		</if>

		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_SUCCESS" value1="Your request processed successfully." />

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="deletePG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute function="#assertClickNoError" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="#confirm" locator1="PGCalendar#CONFIRMATION" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />
		<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="#assertTextNotPresent" value1="${eventTitle}" />
	</command>

	<command name="deleteRepeatingEventViaAgendaViewPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<or>
				<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
			</or>
			<then>
				<execute function="#assertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="#assertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute function="#assertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
		<execute function="#pause" value1="1000" />
		<execute function="#clickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="#pause" value1="1000" />

		<if>
			<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
			<then>
				<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series" />

				<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_FOLLOWING_BUTTON" value1="All Following" />

					<execute function="#assertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
				<then>
					<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ONLY_THIS_INSTANCE_BUTTON" value1="Only This Instance" />

					<execute function="#assertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>
	</command>

	<command name="deleteViaAgendaViewPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="#assertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute function="#assertClickNoError" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="#confirm" locator1="PGCalendar#CONFIRMATION" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="#assertTextNotPresent" value1="${eventTitle}" />
	</command>

	<command name="editAllDayEventViaScheduler">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
		<execute function="#type" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitleEdit}" />

		<if>
			<isset var="calendarName" />
			<then>
				<execute function="#select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</then>
		</if>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_SAVE_BUTTON" value1="Save" />
	</command>

	<command name="editCommentPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<condition function="#isVisible" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" />
			<then>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
			</then>
			<else>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE_GUEST" value1="${eventTitle}" />
			</else>
		</if>

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_eventComment" value="${eventComment}" />

		<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT" value1="Edit" />
		<execute function="#type" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT_BODY_FIELD" value1="${eventCommentEdit}" />
		<execute function="#assertClick" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT_PUBLISH_BUTTON" value1="Publish" />

		<var name="key_eventComment" value="${eventCommentEdit}" />

		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventCommentEdit}" />
		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="editPG">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="#selectFrame" locator1="PGCalendarEditevent#EDIT_EVENT_IFRAME" />

		<if>
			<equals arg1="${eventType}" arg2="All Day" />
			<then>
				<var name="endDateTime" value="11:59 PM" />
				<var name="startDateTime" value="12:00 AM" />

				<execute function="#assertChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#START_DATE_TIME" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#END_DATE_TIME" />

				<var locator="END_DATE" name="endDate" path="PGCalendarEditevent" />
				<var locator="START_DATE" name="startDate" path="PGCalendarEditevent" />

				<execute function="#assertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
				<execute function="#type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
				<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
				<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Regular" />
				<then>
					<execute function="#assertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
					<execute function="#type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

					<var locator="END_DATE" name="endDate" path="PGCalendarEditevent" />
					<var locator="START_DATE" name="startDate" path="PGCalendarEditevent" />

					<execute function="#type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="#click" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="#type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="#click" locator1="PGCalendarEditevent#END_DATE_TIME" />
					<execute function="#pause" value1="1000" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="#assertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
					<execute function="#type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
					<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

					<var locator="END_DATE" name="endDate" path="PGCalendarEditevent" />
					<var locator="START_DATE" name="startDate" path="PGCalendarEditevent" />

					<execute function="#type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="#click" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="#type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="#click" locator1="PGCalendarEditevent#END_DATE_TIME" />
					<execute function="#pause" value1="1000" />
					<execute function="#assertChecked" locator1="PGCalendarEditevent#REPEAT_CHECKBOX" />
					<execute function="#assertTextEquals" locator1="PGCalendarEditevent#REPEAT_SUMMARY_1" value1="Daily, 1 Times" />
					<execute function="#click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

					<if>
						<condition function="#isElementPresent" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" />
						<then>
							<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
						</then>
					</if>

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>
				</then>
			</elseif>
		</if>

		<execute function="#click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

		<if>
			<equals arg1="${inviteResource}" arg2="true" />
			<then>
				<execute function="#assertElementPresent" locator1="PGCalendarAreYouSureDialogBox#ARE_YOU_SURE_DIALOG_BOX_HEADER" value1="Are you sure?" />
				<execute function="#assertTextEquals" locator1="PGCalendarAreYouSureDialogBox#ARE_YOU_SURE_DIALOG_BOX_BODY" value1="You are about to make changes that will only affect your calendar (${calendarName})." />
				<execute function="#assertClick" locator1="PGCalendarAreYouSureDialogBox#SAVE_CHANGES_BUTTON" value1="Save changes." />
			</then>
		</if>

		<execute function="#assertTextEquals" locator1="PGCalendarEditevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="#selectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<var name="key_eventTitle" value="${eventTitleEdit}" />

		<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="editViaAgendaViewPG">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="#selectFrame" locator1="PGCalendarEditevent#EDIT_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
		<execute function="#type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
		<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
		<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
		<execute function="#assertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

		<var locator="END_DATE" name="endDate" path="PGCalendarEditevent" />
		<var locator="START_DATE" name="startDate" path="PGCalendarEditevent" />

		<execute function="#type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="#click" locator1="PGCalendarEditevent#START_DATE_TIME" />
		<execute function="#type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
		<execute function="#click" locator1="PGCalendarEditevent#END_DATE_TIME" />
		<execute function="#pause" value1="1000" />
		<execute function="#click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

		<execute function="#assertTextEquals" locator1="PGCalendarEditevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="#selectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="#assertTextEquals" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="inviteResource">
		<if>
			<condition function="#isElementPresent" locator1="PGCalendarAddevent#INVITATIONS_PANEL_COLLAPSED" />
			<then>
				<execute function="#click" locator1="PGCalendarAddevent#INVITATIONS_PANEL_COLLAPSED" />
				<execute function="#assertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_PANEL_EXPANDED" />
			</then>
		</if>

		<for list="${resourceNameList}" param="resourceName" >
			<execute function="#type" locator1="PGCalendarAddevent#INVITATIONS_INVITE_RESOURCE_FIELD" value1="${resourceName}" />

			<var name="key_resource" value="${resourceName}" />

			<execute function="#click" locator1="PGCalendarAddevent#INVITATIONS_INVITE_RESOURCE_FIELD_LIST" value1="${resourceName}" />
			<execute function="#assertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_PENDING" value1="${resourceName}" />
		</for>
	</command>

	<command name="optionsCmd">
		<if>
			<equals arg1="${viewPermission}" arg2="true" />
			<then>
				<execute function="#select" locator1="PGCalendarAddevent#DETAILS_PERMISSIONS_VIEWABLE_BY_SELECT" value1="${viewPermissionValue}" />
			</then>
		</if>

		<if>
			<equals arg1="${permissions}" arg2="true" />
			<then>
				<var name="key_permissionDefinitionKey" value="${permissionDefinitionKey}" />
				<var name="key_roleName" value="${roleName}" />

				<execute function="#check" locator1="PGCalendarAddevent#DETAILS_PERMISSIONS_CHECKBOX" />
			</then>
		</if>

		<if>
			<equals arg1="${inviteResource}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#inviteResource" />
			</then>
		</if>

		<if>
			<equals arg1="${reminders}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#reminders" />
			</then>
		</if>

		<if>
			<equals arg1="${resourcesAvailability}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#resourcesAvailability" />
			</then>
		</if>

		<if>
			<equals arg1="${tag}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#tag" />
			</then>
		</if>
	</command>

	<command name="rate4StarsPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute macro="CalendarEvent#assertDialogBoxPresentCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />
		<execute function="#click" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_CLICK_4" />

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="reminders">
		<if>
			<condition function="#isElementPresent" locator1="PGCalendarAddevent#REMINDERS_PANEL_COLLAPSED" />
			<then>
				<execute function="#click" locator1="PGCalendarAddevent#REMINDERS_PANEL_COLLAPSED" />
				<execute function="#assertElementPresent" locator1="PGCalendarAddevent#REMINDERS_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="#check" locator1="PGCalendarAddevent#REMINDERS_EMAIL_CHECKBOX_1" />
		<execute function="#check" locator1="PGCalendarAddevent#REMINDERS_EMAIL_CHECKBOX_2" />

		<execute function="#type" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_ACTIVE_1" value1="${number1}" />
		<execute function="#type" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_ACTIVE_2" value1="${number2}" />

		<execute function="#select" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_ACTIVE_1" value1="${duration1}" />
		<execute function="#select" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_ACTIVE_2" value1="${duration2}" />

		<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_INACTIVE_1" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_INACTIVE_2" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_INACTIVE_1" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_INACTIVE_2" />
	</command>

	<command name="resourcesAvailability">
		<if>
			<condition function="#isElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
			<then>
				<execute function="#click" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
				<execute function="#assertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_SCHEDULER_EVENT_GENERIC" />
	</command>

	<command name="savePGCmd">
		<execute function="#click" locator1="PGCalendarAddevent#SAVE_BUTTON" />
		<execute function="#assertTextEquals" locator1="PGCalendarAddevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="#selectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>
	</command>

	<command name="selectCalendarPG">
		<if>
			<isset var="calendarName" />
			<then>
				<if>
					<condition function="#isElementPresent" locator1="PGCalendarAddevent#DETAILS_PANEL_COLLAPSED" />
					<then>
						<execute function="#click" locator1="PGCalendarAddevent#DETAILS_PANEL_COLLAPSED" />
						<execute function="#assertElementPresent" locator1="PGCalendarAddevent#DETAILS_PANEL_EXPANDED" />
					</then>
				</if>

				<execute function="#select" locator1="PGCalendarAddevent#DETAILS_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
		</if>
	</command>

	<command name="tag">
		<if>
			<condition function="#isElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_COLLAPSED" />
			<then>
				<execute function="#click" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_COLLAPSED" />
				<execute function="#assertElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="#assertElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" />

		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="#type" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
					<execute function="#assertClick" locator1="PGCalendarAddevent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
					<execute function="#assertTextEquals" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="#assertClick" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" />
				<execute function="#type" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
				<execute function="#assertClick" locator1="PGCalendarAddevent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
				<execute function="#assertTextEquals" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
			</else>
		</if>
	</command>

	<command name="tearDownPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="i" value="1" />

		<while>
			<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
			<then>
				<execute function="#click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />

				<if>
					<condition function="#isElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
					<then>
						<var name="i" value="${i?increment()}" />

						<execute function="#click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
					</then>
				</if>
			</then>
		</while>

		<execute function="#pause" value1="1000" />
		<execute function="#clickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="#confirm" locator1="PGCalendarAgendaView#CONFIRMATION" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<if>
			<condition function="#isElementPresent" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" />
			<then>
				<execute function="#assertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
			</then>
		</if>

		<execute function="#assertTextEquals" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_GENERIC" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_REPEATING" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewAgendaPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="#refresh" />

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="#assertElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="#assertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var name="i" value="${i?increment()}" />
			</then>
		</while>

		<execute function="#assertTextNotPresent" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
	</command>

	<command name="viewColorDefaultPG">
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR_DEFAULT" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR_DEFAULT" />
	</command>

	<command name="viewColorPG">
		<var name="key_backgroundColor" value="${eventBackgroundColorRGB}" />
		<var name="key_eventTitle" value="${eventTitle}" />
		<var name="key_fontColor" value="${eventFontColorRGB}" />

		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR" />
		<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR_DEFAULT" />
		<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR_DEFAULT" />
	</command>

	<command name="viewCommentPG">
		<execute macro="CalendarEvent#viewEventDetailsPG" />

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_eventComment" value="${eventComment}" />
					<var name="key_user" value="${user}" />

					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_eventComment" value="${eventComment}" />
				<var name="key_user" value="${user}" />

				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="viewDayPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="#refresh" />
		<execute function="#pause" value1="1000" />

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="#assertElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="#assertTextEquals" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var name="i" value="${i?increment()}" />
			</then>
		</while>
	</command>

	<command name="viewDefaultDayPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="#refresh" />
		<execute function="#pause" value1="1000" />

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#pause" value1="1000" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarDayView#SCHEDULER_EVENT_SPECIFIC" />
	</command>

	<command name="viewDefaultPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="#refresh" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarDayView#SCHEDULER_EVENT_SPECIFIC" />

		<execute function="#assertTextNotPresent" value1="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="#assertTextNotPresent" value1="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Month" />
		</execute>

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<execute function="#assertElementNotPresent" locator1="PGCalendarMonthView#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="#assertTextNotPresent" value1="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="#assertTextEquals" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
		<execute function="#assertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="#assertTextNotPresent" value1="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewDefaultWeekPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#refresh" />

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" />
	</command>

	<command name="viewEventDetailsCmd">
		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<condition function="#isVisible" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" />
			<then>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
			</then>
			<else>
				<execute function="#assertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE_GUEST" value1="${eventTitle}" />
			</else>
		</if>
	</command>

	<command name="viewEventDetailsPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute macro="CalendarEvent#assertDialogBoxPresentCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />
	</command>

	<command name="viewEventDetailsWithTagPG">
		<execute macro="CalendarEvent#viewEventDetailsPG" />

		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#TAGS_LABEL" />
					<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#TAGS_LABEL" />
				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
			</else>
		</if>

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="viewEventWithRemindersPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />
		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute function="#assertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_REMINDER_ICON" value1="${eventTitle}" />
	</command>

	<command name="viewMonthPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Month" />
		</execute>

		<execute function="#refresh" />

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="#assertElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="#assertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var name="i" value="${i?increment()}" />
			</then>
		</while>

		<var name="key_eventNumber" value="${eventNumber}" />

		<if>
			<isset var="eventNumber" />
			<then>
				<if>
					<condition function="#isElementPresent" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_LINK" />
					<then>
						<execute function="#assertClick" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_LINK" value1="Show ${eventNumber} more" />
						<execute function="#assertElementPresent" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_DIALOG_BOX" />

						<while>
							<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
							<then>
								<execute function="#assertElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
								<execute function="#assertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
								<var name="i" value="${i?increment()}" />
							</then>
						</while>

						<execute function="#assertClick" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_CLOSE_LINK" value1="Close" />
					</then>
				</if>
			</then>
		</if>
	</command>

	<command name="viewPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#viewDayPG" />
		<execute macro="CalendarEvent#viewWeekPG" />
		<execute macro="CalendarEvent#viewMonthPG" />
		<execute macro="CalendarEvent#viewAgendaPG" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewRate4StarsPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#viewEventDetailsCmd" />

		<execute macro="CalendarEvent#assertDialogBoxPresentCmd" />

		<execute function="#assertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="#selectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />
		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />

		<if>
			<equals arg1="${yourRating}" arg2="false" />
			<then>
				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#YOUR_RATING"  value1="Your Rating" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_1" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_2" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_3" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_4" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_5" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_5" />
			</then>
			<else>
				<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#YOUR_RATING"  value1="Your Rating" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_1" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_2" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_3" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_4" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_5" />
				<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_5" />
			</else>
		</if>

		<execute function="#assertTextEquals" locator1="PGCalendarVieweventdetails#AVERAGE"  value1="Average (1 Vote)" />
		<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_1" />
		<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_2" />
		<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_3" />
		<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_4" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_5" />
		<execute function="#assertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_1" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_2" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_3" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_4" />
		<execute function="#assertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_5" />

		<execute function="#selectFrame" value1="relative=top" />
	</command>

	<command name="viewWeekPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="#refresh" />

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="#isElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="#assertElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="#assertTextEquals" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var name="i" value="${i?increment()}" />
			</then>
		</while>
	</command>
</definition>