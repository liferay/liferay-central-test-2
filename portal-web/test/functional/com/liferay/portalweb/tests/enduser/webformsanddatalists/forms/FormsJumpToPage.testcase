<definition component-name="portal-web-forms-and-data-lists">
	<property name="portal.release" value="true" />
	<property name="portal.upstream" value="true" />
	<property name="testray.main.component.name" value="Forms" />

	<set-up>
		<execute macro="TestCase#setUpPortalInstance" />

		<execute macro="User#firstLoginPG" />

		<var method="TestPropsUtil#get('portal.url')" name="portalURL" />

		<execute macro="Navigator#openURL" />

		<execute macro="ProductMenu#gotoSitesContent">
			<var name="portlet" value="Forms" />
		</execute>

		<execute macro="FormsAdminNavigator#gotoAddForm" />

		<execute macro="Form#editName" />

		<execute macro="Form#editPageTitle">
			<var name="formPageName" value="Page 1" />
		</execute>

		<execute macro="Form#gotoAddField">
			<var name="fieldType" value="Single Selection" />
		</execute>

		<execute macro="Form#editFieldLabel">
			<var name="fieldValue" value="Choose Your Destiny" />
		</execute>

		<execute macro="FormFields#editOptionsRow">
			<var name="optionName" value="Destiny1" />
			<var name="optionValue" value="Destiny 1" />
		</execute>

		<execute macro="FormFields#editOptionsRow">
			<var name="optionName" value="Destiny2" />
			<var name="optionValue" value="Destiny 2" />
			<var name="rowNumber" value="2" />
		</execute>

		<execute macro="FormFields#editOptionsRow">
			<var name="optionName" value="Destiny3" />
			<var name="optionValue" value="Destiny 3" />
			<var name="rowNumber" value="3" />
		</execute>

		<execute macro="Form#closeSidebar" />

		<for list="1,2,3" param="option">
			<execute macro="Form#addPage" />

			<var method="MathUtil#sum('${option}','1')" name="pageNumber" />

			<execute macro="Form#editPageTitle">
				<var name="formPageName" value="Page ${pageNumber}" />
			</execute>

			<execute macro="Form#gotoAddField">
				<var name="fieldType" value="Text Field" />
			</execute>

			<execute macro="Form#editFieldLabel">
				<var name="fieldValue" value="Destiny ${option}" />
			</execute>

			<execute macro="Form#closeSidebar" />
		</for>

		<execute macro="FormsAdminNavigator#gotoRules" />

		<execute macro="FormRules#addRule" />

		<execute macro="FormRules#configureConditionOptions">
			<var name="conditionField" value="Choose Your Destiny" />=
			<var name="conditionOperator" value="Is equal to" />
			<var name="conditionRowNumber" value="1" />
			<var name="conditionValueField" value="Destiny 2" />
			<var name="conditionValueType" value="Value" />
		</execute>

		<execute macro="FormRules#configureActionOptions">
			<var name="action" value="Jump to Page" />
			<var name="actionRowNumber" value="1" />
			<var name="actionTarget" value="Page 1" />
			<var name="actionTarget2" value="Page 3" />
		</execute>

		<execute macro="FormRules#save" />

		<execute macro="FormRules#addRule" />

		<execute macro="FormRules#configureConditionOptions">
			<var name="conditionField" value="Choose Your Destiny" />=
			<var name="conditionOperator" value="Is equal to" />
			<var name="conditionRowNumber" value="1" />
			<var name="conditionValueField" value="Destiny 3" />
			<var name="conditionValueType" value="Value" />
		</execute>

		<execute macro="FormRules#configureActionOptions">
			<var name="action" value="Jump to Page" />
			<var name="actionRowNumber" value="1" />
			<var name="actionTarget" value="Page 1" />
			<var name="actionTarget2" value="Page 4" />
		</execute>

		<execute macro="FormRules#save" />

		<execute macro="FormsAdminNavigator#gotoFormBuilder" />

		<execute macro="Form#save" />
	</set-up>

	<tear-down>
		<var method="TestPropsUtil#get('test.portal.instance')" name="testPortalInstance" />

		<if>
			<equals arg1="${testPortalInstance}" arg2="true" />
			<then>
				<execute macro="PortalInstances#tearDownCP" />
			</then>
			<else>
				<execute macro="Navigator#openURL" />

				<execute macro="ProductMenu#gotoSitesContent">
					<var name="portlet" value="Forms" />
				</execute>

				<execute macro="FormsAdmin#teardownForms" />

				<execute macro="Page#tearDownPG" />
			</else>
		</if>
	</tear-down>

	<command name="ViewPagesAfterJump" priority="5">
		<description message="This is a use case for LPS-69372." />
		<property name="portal.acceptance" value="pending" />

		<execute macro="FormsAdminNavigator#gotoPublish" />

		<execute macro="Form#clickPublishSwitcher" />

		<execute macro="Form#getPublishedFormPublicURL">
			<return from="publicURL" name="publicURL" />
			<var name="publicURL" value="${publicURL}" />
		</execute>

		<execute macro="Button#clickConfirm" />

		<execute macro="Navigator#openSpecificURL">
			<var name="url" value="${publicURL}" />
		</execute>

		<for list="1,2,3" param="option">
			<execute macro="FormFields#selectRadioOption">
				<var name="fieldName" value="ChooseYourDestiny" />
				<var name="radioOption" value="Destiny ${option}" />
			</execute>

			<var method="MathUtil#sum('${option}','1')" name="pageNumber" />

			<execute macro="FormPortlet#nextPage">
				<var name="formPageCurrent" value="Page 1" />
				<var name="formPageNext" value="Page ${pageNumber}" />
			</execute>

			<execute macro="FormFields#viewTextField">
				<var name="fieldLabel" value="Destiny ${option}" />
				<var name="fieldName" value="Destiny${option}" />
			</execute>

			<execute macro="FormPortlet#previousPage" />
		</for>

		<execute macro="FormFields#selectRadioOption">
			<var name="fieldName" value="ChooseYourDestiny" />
			<var name="radioOption" value="Destiny 2" />
		</execute>

		<execute macro="FormPortlet#nextPage">
			<var name="formPageCurrent" value="Page 1" />
			<var name="formPageNext" value="Page 3" />
		</execute>

		<execute macro="FormFields#editText">
			<var name="fieldName" value="Destiny2" />
			<var name="fieldValue" value="After skipping to page 3" />
		</execute>

		<execute macro="FormPortlet#nextPage">
			<var name="formPageCurrent" value="Page 3" />
			<var name="formPageNext" value="Page 4" />
		</execute>

		<execute macro="FormFields#editText">
			<var name="fieldName" value="Destiny3" />
			<var name="fieldValue" value="Also fill out page 4" />
		</execute>

		<execute macro="FormPortlet#submitSuccessfully" />
	</command>

	<command name="ViewRuleAfterLabelEdit" priority="4">
		<description message="This is a use case for LPS-68227." />

		<execute macro="FormsAdminNavigator#gotoEditField">
			<var name="fieldName" value="ChooseYourDestiny" />
		</execute>

		<execute macro="Form#editFieldLabel">
			<var name="fieldName" value="ChooseYourDestiny" />
			<var name="fieldValue" value="Edit Label" />
		</execute>

		<execute macro="Form#closeSidebar" />

		<execute macro="Form#save" />

		<execute macro="FormsAdminNavigator#gotoRules" />

		<execute macro="FormRules#gotoEdit">
			<var name="ruleNumber" value="1" />
		</execute>

		<var name="key_conditionRowNumber" value="1" />

		<execute function="AssertTextEquals" locator1="Form#RULE_BUILDER_CONDITION_FIELD" value1="Edit Label" />
	</command>

	<command ignore="true" name="ViewRuleAfterOptionValueEdit" priority="3">
		<description message="This is a use case for LPS-68227." />

		<execute macro="FormsAdminNavigator#gotoEditField">
			<var name="fieldName" value="ChooseYourDestiny" />
		</execute>

		<execute macro="FormFields#editOptionsRow">
			<var name="optionName" value="Destiny2" />
			<var name="optionValue" value="Edited Destiny" />
			<var name="rowNumber" value="2" />
		</execute>

		<execute macro="Form#closeSidebar" />

		<execute macro="Form#save" />

		<execute macro="FormsAdminNavigator#gotoRules" />

		<execute macro="FormRules#gotoEdit">
			<var name="ruleNumber" value="1" />
		</execute>

		<var name="key_conditionRowNumber" value="1" />

		<execute function="AssertTextEquals" locator1="Form#RULE_BUILDER_CONDITION_VALUE_FIELD" value1="Edited Destiny" />
	</command>

	<command name="ViewRuleAfterPageNameChange" priority="4">
		<description message="This is a use case for LPS-68227." />

		<execute macro="Form#gotoFormPage">
			<var name="formPageName" value="Page 3" />
		</execute>

		<execute macro="Form#editPageTitle">
			<var name="formPageName" value="Renamed Page" />
		</execute>

		<execute macro="Form#save" />

		<execute macro="FormsAdminNavigator#gotoRules" />

		<execute macro="FormRules#gotoEdit">
			<var name="ruleNumber" value="1" />
		</execute>

		<var name="key_actionRowNumber" value="1" />

		<execute function="AssertTextEquals" locator1="Form#RULE_BUILDER_ACTION_TARGET_FIELD_2" value1="Renamed Page" />
	</command>
</definition>