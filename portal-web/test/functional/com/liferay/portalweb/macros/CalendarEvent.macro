<definition>
	<command name="_assertDialogBoxPresent">
		<if>
			<equals arg1="${schedulerEventDialogBox}" arg2="false" />
			<then>
				<execute function="AssertElementNotPresent" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</then>
			<else>
				<execute function="AssertSelectedLabel" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR" value1="${calendarName}" />
			</else>
		</if>
	</command>

	<command name="_expandDetailsPanel">
		<if>
			<condition function="IsElementPresent" locator1="CalendarEditEvent#DETAILS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#DETAILS_PANEL_COLLAPSED" />

				<execute function="AssertElementPresent" locator1="CalendarEditEvent#DETAILS_PANEL_EXPANDED" />
			</then>
		</if>
	</command>

	<command name="_expandInvitationsPanel">
		<if>
			<condition function="IsElementPresent" locator1="CalendarEditEvent#INVITATIONS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#INVITATIONS_PANEL_COLLAPSED" />

				<execute function="AssertElementPresent" locator1="CalendarEditEvent#INVITATIONS_PANEL_EXPANDED" />
			</then>
		</if>
	</command>

	<command name="_options">
		<if>
			<equals arg1="${optionSetValue}" arg2="viewPermission" />
			<then>
				<execute function="Select" locator1="CalendarEditEvent#DETAILS_PERMISSIONS_VIEWABLE_BY_SELECT" value1="${viewPermissionValue}" />
			</then>
		</if>

		<if>
			<equals arg1="${optionSetValue}" arg2="permissions" />
			<then>
				<var name="key_permissionDefinitionKey" value="${permissionDefinitionKey}" />
				<var name="key_roleName" value="${roleName}" />

				<execute function="Check" locator1="CalendarEditEvent#DETAILS_PERMISSIONS_CHECKBOX" />
			</then>
		</if>

		<if>
			<equals arg1="${optionSetValue}" arg2="inviteResource" />
			<then>
				<execute macro="CalendarEvent#inviteResource">
					<var name="resourceNameList" value="${specificOptionSetValue}" />
				</execute>
			</then>
		</if>

		<if>
			<equals arg1="${optionSetValue}" arg2="reminders" />
			<then>
				<execute macro="CalendarEvent#configureReminders" />
			</then>
		</if>

		<if>
			<equals arg1="${optionSetValue}" arg2="resourcesAvailability" />
			<then>
				<execute macro="CalendarEvent#resourcesAvailability" />
			</then>
		</if>

		<if>
			<equals arg1="${optionSetValue}" arg2="tag" />
			<then>
				<execute macro="CalendarEvent#tag">
					<var name="tagText" value="${specificOptionSetValue}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="_selectEventIframe">
		<execute function="SelectFrame" locator1="CalendarEditEvent#EDIT_EVENT_IFRAME" />
	</command>

	<command name="_viewNewEventIframe">
		<execute function="AssertElementPresent#assertVisible" locator1="CalendarEditEvent#START_DATE" />
		<execute function="AssertElementPresent#assertVisible" locator1="CalendarEditEvent#START_DATE_TIME" />
		<execute function="AssertElementPresent#assertVisible" locator1="CalendarEditEvent#END_DATE" />
		<execute function="AssertElementPresent#assertVisible" locator1="CalendarEditEvent#END_DATE_TIME" />
	</command>

	<command name="add">
		<execute macro="CalendarEvent#editTitle">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="AssertNotChecked" locator1="CalendarEditEvent#ALL_DAY_CHECKBOX" />
				<execute function="AssertNotChecked" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />

				<var locator="CalendarEditEvent#END_DATE" name="endDate" />
				<var locator="CalendarEditEvent#END_DATE_TIME" name="endDateTime" />
				<var locator="CalendarEditEvent#START_DATE" name="startDate" />
				<var locator="CalendarEditEvent#START_DATE_TIME" name="startDateTime" />

				<execute macro="CalendarEvent#selectCalendar">
					<var name="calendarName" value="${calendarName}" />
				</execute>

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#_options">
							<var name="optionSetValue" value="${optionSetValue}" />
							<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
						</execute>
					</then>
				</if>

				<if>
					<equals arg1="${resourcesAvailability}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#resourcesAvailability" />
					</then>
				</if>

				<if>
					<equals arg1="${reminders}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#configureReminders">
							<var name="duration1" value="${duration1}" />
							<var name="duration2" value="${duration2}" />
							<var name="number1" value="${number1}" />
							<var name="number2" value="${number2}" />
						</execute>
					</then>
				</if>

				<execute macro="CalendarEvent#publish" />

				<execute macro="Page#gotoPG">
					<var name="defaultURL" value="${defaultURL}" />
					<var name="nodePort" value="${nodePort}" />
					<var name="pageName" value="${pageName}" />
					<var name="pageStaging" value="${pageStaging}" />
					<var name="siteName" value="${siteName}" />
					<var name="siteURL" value="${siteURL}" />
					<var name="soDashboard" value="${soDashboard}" />
					<var name="soPage" value="${soPage}" />
				</execute>

				<execute macro="CalendarScheduler#_viewRegularEventTitleViaMonthView">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
				</execute>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<var name="endDateTime" value="11:59 PM" />
					<var name="startDateTime" value="12:00 AM" />

					<execute function="Check" locator1="CalendarEditEvent#ALL_DAY_CHECKBOX" />
					<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#START_DATE_TIME" />
					<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#END_DATE_TIME" />

					<var locator="CalendarEditEvent#END_DATE" name="endDate" />
					<var locator="CalendarEditEvent#START_DATE" name="startDate" />

					<execute macro="CalendarEvent#selectCalendar">
						<var name="calendarName" value="${calendarName}" />
					</execute>

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#_options">
								<var name="optionSetValue" value="${optionSetValue}" />
								<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
							</execute>
						</then>
					</if>

					<if>
						<equals arg1="${reminders}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#configureReminders">
								<var name="duration1" value="${duration1}" />
								<var name="duration2" value="${duration2}" />
								<var name="number1" value="${number1}" />
								<var name="number2" value="${number2}" />
							</execute>
						</then>
					</if>

					<execute macro="CalendarEvent#publish" />

					<execute macro="Page#gotoPG">
						<var name="defaultURL" value="${defaultURL}" />
						<var name="nodePort" value="${nodePort}" />
						<var name="pageName" value="${pageName}" />
						<var name="soDashboard" value="${soDashboard}" />
						<var name="soPage" value="${soPage}" />
					</execute>

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<if>
						<equals arg1="${reminders}" arg2="true" />
						<then>
							<execute function="AssertElementPresent" locator1="Calendar#SCHEDULER_EVENT_ALL_DAY_WITH_REMINDER" />
							<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_ALL_DAY_TITLE_WITH_REMINDER" value1="${eventTitle}" />
						</then>
						<else>
							<execute function="AssertElementPresent" locator1="Calendar#SCHEDULER_EVENT_ALL_DAY" />
							<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_ALL_DAY_TITLE" value1="${eventTitle}" />
						</else>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<var locator="CalendarEditEvent#END_DATE" name="endDate" />
					<var locator="CalendarEditEvent#END_DATE_TIME" name="endDateTime" />
					<var locator="CalendarEditEvent#START_DATE" name="startDate" />
					<var locator="CalendarEditEvent#START_DATE_TIME" name="startDateTime" />

					<execute macro="CalendarEvent#setRepeating">
						<var name="frequency" value="${frequency}" />
						<var name="month" value="${month}" />
						<var name="numberOfOccurrences" value="${numberOfOccurrences}" />
						<var name="position" value="${position}" />
						<var name="weekday" value="${weekday}" />
					</execute>

					<execute macro="CalendarEvent#selectCalendar">
						<var name="calendarName" value="${calendarName}" />
					</execute>

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#_options">
								<var name="optionSetValue" value="${optionSetValue}" />
								<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
							</execute>
						</then>
					</if>

					<if>
						<equals arg1="${reminders}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#configureReminders">
								<var name="duration1" value="${duration1}" />
								<var name="duration2" value="${duration2}" />
								<var name="number1" value="${number1}" />
								<var name="number2" value="${number2}" />
							</execute>
						</then>
					</if>

					<execute macro="CalendarEvent#publish" />

					<execute macro="Page#gotoPG">
						<var name="defaultURL" value="${defaultURL}" />
						<var name="nodePort" value="${nodePort}" />
						<var name="pageName" value="${pageName}" />
						<var name="soDashboard" value="${soDashboard}" />
						<var name="soPage" value="${soPage}" />
					</execute>

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<execute function="AssertElementPresent" locator1="Calendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addComment">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventCommentList" value="${eventCommentList}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="addComment">
		<execute macro="CalendarEvent#viewDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">

					<if>
						<condition function="IsElementPresent" locator1="Comments#ADD_COMMENT_LINK" />
						<then>
							<execute function="AssertClick" locator1="Comments#ADD_COMMENT_LINK" value1="Add Comment" />
							<execute function="MakeVisible" locator1="Comments#COMMENT_FIELD" />
							<execute function="Type" locator1="Comments#COMMENT_FIELD" value1="${eventComment}" />
						</then>
						<else>
							<execute function="Type" locator1="Comments#COMMENT_FIELD" value1="${eventComment}" />
						</else>
					</if>

					<execute function="AssertClick" locator1="Button#REPLY" value1="Reply" />

					<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request processed successfully." />
				</for>
			</then>
			<else>
				<execute function="Type" locator1="Comments#COMMENT_FIELD" value1="${eventComment}" />

				<execute function="AssertClick" locator1="Button#REPLY" value1="Reply" />

				<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request processed successfully." />
			</else>
		</if>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_entryComment" value="${eventComment}" />

					<execute function="AssertTextEquals" locator1="Comments#USER_NAME" value1="${user} (You)" />
					<execute function="AssertTextEquals" locator1="Comments#COMMENT_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_entryComment" value="${eventComment}" />

				<execute function="AssertTextEquals" locator1="Comments#USER_NAME" value1="${user} (You)" />
				<execute function="AssertTextEquals" locator1="Comments#COMMENT_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="addRSVP">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectSpecificEvent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_rsvp" value="${rsvp}" />

		<execute function="AssertClick" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_ACTIVE" value1="${rsvp}" />

		<execute function="Pause" value1="3000" />

		<if>
			<equals arg1="${rsvp}" arg2="No" />
			<then>
				<execute macro="CalendarScheduler#viewSpecificEventNotPresent">
					<var name="eventTitle" value="${eventTitle}" />
				</execute>
			</then>
			<else>
				<execute macro="CalendarScheduler#viewRSVP">
					<var name="eventTitle" value="${eventTitle}" />
					<var name="rsvp"  value="${rsvp}" />
				</execute>
			</else>
		</if>
	</command>

	<command name="addSetTime">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="AssertClick" locator1="Calendar#ADD_EVENT_BUTTON" value1="Add Event" />

		<execute macro="CalendarEvent#_selectEventIframe" />

		<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitle}" />

		<execute macro="CalendarEvent#_viewNewEventIframe" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="AssertNotChecked" locator1="CalendarEditEvent#ALL_DAY_CHECKBOX" />
				<execute function="AssertNotChecked" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />
				<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${setStartDateTime}" />
				<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${setEndDateTime}" />

				<var locator="CalendarEditEvent#START_DATE" name="startDate" />

				<var name="endDate" value="${startDate}" />

				<execute function="Type" locator1="CalendarEditEvent#END_DATE" value1="${endDate}" />

				<execute macro="CalendarEvent#selectCalendar">
					<var name="calendarName" value="${calendarName}" />
				</execute>

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#_options">
							<var name="optionSetValue" value="${optionSetValue}" />
							<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
						</execute>
					</then>
				</if>

				<execute macro="CalendarEvent#publish" />

				<execute macro="Page#gotoPG">
					<var name="defaultURL" value="${defaultURL}" />
					<var name="nodePort" value="${nodePort}" />
					<var name="pageName" value="${pageName}" />
					<var name="soDashboard" value="${soDashboard}" />
					<var name="soPage" value="${soPage}" />
				</execute>

				<execute macro="CalendarScheduler#_viewRegularEventTitleViaMonthView">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
				</execute>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${setStartDateTime}" />
					<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${setEndDateTime}" />

					<var locator="CalendarEditEvent#START_DATE" name="startDate" />

					<var name="endDate" value="${startDate}" />

					<execute function="Type" locator1="CalendarEditEvent#END_DATE" value1="${endDate}" />
					<execute function="Check" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />
					<execute function="AssertSelectedLabel" locator1="CalendarEditEvent#REPEAT_REPEATS_DROPDOWN" value1="Daily" />
					<execute function="AssertSelectedLabel" locator1="CalendarEditEvent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />
					<execute function="Click" locator1="CalendarEditEvent#REPEAT_ENDS_AFTER_RADIO" />
					<execute function="Type" locator1="CalendarEditEvent#REPEAT_ENDS_AFTER_FIELD" value1="1" />
					<execute function="Click" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" />
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" value1="Daily, 1 Times" />
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DONE_BUTTON" value1="Done" />

					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="Daily, 1 Times" />

					<execute function="Check" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />

					<execute macro="CalendarEvent#selectCalendar">
						<var name="calendarName" value="${calendarName}" />
					</execute>

					<execute macro="CalendarEvent#publish" />

					<execute function="SelectFrame" value1="relative=top" />

					<execute macro="Page#gotoPG">
						<var name="defaultURL" value="${defaultURL}" />
						<var name="nodePort" value="${nodePort}" />
						<var name="pageName" value="${pageName}" />
						<var name="soDashboard" value="${soDashboard}" />
						<var name="soPage" value="${soPage}" />
					</execute>

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${setEndDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${setStartDateTime}" />

					<execute function="AssertElementPresent" locator1="Calendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addComment">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${setEndDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventCommentList" value="${eventCommentList}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${setStartDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="addViaDayView">
		<execute macro="CalendarScheduler#gotoAddViaDayView" />

		<execute macro="CalendarScheduler#editTitle">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#saveEvent" />
	</command>

	<command name="configureReminders">
		<if>
			<condition function="IsElementPresent" locator1="CalendarEditEvent#REMINDERS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#REMINDERS_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#REMINDERS_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="Check" locator1="CalendarEditEvent#REMINDERS_EMAIL_CHECKBOX_1" />
		<execute function="Check" locator1="CalendarEditEvent#REMINDERS_EMAIL_CHECKBOX_2" />

		<execute function="Type" locator1="CalendarEditEvent#REMINDERS_VALUE_INPUT_ACTIVE_1" value1="${number1}" />
		<execute function="Type" locator1="CalendarEditEvent#REMINDERS_VALUE_INPUT_ACTIVE_2" value1="${number2}" />

		<execute function="Select" locator1="CalendarEditEvent#REMINDERS_DURATION_SELECT_ACTIVE_1" value1="${duration1}" />
		<execute function="Select" locator1="CalendarEditEvent#REMINDERS_DURATION_SELECT_ACTIVE_2" value1="${duration2}" />

		<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#REMINDERS_VALUE_INPUT_INACTIVE_1" />
		<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#REMINDERS_VALUE_INPUT_INACTIVE_2" />
		<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#REMINDERS_DURATION_SELECT_INACTIVE_1" />
		<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#REMINDERS_DURATION_SELECT_INACTIVE_2" />
	</command>

	<command name="delete">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="i" value="1" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
			<then>
				<execute function="Click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />

				<if>
					<condition function="IsElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
					<then>
						<var method="MathUtil#sum('${i}', '1')" name="i" />

						<execute function="Click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
					</then>
					<else>
						<if>
							<condition function="IsElementNotPresent" locator1="xpath=(//input[contains(@value,'Repeating')])" />
							<then>
								<execute function="Pause" value1="1000" />
								<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
								<execute function="Pause" value1="1000" />
								<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />
								<execute function="Pause" value1="2000" />
							</then>
							<else>
								<execute function="Pause" value1="1000" />
								<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
								<execute function="Pause" value1="1000" />
								<execute function="AssertClick" locator1="CalendarEditEvent#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
								<execute function="Pause" value1="2000" />
							</else>
						</if>
					</else>
				</if>
			</then>
		</while>

		<execute function="AssertTextEquals" locator1="CalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
		<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_GENERIC" />
		<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_REPEATING" />

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="deleteComment">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetails">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<var name="key_eventComment" value="${eventComment}" />

		<if>
			<equals arg1="${soPage}" arg2="true" />
			<then>
				<execute function="AssertClickNoError" locator1="CalendarViewEventDetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="Confirm" value1="Are you sure you want to delete the selected comment?" />
			</then>
			<else>
				<execute function="AssertClickNoError" locator1="CalendarViewEventDetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="Confirm" value1="Are you sure you want to delete this? It will be deleted immediately." />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#COMMENTS_SUCCESS" value1="Your request processed successfully." />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="deleteRepeatingEventViaAgendaView">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<or>
				<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
			</or>
			<then>
				<execute function="AssertClick" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="AssertClick" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute function="AssertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
		<execute function="Pause" value1="1000" />
		<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Pause" value1="1000" />

		<if>
			<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
			<then>
				<execute function="AssertClick" locator1="CalendarEditEvent#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series" />

				<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
				<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="AssertClick" locator1="CalendarEditEvent#ALL_FOLLOWING_BUTTON" value1="All Following" />

					<execute function="AssertElementPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
				<then>
					<execute function="AssertClick" locator1="CalendarEditEvent#ONLY_THIS_INSTANCE_BUTTON" value1="Only This Instance" />

					<execute function="AssertElementPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="AssertElementNotPresent" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute function="Refresh" />
	</command>

	<command name="deleteSpecific">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClickNoError" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<execute macro="CalendarScheduler#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="deleteViaAgendaView">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="AssertClick#assertPartialTextClickAt" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClickNoError" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<execute macro="CalendarScheduler#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="edit">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="SelectFrame" locator1="CalendarEditEvent#EDIT_EVENT_IFRAME" />

		<if>
			<equals arg1="${eventType}" arg2="All Day" />
			<then>
				<var name="endDateTime" value="11:59 PM" />
				<var name="startDateTime" value="12:00 AM" />

				<execute function="AssertChecked" locator1="CalendarEditEvent#ALL_DAY_CHECKBOX" />
				<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#START_DATE_TIME" />
				<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#END_DATE_TIME" />

				<var locator="CalendarEditEvent#END_DATE" name="endDate" />
				<var locator="CalendarEditEvent#START_DATE" name="startDate" />

				<execute function="AssertTextEquals" locator1="TextInput#TITLE" value1="${eventTitle}" />
				<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitleEdit}" />
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE" />
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#_options">
							<var name="optionSetValue" value="${optionSetValue}" />
							<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
						</execute>
					</then>
				</if>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Regular" />
				<then>
					<execute function="AssertTextEquals" locator1="TextInput#TITLE" value1="${eventTitle}" />
					<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitleEdit}" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE_TIME" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE_TIME" />

					<var locator="CalendarEditEvent#END_DATE" name="endDate" />
					<var locator="CalendarEditEvent#START_DATE" name="startDate" />

					<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="Click" locator1="CalendarEditEvent#START_DATE_TIME" />
					<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="Click" locator1="CalendarEditEvent#END_DATE_TIME" />
					<execute function="Pause" value1="1000" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#_options">
								<var name="optionSetValue" value="${optionSetValue}" />
								<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
							</execute>
						</then>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="AssertTextEquals" locator1="TextInput#TITLE" value1="${eventTitle}" />
					<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitleEdit}" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE_TIME" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE" />
					<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE_TIME" />

					<var locator="CalendarEditEvent#END_DATE" name="endDate" />
					<var locator="CalendarEditEvent#START_DATE" name="startDate" />

					<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="Click" locator1="CalendarEditEvent#START_DATE_TIME" />
					<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="Click" locator1="CalendarEditEvent#END_DATE_TIME" />
					<execute function="Pause" value1="1000" />
					<execute function="AssertChecked" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="Daily, 1 Times" />
					<execute function="Click" locator1="Button#PUBLISH" />

					<if>
						<condition function="IsElementPresent" locator1="CalendarEditEvent#ALL_EVENTS_IN_THE_SERIES_BUTTON" />
						<then>
							<execute function="AssertClick" locator1="CalendarEditEvent#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
						</then>
					</if>

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#_options">
								<var name="optionSetValue" value="${optionSetValue}" />
								<var name="specificOptionSetValue" value="${specificOptionSetValue}" />
							</execute>
						</then>
					</if>
				</then>
			</elseif>
		</if>

		<execute function="Click" locator1="Button#PUBLISH" />

		<if>
			<equals arg1="${optionSetValue}" arg2="inviteResource" />
			<then>
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#ARE_YOU_SURE_DIALOG_BOX_HEADER" value1="Are you sure?" />
				<execute function="AssertTextEquals" locator1="CalendarEditEvent#ARE_YOU_SURE_DIALOG_BOX_BODY" value1="You are about to make changes that will only affect your calendar (${calendarName})." />
				<execute function="AssertClick" locator1="CalendarEditEvent#SAVE_CHANGES_BUTTON" value1="Save changes." />
			</then>
		</if>

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
		<execute function="SelectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="defaultURL" value="${defaultURL}" />
			<var name="nodePort" value="${nodePort}" />
			<var name="pageName" value="${pageName}" />
			<var name="soDashboard" value="${soDashboard}" />
			<var name="soPage" value="${soPage}" />
		</execute>

		<var name="key_eventTitle" value="${eventTitleEdit}" />

		<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="editComment">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetails">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<var name="key_eventComment" value="${eventComment}" />

		<execute function="AssertClick" locator1="CalendarViewEventDetails#COMMENTS_COMMENT_EDIT" value1="Edit" />
		<execute function="Type" locator1="CalendarViewEventDetails#COMMENTS_COMMENT_EDIT_BODY_FIELD" value1="${eventCommentEdit}" />
		<execute function="AssertClick" locator1="CalendarViewEventDetails#COMMENTS_COMMENT_EDIT_PUBLISH_BUTTON" value1="Publish" />

		<var name="key_eventComment" value="${eventCommentEdit}" />

		<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#COMMENTS_BODY" value1="${eventCommentEdit}" />
		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="editTitle">
		<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitle}" />
	</command>

	<command name="editViaAgendaView">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="AssertClick#assertPartialTextClickAt" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="SelectFrame" locator1="CalendarEditEvent#EDIT_EVENT_IFRAME" />
		<execute function="AssertTextEquals" locator1="TextInput#TITLE" value1="${eventTitle}" />
		<execute function="Type" locator1="TextInput#TITLE" value1="${eventTitleEdit}" />
		<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE" />
		<execute function="AssertElementPresent" locator1="CalendarEditEvent#START_DATE_TIME" />
		<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE" />
		<execute function="AssertElementPresent" locator1="CalendarEditEvent#END_DATE_TIME" />

		<var locator="CalendarEditEvent#END_DATE" name="endDate" />
		<var locator="CalendarEditEvent#START_DATE" name="startDate" />

		<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="Click" locator1="CalendarEditEvent#START_DATE_TIME" />
		<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />
		<execute function="Click" locator1="CalendarEditEvent#END_DATE_TIME" />
		<execute function="Pause" value1="1000" />

		<execute macro="CalendarEvent#publish" />

		<execute function="SelectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="defaultURL" value="${defaultURL}" />
			<var name="nodePort" value="${nodePort}" />
			<var name="pageName" value="${pageName}" />
			<var name="soDashboard" value="${soDashboard}" />
			<var name="soPage" value="${soPage}" />
		</execute>

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="AssertTextEquals#assertPartialText" locator1="CalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="gotoRepeatConfiguration">
		<execute function="Click" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />
	</command>

	<command name="inviteResource">
		<execute macro="CalendarEvent#_expandInvitationsPanel" />

		<for list="${resourceNameList}" param="resourceName" >
			<execute function="Type" locator1="CalendarEditEvent#INVITATIONS_INVITE_RESOURCE_FIELD" value1="${resourceName}" />

			<var name="key_resource" value="${resourceName}" />

			<execute function="Click" locator1="CalendarEditEvent#INVITATIONS_INVITE_RESOURCE_FIELD_LIST" value1="${resourceName}" />

			<execute macro="CalendarEvent#viewRSVPPending">
				<var name="resourceName" value="${resourceName}" />
			</execute>
		</for>
	</command>

	<command name="publish">
		<execute function="Click" locator1="Button#PUBLISH" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="rate4Stars">
		<execute macro="CalendarEvent#viewDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute function="Click" locator1="Ratings#YOUR_RATING_STAR_4" />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="resourcesAvailability">
		<if>
			<condition function="IsElementPresent" locator1="CalendarEditEvent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="AssertElementPresent" locator1="CalendarEditEvent#INVITATIONS_RESOURCES_AVAILABILITY_SCHEDULER_EVENT_GENERIC" />
	</command>

	<command name="selectCalendar">
		<if>
			<isset var="calendarName" />
			<then>
				<execute macro="CalendarEvent#_expandDetailsPanel" />

				<execute function="Select" locator1="CalendarEditEvent#DETAILS_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
		</if>
	</command>

	<command name="selectRepeatFrequency">
		<execute function="Select" locator1="CalendarEditEvent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
		<execute function="AssertSelectedLabel" locator1="CalendarEditEvent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
	</command>

	<command name="setAllDay">
		<execute function="Check" locator1="CalendarEditEvent#ALL_DAY_CHECKBOX" />
		<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#START_DATE_TIME" />
		<execute function="AssertElementNotPresent#assertNotVisible" locator1="CalendarEditEvent#END_DATE_TIME" />
	</command>

	<command name="setDates">
		<execute function="Type" locator1="CalendarEditEvent#START_DATE" value1="${startDate}" />
		<execute function="Type" locator1="CalendarEditEvent#END_DATE" value1="${endDate}" />
	</command>

	<command name="setDatesToday">
		<var locator="CalendarEditEvent#START_DATE" name="endDate" />

		<execute function="Type" locator1="CalendarEditEvent#END_DATE" value1="${endDate}" />
	</command>

	<command name="setRepeating">
		<execute macro="CalendarEvent#gotoRepeatConfiguration" />

		<execute macro="CalendarEvent#selectRepeatFrequency">
			<var name="frequency" value="${frequency}" />
		</execute>

		<execute function="AssertSelectedLabel" locator1="CalendarEditEvent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />

		<if>
			<isset var="position" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_RADIO" />
				<execute function="Select" locator1="CalendarEditEvent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_POSITION_DROPDOWN" value1="${position}" />
				<execute function="Select" locator1="CalendarEditEvent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_WEEKDAY_DROPDOWN" value1="${weekday}" />
			</then>
		</if>

		<if>
			<isset var="numberOfOccurrences" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#REPEAT_ENDS_AFTER_RADIO" />
				<execute function="Pause" value1="1000" />
				<execute function="Type" locator1="CalendarEditEvent#REPEAT_ENDS_AFTER_FIELD" value1="${numberOfOccurrences}" />
			</then>
		</if>

		<execute function="Pause" value1="1000" />
		<execute function="Click" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" />
		<execute function="Pause" value1="1000" />

		<if>
			<and>
				<isset var="position" />
				<isset var="month" />
			</and>
			<then>
				<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" value1="${frequency}, On The ${position} ${weekday} Of ${month}" />

				<execute function="AssertClick" locator1="CalendarEditEvent#REPEAT_DONE_BUTTON" value1="Done" />

				<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="${frequency}, On The ${position} ${weekday} Of ${month}" />
			</then>
			<elseif>
				<and>
					<isset var="position" />
					<isset var="numberOfOccurrences" />
				</and>
				<then>
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" value1="${frequency}, On ${position} ${weekday}, ${numberOfOccurrences} Times" />

					<execute function="AssertClick" locator1="CalendarEditEvent#REPEAT_DONE_BUTTON" value1="Done" />

					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="${frequency}, On ${position} ${weekday}, ${numberOfOccurrences} Times" />
				</then>
			</elseif>
			<elseif>
				<isset var="position" />
				<then>
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" value1="${frequency} On ${position} ${weekday}" />

					<execute function="AssertClick" locator1="CalendarEditEvent#REPEAT_DONE_BUTTON" value1="Done" />

					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="${frequency} On ${position} ${weekday}" />
				</then>
			</elseif>
			<elseif>
				<isset var="numberOfOccurrences" />
				<then>
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_DIALOG_SUMMARY" value1="${frequency}, ${numberOfOccurrences} Times" />

					<execute function="AssertClick" locator1="CalendarEditEvent#REPEAT_DONE_BUTTON" value1="Done" />

					<execute function="AssertTextEquals" locator1="CalendarEditEvent#REPEAT_SUMMARY" value1="${frequency}, ${numberOfOccurrences} Times" />
				</then>
			</elseif>
		</if>

		<execute function="Check" locator1="CalendarEditEvent#REPEAT_CHECKBOX" />
	</command>

	<command name="setTimes">
		<execute function="Type" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="Type" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />

		<execute macro="CalendarEvent#viewTimes">
			<var name="endDateTime" value="${endDateTime}" />
			<var name="startDateTime" value="${startDateTime}" />
		</execute>
	</command>

	<command name="tag">
		<if>
			<condition function="IsElementPresent" locator1="CalendarEditEvent#CATEGORIZATION_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="CalendarEditEvent#CATEGORIZATION_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="CalendarEditEvent#CATEGORIZATION_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="AssertElementPresent" locator1="CalendarEditEvent#CATEGORIZATION_TAG_FIELD" />

		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="Type#typePause" locator1="CalendarEditEvent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
					<execute function="AssertClick" locator1="CalendarEditEvent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
					<execute function="AssertTextEquals" locator1="CalendarEditEvent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="Type#typePause" locator1="CalendarEditEvent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
				<execute function="AssertClick" locator1="CalendarEditEvent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
				<execute function="AssertTextEquals" locator1="CalendarEditEvent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
			</else>
		</if>
	</command>

	<command name="tearDown">
		<if>
			<equals arg1="${marketplace}" arg2="true" />
			<then>
				<execute macro="Page#addPG">
					<var name="defaultURL" value="${defaultURL}" />
					<var name="nodePort" value="${nodePort}" />
					<var name="pageName" value="Marketplace Calendar Testing" />
					<var name="pageTemplateName" value="${pageTemplateName}" />
					<var name="pageType" value="${pageType}" />
				</execute>

				<execute macro="Portlet#addPG">
					<var name="i" value="${i}" />
					<var name="pageName" value="Marketplace Calendar Testing" />
					<var name="portletName" value="Calendar" />
				</execute>

				<execute macro="Page#gotoPG">
					<var name="defaultURL" value="${defaultURL}" />
					<var name="nodePort" value="${nodePort}" />
					<var name="pageName" value="Marketplace Calendar Testing" />
					<var name="soDashboard" value="${soDashboard}" />
					<var name="soPage" value="${soPage}" />
				</execute>
			</then>
		</if>

		<execute macro="CalendarEvent#delete" />
	</command>

	<command name="tearDownOnBusyDayInCurrentMonth">
		<execute macro="CalendarNavigator#gotoBusyDayViaSmallCalendar" />

		<execute macro="CalendarEvent#delete" />
	</command>

	<command name="view">
		<var name="eventTitle" value="${eventTitle}" />

		<execute macro="CalendarScheduler#viewDay">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#viewWeek">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#viewMonth">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#viewAgenda">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewApprovedRSVP">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectSpecificEvent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertTextEquals" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_rsvp" value="${rsvp}" />

		<execute function="AssertElementPresent" locator1="Calendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_INACTIVE" value1="${rsvp}" />
	</command>

	<command name="viewAvailableCalendars">
		<execute macro="CalendarEvent#_expandDetailsPanel" />

		<for list="${availableCalendarList}" param="availableCalendarName">
			<var name="key_calendarName" value="${availableCalendarName}" />

			<execute function="AssertElementPresent" locator1="CalendarEditEvent#DETAILS_CALENDAR_SELECT_OPTION" />
		</for>
	</command>

	<command name="viewComment">
		<execute macro="CalendarEvent#viewDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_entryComment" value="${eventComment}" />

					<execute function="AssertTextEquals" locator1="Comments#USER_NAME" value1="${user} (You)" />
					<execute function="AssertTextEquals" locator1="Comments#COMMENT_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_entryComment" value="${eventComment}" />

				<execute function="AssertTextEquals" locator1="Comments#USER_NAME" value1="${user} (You)" />
				<execute function="AssertTextEquals" locator1="Comments#COMMENT_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewDefaultTimes">
		<execute function="AssertTextEquals#assertValue" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="AssertTextEquals#assertValue" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />
	</command>

	<command name="viewDetails">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#_viewCalendarViaDialogBox">
			<var name="calendarName" value="${calendarName}" />
			<var name="schedulerEventDialogBox" value="${schedulerEventDialogBox}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetails">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="viewDetailsRate4Stars">
		<execute macro="CalendarEvent#viewDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<if>
			<equals arg1="${yourRating}" arg2="false" />
			<then>
				<execute function="AssertTextEquals" locator1="Ratings#YOUR_RATING_LABEL"  value1="Your Rating" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_1" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_2" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_3" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_4" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_5" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_5" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="Ratings#YOUR_RATING_LABEL"  value1="Your Rating" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_1" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_2" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_3" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_4" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_5" />
				<execute function="AssertElementPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="AssertElementNotPresent" locator1="Ratings#YOUR_RATING_STAR_EMPTY_5" />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="Ratings#AVERAGE_LABEL"  value1="Average (1 Vote)" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_1" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_2" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_3" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_4" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_5" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_1" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_2" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_3" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_4" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_5" />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewDetailsResources">
		<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#RESOURCES_FIELD" value1="${calendarName}" />
	</command>

	<command name="viewDetailsTags">
		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="AssertElementPresent" locator1="CalendarViewEventDetails#TAGS_LABEL" />
					<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="AssertElementPresent" locator1="CalendarViewEventDetails#TAGS_LABEL" />
				<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewInvitationResourceNotPresent">
		<execute macro="CalendarEvent#_expandInvitationsPanel" />

		<for list="${resourceNameList}" param="resourceName" >
			<execute function="Type" locator1="CalendarEditEvent#INVITATIONS_INVITE_RESOURCE_FIELD" value1="${resourceName}" />

			<var name="key_resource" value="${resourceName}" />

			<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#INVITATIONS_INVITE_RESOURCE_FIELD_LIST" />
		</for>
	</command>

	<command name="viewRepeatWeekStartDay">
		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_WEEKDAY_WEEK_START_DAY" value1="${weekStartDay}" />
	</command>

	<command name="viewRSVPAccepted">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="CalendarEditEvent#INVITATIONS_ACCEPTED" value1="${resourceName}" />
	</command>

	<command name="viewRSVPDeclined">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_DECLINED" value1="${resourceName}" />
	</command>

	<command name="viewRSVPMaybe">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_MAYBE" value1="${resourceName}" />
	</command>

	<command name="viewRSVPPending">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="CalendarEditEvent#INVITATIONS_PENDING" value1="${resourceName}" />
	</command>

	<command name="viewTimes">
		<execute function="AssertTextEquals#assertValue" locator1="CalendarEditEvent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="AssertTextEquals#assertValue" locator1="CalendarEditEvent#END_DATE_TIME" value1="${endDateTime}" />
	</command>

	<command name="viewTimesViaDetails">
		<execute function="AssertTextEquals#assertPartialText" locator1="CalendarViewEventDetails#START_DATE_FIELD" value1="${startDateTime}" />
		<execute function="AssertTextEquals#assertPartialText" locator1="CalendarViewEventDetails#END_DATE_FIELD" value1="${endDateTime}" />
	</command>

	<command name="viewTitleViaDetails">
		<execute macro="CalendarScheduler#_gotoDetailsViaDialogBox" />

		<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#EVENT_TITLE" value1="${eventTitle}" />
	</command>

	<command name="viewUnavailableCalendarsNotPresent">
		<execute macro="CalendarEvent#_expandDetailsPanel" />

		<for list="${unavailableCalendarList}" param="unavailableCalendarName">
			<var name="key_calendarName" value="${unavailableCalendarName}" />

			<execute function="AssertElementNotPresent" locator1="CalendarEditEvent#DETAILS_CALENDAR_SELECT_OPTION" />
		</for>
	</command>

	<command name="viewUsers">
		<execute macro="CalendarNavigator#gotoView">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarScheduler#selectEvent">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventTitleViaDialogBox">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarScheduler#viewEventUsersViaDialogBox">
			<var name="user" value="${user}" />
			<var name="usersList" value="${usersList}" />
		</execute>
	</command>
</definition>