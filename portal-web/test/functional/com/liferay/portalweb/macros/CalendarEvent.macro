<definition>
	<command name="addAllDayEventViaScheduler">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="SikuliClick" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_FIELD_PNG" />

		<execute macro="CalendarEvent#editTitleViaScheduler">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<if>
			<isset var="calendarName" />
			<then>
				<execute macro="CalendarEvent#selectCalendarViaScheduler">
					<var name="calendarName" value="${calendarName}" />
				</execute>
			</then>
		</if>

		<execute macro="CalendarEvent#saveViaScheduler" />
	</command>

	<command name="addCommentPG">
		<execute macro="CalendarEvent#viewEventDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_BE_THE_FIRST" value1="Be the first." />

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">

					<if>
						<condition function="IsElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_ADD_COMMENT_LINK" />
						<then>
							<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_ADD_COMMENT_LINK" value1="Add Comment" />
							<execute function="MakeVisible" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" />
							<execute function="Type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />
						</then>
						<else>
							<execute function="Type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />
						</else>
					</if>

					<if>
						<condition function="IsElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" />
						<then>
							<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
						</then>
						<else>
							<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_REPLY_BUTTON" value1="Reply" />
						</else>
					</if>

					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#SUCCESS_MESSAGE" value1="Your request processed successfully." />
				</for>
			</then>
			<else>
				<execute function="Type" locator1="PGCalendarVieweventdetails#COMMENTS_TEXT_AREA" value1="${eventComment}" />

				<if>
					<condition function="IsElementPresent" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" />
					<then>
						<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
					</then>
					<else>
						<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_REPLY_BUTTON" value1="Reply" />
					</else>
				</if>

				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#SUCCESS_MESSAGE" value1="Your request processed successfully." />
			</else>
		</if>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_eventComment" value="${eventComment}" />
					<var name="key_user" value="${user}" />

					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_eventComment" value="${eventComment}" />
				<var name="key_user" value="${user}" />

				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="addPG">
		<execute macro="CalendarEvent#editTitle">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="AssertNotChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="AssertNotChecked" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />

				<var locator="PGCalendarAddevent#END_DATE" name="endDate" />
				<var locator="PGCalendarAddevent#END_DATE_TIME" name="endDateTime" />
				<var locator="PGCalendarAddevent#START_DATE" name="startDate" />
				<var locator="PGCalendarAddevent#START_DATE_TIME" name="startDateTime" />

				<execute macro="CalendarEvent#selectCalendar" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>

				<execute macro="CalendarEvent#save" />

				<execute macro="CalendarEvent#viewRegularEventTitleViaMonthViewCmd">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
				</execute>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="All Day" />
				<then>
					<var name="endDateTime" value="11:59 PM" />
					<var name="startDateTime" value="12:00 AM" />

					<execute function="Check" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
					<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#START_DATE_TIME" />
					<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#END_DATE_TIME" />

					<var locator="PGCalendarAddevent#END_DATE" name="endDate" />
					<var locator="PGCalendarAddevent#START_DATE" name="startDate" />

					<execute macro="CalendarEvent#selectCalendar" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>

					<execute macro="CalendarEvent#save" />

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<if>
						<equals arg1="${reminders}" arg2="true" />
						<then>
							<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_WITH_REMINDER" />
							<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_TITLE_WITH_REMINDER" value1="${eventTitle}" />
						</then>
						<else>
							<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY" />
							<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_ALL_DAY_TITLE" value1="${eventTitle}" />
						</else>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<var locator="PGCalendarAddevent#END_DATE" name="endDate" />
					<var locator="PGCalendarAddevent#END_DATE_TIME" name="endDateTime" />
					<var locator="PGCalendarAddevent#START_DATE" name="startDate" />
					<var locator="PGCalendarAddevent#START_DATE_TIME" name="startDateTime" />

					<execute macro="CalendarEvent#setRepeating">
						<var name="frequency" value="${frequency}" />
					</execute>

					<execute macro="CalendarEvent#selectCalendar" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>

					<execute macro="CalendarEvent#save" />

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${endDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${startDateTime}" />

					<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addCommentPG">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>

		<if>
			<equals arg1="${addRSVPEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addRSVP">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="rsvp" value="${rsvp}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="addRSVP">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />

		<var name="key_rsvp" value="${rsvp}" />

		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_ACTIVE" value1="${rsvp}" />

		<execute function="Pause" value1="3000" />

		<if>
			<equals arg1="${rsvp}" arg2="No" />
			<then>
				<execute macro="CalendarEvent#viewSpecificEventNotPresent">
					<var name="eventTitle" value="${eventTitle}" />
				</execute>
			</then>
			<else>
				<execute macro="CalendarEvent#selectViaSchedulerCmd">
					<var name="eventTitle" value="${eventTitle}" />
				</execute>

				<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_INACTIVE" value1="${rsvp}" />
			</else>
		</if>
	</command>

	<command name="addSetTime">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendar#ADD_EVENT_BUTTON" value1="Add Event" />

		<execute macro="CalendarEvent#selectEventIframeCmd" />

		<execute function="Type" locator1="PGCalendarAddevent#TITLE_FIELD" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewNewEventIframeCmd" />

		<if>
			<equals arg1="${eventType}" arg2="Regular" />
			<then>
				<execute function="AssertNotChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="AssertNotChecked" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
				<execute function="Type" locator1="PGCalendarAddevent#START_DATE_TIME" value1="${setStartDateTime}" />
				<execute function="Type" locator1="PGCalendarAddevent#END_DATE_TIME" value1="${setEndDateTime}" />

				<var locator="PGCalendarAddevent#START_DATE" name="startDate" />
				<var name="endDate" value="${startDate}" />

				<execute function="Type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />

				<execute macro="CalendarEvent#selectCalendar" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>

				<execute macro="CalendarEvent#save" />

				<execute macro="CalendarEvent#viewRegularEventTitleViaMonthViewCmd">
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${endDateTime}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${startDateTime}" />
				</execute>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="Type" locator1="PGCalendarAddevent#START_DATE_TIME" value1="${setStartDateTime}" />
					<execute function="Type" locator1="PGCalendarAddevent#END_DATE_TIME" value1="${setEndDateTime}" />

					<var locator="PGCalendarAddevent#START_DATE" name="startDate" />
					<var name="endDate" value="${startDate}" />

					<execute function="Type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />
					<execute function="Check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
					<execute function="AssertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="Daily" />
					<execute function="AssertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />
					<execute function="Click" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_RADIO" />
					<execute function="Type" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_FIELD" value1="1" />
					<execute function="Click" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" />
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" value1="Daily, 1 Times" />
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
					<execute function="Check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="Daily, 1 Times" />

					<execute macro="CalendarEvent#selectCalendar" />

					<execute function="Click" locator1="PGCalendarAddevent#SAVE_BUTTON" />
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
					<execute function="SelectFrame" value1="relative=top" />

					<execute macro="Page#gotoPG">
						<var name="pageName" value="${pageName}" />
					</execute>

					<var name="key_endDate" value="${endDate}" />
					<var name="key_endDateTime" value="${setEndDateTime}" />
					<var name="key_startDate" value="${startDate}" />
					<var name="key_startDateTime" value="${setStartDateTime}" />

					<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT" />
					<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REPEAT_TITLE" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${eventCommentEnabled}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#addCommentPG">
					<var name="calendarName" value="${calendarName}" />
					<var name="endDate" value="${endDate}" />
					<var name="endDateTime" value="${setEndDateTime}" />
					<var name="eventComment" value="${eventComment}" />
					<var name="eventTitle" value="${eventTitle}" />
					<var name="eventType" value="${eventType}" />
					<var name="startDate" value="${startDate}" />
					<var name="startDateTime" value="${setStartDateTime}" />
					<var name="user" value="${user}" />
				</execute>
			</then>
		</if>
	</command>

	<command name="addViaDayView">
		<execute macro="CalendarEvent#gotoAddViaDayView" />

		<execute macro="CalendarEvent#editTitleViaScheduler">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#saveViaScheduler" />
	</command>

	<command name="assertDialogBoxPresentCmd">
		<if>
			<equals arg1="${schedulerEventDialogBox}" arg2="false" />
			<then>
				<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
			<else>
				<execute function="AssertSelectedLabel" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
			</else>
		</if>
	</command>

	<command name="changeCalendarViaScheduler">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarDefaultName}" />
		<execute function="Select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />

		<execute macro="CalendarEvent#saveViaScheduler" />

		<if>
			<condition function="IsElementPresent" locator1="PGCalendarRecurringEventDialogBox#RECURRING_EVENT_DIALOG_BOX_HEADER" />
			<then>
				<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series" />
			</then>
		</if>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
	</command>

	<command name="changeViewPG">
		<if>
			<equals arg1="${viewType}" arg2="Day" />
			<then>
				<if>
					<condition function="IsElementNotPresent" locator1="PGCalendar#VIEW_DAY_BUTTON_ACTIVE" />
					<then>
						<execute function="AssertClick" locator1="PGCalendar#VIEW_DAY_BUTTON" value1="${viewType}" />
					</then>
				</if>

				<execute function="AssertElementPresent" locator1="PGCalendarDayView#SCHEDULER_VIEW_DAY" />
			</then>
			<elseif>
				<equals arg1="${viewType}" arg2="Week" />
				<then>
					<if>
						<condition function="IsElementNotPresent" locator1="PGCalendar#VIEW_WEEK_BUTTON_ACTIVE" />
						<then>
							<execute function="AssertClick" locator1="PGCalendar#VIEW_WEEK_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_VIEW_WEEK" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${viewType}" arg2="Month" />
				<then>
					<if>
						<condition function="IsElementNotPresent" locator1="PGCalendar#VIEW_MONTH_BUTTON_ACTIVE" />
						<then>
							<execute function="AssertClick" locator1="PGCalendar#VIEW_MONTH_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="AssertElementPresent" locator1="PGCalendarMonthView#SCHEDULER_VIEW_MONTH" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${viewType}" arg2="Agenda" />
				<then>
					<if>
						<condition function="IsElementNotPresent" locator1="PGCalendar#VIEW_AGENDA_BUTTON_ACTIVE" />
						<then>
							<execute function="AssertClick" locator1="PGCalendar#VIEW_AGENDA_BUTTON" value1="${viewType}" />
						</then>
					</if>

					<execute function="AssertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_VIEW_AGENDA" />
				</then>
			</elseif>
		</if>

		<execute function="Pause" locator1="3000" />
	</command>

	<command name="delete">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="i" value="1" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
			<then>
				<execute function="Click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />

				<if>
					<condition function="IsElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
					<then>
						<var method="MathUtil#sum('${i}', '1')" name="i" />

						<execute function="Click" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')])[${i}]" />
					</then>
					<else>
						<if>
							<condition function="IsElementNotPresent" locator1="xpath=(//input[contains(@value,'Repeating')])" />
							<then>
								<execute function="Pause" value1="1000" />
								<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
								<execute function="Pause" value1="1000" />
								<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />
							</then>
							<else>
								<execute function="Pause" value1="1000" />
								<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
								<execute function="Pause" value1="1000" />
								<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
							</else>
						</if>
					</else>
				</if>
			</then>
		</while>

		<execute function="AssertTextEquals" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
		<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_GENERIC" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_REPEATING" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="deleteCommentPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetailsCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<var name="key_eventComment" value="${eventComment}" />

		<if>
			<equals arg1="${soPage}" arg2="true" />
			<then>
				<execute function="AssertClickNoError" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="Confirm" value1="Are you sure you want to delete the selected comment?" />
			</then>
			<else>
				<execute function="AssertClickNoError" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_DELETE" value1="Delete" />
				<execute function="Confirm" value1="Are you sure you want to delete this? It will be deleted immediately." />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_SUCCESS" value1="Your request processed successfully." />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="deletePG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClickNoError" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="deleteRepeatingEventViaAgendaViewPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<or>
				<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
			</or>
			<then>
				<execute function="AssertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="AssertClick" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute function="AssertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />
		<execute function="Pause" value1="1000" />
		<execute function="ClickNoError" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Pause" value1="1000" />

		<if>
			<equals arg1="${deleteOptionSet}" arg2="All Events in the Series" />
			<then>
				<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series" />

				<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
			</then>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="All Following" />
				<then>
					<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_FOLLOWING_BUTTON" value1="All Following" />

					<execute function="AssertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${deleteOptionSet}" arg2="Only This Instance" />
				<then>
					<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ONLY_THIS_INSTANCE_BUTTON" value1="Only This Instance" />

					<execute function="AssertElementPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_1" value1="${eventTitle}" />
					<execute function="AssertElementNotPresent" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC_2" value1="${eventTitle}" />
				</then>
			</elseif>
		</if>

		<execute function="Refresh" />
	</command>

	<command name="deleteViaAgendaViewPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="AssertClick#assertPartialTextClickAt" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClickNoError" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" value1="Delete" />
		<execute function="Confirm#waitForConfirmation" value1="Deleting this event will cancel the meeting with your guests. Would you like to delete?" />

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="editAllDayEventViaScheduler">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="Type" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitleEdit}" />

		<if>
			<isset var="calendarName" />
			<then>
				<execute function="Select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
		</if>

		<execute macro="CalendarEvent#saveViaScheduler" />
	</command>

	<command name="editCommentPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetailsCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<var name="key_eventComment" value="${eventComment}" />

		<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT" value1="Edit" />
		<execute function="Type" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT_BODY_FIELD" value1="${eventCommentEdit}" />
		<execute function="AssertClick" locator1="PGCalendarVieweventdetails#COMMENTS_COMMENT_EDIT_PUBLISH_BUTTON" value1="Publish" />

		<var name="key_eventComment" value="${eventCommentEdit}" />

		<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventCommentEdit}" />
		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="editPG">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="SelectFrame" locator1="PGCalendarEditevent#EDIT_EVENT_IFRAME" />

		<if>
			<equals arg1="${eventType}" arg2="All Day" />
			<then>
				<var name="endDateTime" value="11:59 PM" />
				<var name="startDateTime" value="12:00 AM" />

				<execute function="AssertChecked" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
				<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#START_DATE_TIME" />
				<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#END_DATE_TIME" />

				<var locator="PGCalendarEditevent#END_DATE" name="endDate" />
				<var locator="PGCalendarEditevent#START_DATE" name="startDate" />

				<execute function="AssertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
				<execute function="Type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
				<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
				<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE" />

				<if>
					<equals arg1="${optionSet}" arg2="true" />
					<then>
						<execute macro="CalendarEvent#optionsCmd" />
					</then>
				</if>
			</then>
			<elseif>
				<equals arg1="${eventType}" arg2="Regular" />
				<then>
					<execute function="AssertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
					<execute function="Type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

					<var locator="PGCalendarEditevent#END_DATE" name="endDate" />
					<var locator="PGCalendarEditevent#START_DATE" name="startDate" />

					<execute function="Type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="Click" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="Type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="Click" locator1="PGCalendarEditevent#END_DATE_TIME" />
					<execute function="Pause" value1="1000" />

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>
				</then>
			</elseif>
			<elseif>
				<equals arg1="${eventType}" arg2="Repeating" />
				<then>
					<execute function="AssertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
					<execute function="Type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
					<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

					<var locator="PGCalendarEditevent#END_DATE" name="endDate" />
					<var locator="PGCalendarEditevent#START_DATE" name="startDate" />

					<execute function="Type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
					<execute function="Click" locator1="PGCalendarEditevent#START_DATE_TIME" />
					<execute function="Type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
					<execute function="Click" locator1="PGCalendarEditevent#END_DATE_TIME" />
					<execute function="Pause" value1="1000" />
					<execute function="AssertChecked" locator1="PGCalendarEditevent#REPEAT_CHECKBOX" />
					<execute function="AssertTextEquals" locator1="PGCalendarEditevent#REPEAT_SUMMARY_1" value1="Daily, 1 Times" />
					<execute function="Click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

					<if>
						<condition function="IsElementPresent" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" />
						<then>
							<execute function="AssertClick" locator1="PGCalendarRecurringEventDialogBox#ALL_EVENTS_IN_THE_SERIES_BUTTON" value1="All Events in the Series"  />
						</then>
					</if>

					<if>
						<equals arg1="${optionSet}" arg2="true" />
						<then>
							<execute macro="CalendarEvent#optionsCmd" />
						</then>
					</if>
				</then>
			</elseif>
		</if>

		<execute function="Click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

		<if>
			<equals arg1="${inviteResource}" arg2="true" />
			<then>
				<execute function="AssertElementPresent" locator1="PGCalendarAreYouSureDialogBox#ARE_YOU_SURE_DIALOG_BOX_HEADER" value1="Are you sure?" />
				<execute function="AssertTextEquals" locator1="PGCalendarAreYouSureDialogBox#ARE_YOU_SURE_DIALOG_BOX_BODY" value1="You are about to make changes that will only affect your calendar (${calendarName})." />
				<execute function="AssertClick" locator1="PGCalendarAreYouSureDialogBox#SAVE_CHANGES_BUTTON" value1="Save changes." />
			</then>
		</if>

		<execute function="AssertTextEquals" locator1="PGCalendarEditevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="SelectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<var name="key_eventTitle" value="${eventTitleEdit}" />

		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="editTitle">
		<execute function="Type" locator1="PGCalendarAddevent#TITLE_FIELD" value1="${eventTitle}" />
	</command>

	<command name="editTitleViaScheduler">
		<execute function="Type" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
	</command>

	<command name="editViaAgendaViewPG">
		<if>
			<isset var="endDateTimeEdit" />
			<then>
				<var name="endDateTime" value="${endDateTimeEdit}" />
			</then>
			<else>
				<var name="endDateTime" value="09:30 AM" />
			</else>
		</if>

		<if>
			<isset var="startDateTimeEdit" />
			<then>
				<var name="startDateTime" value="${startDateTimeEdit}" />
			</then>
			<else>
				<var name="startDateTime" value="08:30 AM" />
			</else>
		</if>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="AssertClick#assertPartialTextClickAt" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="SelectFrame" locator1="PGCalendarEditevent#EDIT_EVENT_IFRAME" />
		<execute function="AssertTextEquals" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitle}" />
		<execute function="Type" locator1="PGCalendarEditevent#TITLE_FIELD" value1="${eventTitleEdit}" />
		<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE" />
		<execute function="AssertElementPresent" locator1="PGCalendarEditevent#START_DATE_TIME" />
		<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE" />
		<execute function="AssertElementPresent" locator1="PGCalendarEditevent#END_DATE_TIME" />

		<var locator="PGCalendarEditevent#END_DATE" name="endDate" />
		<var locator="PGCalendarEditevent#START_DATE" name="startDate" />

		<execute function="Type" locator1="PGCalendarEditevent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="Click" locator1="PGCalendarEditevent#START_DATE_TIME" />
		<execute function="Type" locator1="PGCalendarEditevent#END_DATE_TIME" value1="${endDateTime}" />
		<execute function="Click" locator1="PGCalendarEditevent#END_DATE_TIME" />
		<execute function="Pause" value1="1000" />
		<execute function="Click" locator1="PGCalendarEditevent#SAVE_BUTTON" />

		<execute function="AssertTextEquals" locator1="PGCalendarEditevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="SelectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="AssertTextEquals#assertPartialText" locator1="PGCalendarAgendaView#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitleEdit}" />
	</command>

	<command name="expandDetailsPanelCmd">
		<if>
			<condition function="IsElementPresent" locator1="PGCalendarAddevent#DETAILS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#DETAILS_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="PGCalendarAddevent#DETAILS_PANEL_EXPANDED" />
			</then>
		</if>
	</command>

	<command name="gotoAdd">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendar#ADD_EVENT_BUTTON" value1="Add Event" />

		<execute macro="CalendarEvent#selectEventIframeCmd" />

		<execute macro="CalendarEvent#viewNewEventIframeCmd" />
	</command>

	<command name="gotoAddOnSpecifcDayOfWeekViaWeekView">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_dayOfWeek" value="${dayOfWeek}" />

		<execute function="Click" locator1="PGCalendar#SCHEDULER_SPECIFIC_DAY" />

		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="e.g., Dinner at Brian's" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE_GUEST" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_ACTIVE" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_ATTEND_INACTIVE" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_SAVE_BUTTON" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_DELETE_BUTTON" />

		<execute function="AssertClick#assertTextClickAtAndWait" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute macro="CalendarEvent#selectEventIframeCmd" />
	</command>

	<command name="gotoAddViaDayView">
		<execute function="SikuliClick" locator1="PGCalendar#SCHEDULER_DAY_VIEW_PNG" />
	</command>

	<command name="gotoEdit">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EDIT_BUTTON" value1="Edit" />

		<execute function="SelectFrame" locator1="PGCalendarEditevent#EDIT_EVENT_IFRAME" />
	</command>

	<command name="gotoNextDay">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="Click" locator1="PGCalendar#VIEW_NEXT_BUTTON" />
	</command>

	<command name="gotoPreviousDay">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="Click" locator1="PGCalendar#VIEW_PREVIOUS_BUTTON" />
	</command>

	<command name="gotoRepeatConfiguration">
		<execute function="Check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
	</command>

	<command name="inviteResource">
		<if>
			<condition function="IsElementPresent" locator1="PGCalendarAddevent#INVITATIONS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#INVITATIONS_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_PANEL_EXPANDED" />
			</then>
		</if>

		<for list="${resourceNameList}" param="resourceName" >
			<execute function="Type" locator1="PGCalendarAddevent#INVITATIONS_INVITE_RESOURCE_FIELD" value1="${resourceName}" />

			<var name="key_resource" value="${resourceName}" />

			<execute function="Click" locator1="PGCalendarAddevent#INVITATIONS_INVITE_RESOURCE_FIELD_LIST" value1="${resourceName}" />

			<execute macro="CalendarEvent#viewRSVPPending">
				<var name="resourceName" value="${resourceName}" />
			</execute>
		</for>
	</command>

	<command name="optionsCmd">
		<if>
			<equals arg1="${viewPermission}" arg2="true" />
			<then>
				<execute function="Select" locator1="PGCalendarAddevent#DETAILS_PERMISSIONS_VIEWABLE_BY_SELECT" value1="${viewPermissionValue}" />
			</then>
		</if>

		<if>
			<equals arg1="${permissions}" arg2="true" />
			<then>
				<var name="key_permissionDefinitionKey" value="${permissionDefinitionKey}" />
				<var name="key_roleName" value="${roleName}" />

				<execute function="Check" locator1="PGCalendarAddevent#DETAILS_PERMISSIONS_CHECKBOX" />
			</then>
		</if>

		<if>
			<equals arg1="${inviteResource}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#inviteResource" />
			</then>
		</if>

		<if>
			<equals arg1="${reminders}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#reminders" />
			</then>
		</if>

		<if>
			<equals arg1="${resourcesAvailability}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#resourcesAvailability" />
			</then>
		</if>

		<if>
			<equals arg1="${tag}" arg2="true" />
			<then>
				<execute macro="CalendarEvent#tag" />
			</then>
		</if>
	</command>

	<command name="rate4StarsPG">
		<execute macro="CalendarEvent#viewEventDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="Click" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_CLICK_4" />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="reminders">
		<if>
			<condition function="IsElementPresent" locator1="PGCalendarAddevent#REMINDERS_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#REMINDERS_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="PGCalendarAddevent#REMINDERS_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="Check" locator1="PGCalendarAddevent#REMINDERS_EMAIL_CHECKBOX_1" />
		<execute function="Check" locator1="PGCalendarAddevent#REMINDERS_EMAIL_CHECKBOX_2" />

		<execute function="Type" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_ACTIVE_1" value1="${number1}" />
		<execute function="Type" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_ACTIVE_2" value1="${number2}" />

		<execute function="Select" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_ACTIVE_1" value1="${duration1}" />
		<execute function="Select" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_ACTIVE_2" value1="${duration2}" />

		<execute function="AssertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_INACTIVE_1" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_VALUE_INPUT_INACTIVE_2" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_INACTIVE_1" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarAddevent#REMINDERS_DURATION_SELECT_INACTIVE_2" />
	</command>

	<command name="resourcesAvailability">
		<if>
			<condition function="IsElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="AssertElementPresent" locator1="PGCalendarAddevent#INVITATIONS_RESOURCES_AVAILABILITY_SCHEDULER_EVENT_GENERIC" />
	</command>

	<command name="save">
		<execute function="Click" locator1="PGCalendarAddevent#SAVE_BUTTON" />
		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="SelectFrame" value1="relative=top" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>
	</command>

	<command name="saveViaScheduler">
		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_SAVE_BUTTON" value1="Save" />
	</command>

	<command name="selectCalendar">
		<if>
			<isset var="calendarName" />
			<then>
				<execute macro="CalendarEvent#expandDetailsPanelCmd" />

				<execute function="Select" locator1="PGCalendarAddevent#DETAILS_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
		</if>
	</command>

	<command name="selectCalendarViaScheduler">
		<execute function="Select" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
	</command>

	<command name="selectEventIframeCmd">
		<execute function="SelectFrame" locator1="PGCalendarAddevent#ADD_EVENT_IFRAME" />
	</command>

	<command name="selectRepeatFrequency">
		<execute function="Select" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
		<execute function="AssertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEATS_DROPDOWN" value1="${frequency}" />
	</command>

	<command name="selectViaSchedulerCmd">
		<var name="key_eventTitle" value="${eventTitle}" />

		<if>
			<equals arg1="${eventType}" arg2="All Day" />
			<then>
				<execute function="AssertClick#assertTextClickNoMouseOver" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />
			</then>
			<else>
				<execute function="AssertClick#assertTextClickNoMouseOver" locator1="PGCalendar#SCHEDULER_REGULAR_EVENT_SPECIFIC_CURRENT_DAY_VIA_DAY_OR_WEEK_VIEW" value1="${eventTitle}" />
			</else>
		</if>
	</command>

	<command name="setAllDay">
		<execute function="Check" locator1="PGCalendarAddevent#ALL_DAY_CHECKBOX" />
		<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#START_DATE_TIME" />
		<execute function="AssertElementNotPresent#assertNotVisible" locator1="PGCalendarAddevent#END_DATE_TIME" />
	</command>

	<command name="setDates">
		<execute function="Type" locator1="PGCalendarAddevent#START_DATE" value1="${startDate}" />
		<execute function="Type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />
	</command>

	<command name="setDatesToday">
		<var locator="PGCalendarAddevent#START_DATE" name="endDate" />

		<execute function="Type" locator1="PGCalendarAddevent#END_DATE" value1="${endDate}" />
	</command>

	<command name="setRepeating">
		<execute macro="CalendarEvent#gotoRepeatConfiguration" />

		<execute macro="CalendarEvent#selectRepeatFrequency">
			<var name="frequency" value="${frequency}" />
		</execute>

		<execute function="AssertSelectedLabel" locator1="PGCalendarAddevent#REPEAT_REPEAT_EVERY_DROPDOWN" value1="1" />

		<if>
			<isset var="position" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_RADIO" />
				<execute function="Select" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_POSITION_DROPDOWN" value1="${position}" />
				<execute function="Select" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_WEEKDAY_DROPDOWN" value1="${weekday}" />
			</then>
		</if>

		<if>
			<isset var="numberOfOccurrences" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_RADIO" />
				<execute function="Pause" value1="1000" />
				<execute function="Type" locator1="PGCalendarAddevent#REPEAT_ENDS_AFTER_FIELD" value1="${numberOfOccurrences}" />
			</then>
		</if>

		<execute function="Pause" value1="1000" />
		<execute function="Click" locator1="PGCalendarAddevent#REPEAT_SUMMARY_2" />
		<execute function="Pause" value1="1000" />

		<if>
			<and>
				<isset var="position" />
				<isset var="month" />
			</and>
			<then>
				<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency} On The ${position} ${weekday} Of ${month}" />
			</then>
			<elseif>
				<and>
					<isset var="position" />
					<isset var="numberOfOccurrences" />
				</and>
				<then>
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency} On ${position} ${weekday}, ${numberOfOccurrences} Times" />
				</then>
			</elseif>
			<elseif>
				<isset var="position" />
				<then>
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency} On ${position} ${weekday}" />
				</then>
			</elseif>
			<elseif>
				<isset var="numberOfOccurrences" />
				<then>
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_SUMMARY_1" value1="${frequency}, ${numberOfOccurrences} Times" />
				</then>
			</elseif>
		</if>

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
		<execute function="Click" locator1="PGCalendarAddevent#REPEAT_DONE_BUTTON" value1="Done" />
		<execute function="Check" locator1="PGCalendarAddevent#REPEAT_CHECKBOX" />
	</command>

	<command name="setTimes">
		<execute function="Type" locator1="PGCalendarAddevent#START_DATE_TIME" value1="${startDateTime}" />
		<execute function="Type" locator1="PGCalendarAddevent#END_DATE_TIME" value1="${endDateTime}" />
	</command>

	<command name="tag">
		<if>
			<condition function="IsElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_COLLAPSED" />
			<then>
				<execute function="Click" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_PANEL_EXPANDED" />
			</then>
		</if>

		<execute function="AssertElementPresent" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" />

		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="Type#typePause" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
					<execute function="AssertClick" locator1="PGCalendarAddevent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
					<execute function="AssertTextEquals" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="AssertClick" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" />
				<execute function="Type#typePause" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_FIELD" value1="${tagText}" />
				<execute function="AssertClick" locator1="PGCalendarAddevent#CATEGORIZATION_ADD_TAGS_BUTTON" value1="Add" />
				<execute function="AssertTextEquals" locator1="PGCalendarAddevent#CATEGORIZATION_TAG_SPECIFIC" value1="${tagText}" />
			</else>
		</if>
	</command>

	<command name="tearDown">
		<if>
			<equals arg1="${marketplace}" arg2="true" />
			<then>
				<execute macro="Page#addPG">
					<var name="pageName" value="Marketplace Calendar Testing" />
				</execute>

				<execute macro="Portlet#addPG">
					<var name="pageName" value="Marketplace Calendar Testing" />
					<var name="portletName" value="Calendar" />
				</execute>

				<execute macro="Page#gotoPG">
					<var name="pageName" value="Marketplace Calendar Testing" />
				</execute>
			</then>
		</if>

		<execute macro="CalendarEvent#delete" />
	</command>

	<command name="tearDownOnBusyDayInCurrentMonth">
		<execute macro="Calendar#gotoBusyDayViaSmallCalendar" />

		<execute macro="CalendarEvent#delete" />
	</command>

	<command name="viewAgendaPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="AssertElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="AssertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-agenda-event') and contains(@data-clientid,'scheduler-event')]//div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var method="MathUtil#sum('${i}', '1')" name="i" />
			</then>
		</while>

		<execute function="AssertTextNotPresent" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />
	</command>

	<command name="viewAvailableCalendars">
		<execute macro="CalendarEvent#expandDetailsPanelCmd" />

		<for list="${availableCalendarList}" param="availableCalendarName">
			<var name="key_calendarName" value="${availableCalendarName}" />

			<execute function="AssertElementPresent" locator1="PGCalendarAddevent#DETAILS_CALENDAR_SELECT_OPTION" />
		</for>
	</command>

	<command name="viewCalendarViaSchedulerDialogBoxCmd">
		<if>
			<equals arg1="${schedulerEventDialogBox}" arg2="false" />
			<then>
				<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
			</then>
			<else>
				<execute function="AssertSelectedLabel" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_CALENDAR_SELECT" value1="${calendarName}" />
			</else>
		</if>
	</command>

	<command name="viewColorDefaultPG">
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR_DEFAULT" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR_DEFAULT" />
	</command>

	<command name="viewColorPG">
		<var name="key_backgroundColor" value="${eventBackgroundColorRGB}" />
		<var name="key_eventTitle" value="${eventTitle}" />
		<var name="key_fontColor" value="${eventFontColorRGB}" />

		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_BACKGROUND_COLOR_DEFAULT" />
		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_FONT_COLOR_DEFAULT" />
	</command>

	<command name="viewCommentPG">
		<execute macro="CalendarEvent#viewEventDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<if>
			<isset var="eventCommentList" />
			<then>
				<for list="${eventCommentList}" param="eventComment">
					<var name="key_eventComment" value="${eventComment}" />
					<var name="key_user" value="${user}" />

					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
				</for>
			</then>
			<else>
				<var name="key_eventComment" value="${eventComment}" />
				<var name="key_user" value="${user}" />

				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_USER_NAME" value1="${user}" />
				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#COMMENTS_BODY" value1="${eventComment}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewDayPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="Pause" value1="1000" />

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//td[contains(@class,'scheduler-view-day-table-col scheduler-view-day-table-colday scheduler-today')]//div[@class='scheduler-event-content' and contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<if>
					<condition function="IsElementPresent#isVisible" locator1="xpath=(//td[contains(@class,'scheduler-view-day-table-col scheduler-view-day-table-colday scheduler-today')]//div[@class='scheduler-event-content' and contains(.,'${key_eventTitle}')])[${i}]" />
					<then>
						<execute function="AssertTextEquals" locator1="xpath=(//td[contains(@class,'scheduler-view-day-table-col scheduler-view-day-table-colday scheduler-today')]//div[@class='scheduler-event-content' and contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />

						<var method="MathUtil#sum('${i}', '1')" name="i" />
					</then>
				</if>
			</then>
		</while>
	</command>

	<command name="viewDefaultDayPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute function="Pause" value1="1000" />

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="viewDefaultPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Day" />
		</execute>

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute function="AssertTextNotPresent" value1="${eventTitle}" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Month" />
		</execute>

		<execute macro="Page#gotoPG">
			<var name="pageName" value="${pageName}" />
		</execute>

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Agenda" />
		</execute>

		<execute function="AssertTextEquals" locator1="PGCalendarAgendaView#EMPTY_MESSAGE" value1="No events." />

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewDefaultWeekPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#viewSpecificEventNotPresent">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="viewEventDetails">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
			<var name="eventType" value="${eventType}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewCalendarViaSchedulerDialogBoxCmd">
			<var name="calendarName" value="${calendarName}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaDetailsCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>
	</command>

	<command name="viewEventDetailsResources">
		<execute function="AssertTextEquals" locator1="CalendarViewEventDetails#RESOURCES_FIELD" value1="${calendarName}" />
	</command>

	<command name="viewEventDetailsTags">
		<if>
			<isset var="tagTextList" />
			<then>
				<for list="${tagTextList}" param="tagText">
					<var name="key_tagText" value="${tagText}" />

					<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#TAGS_LABEL" />
					<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
				</for>
			</then>
			<else>
				<var name="key_tagText" value="${tagText}" />

				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#TAGS_LABEL" />
				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#TAGS_TAG_SPECIFIC" value1="Tags: ${tagText}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewEventDetailsTime">
		<execute function="AssertTextEquals#assertPartialText" locator1="PGCalendarVieweventdetails#START_DATE_FIELD" value1="${startDateTime}" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGCalendarVieweventdetails#END_DATE_FIELD" value1="${endDateTime}" />
	</command>

	<command name="viewEventWithRemindersPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="key_eventTitle" value="${eventTitle}" />
		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" value1="${eventTitle}" />

		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC_REMINDER_ICON" value1="${eventTitle}" />
	</command>

	<command name="viewMonthPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Month" />
		</execute>

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<if>
					<condition function="IsElementPresent#isVisible" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
					<then>
						<execute function="AssertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />

						<var method="MathUtil#sum('${i}', '1')" name="i" />
					</then>
					<elseif>
						<condition function="IsElementNotPresent#isNotVisible" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[2]" />
						<then>
							<execute function="Click" locator1="PGCalendar#VIEW_NEXT_BUTTON"  />

							<execute function="AssertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[1]" value1="${eventTitle}" />
						</then>
					</elseif>
				</if>
			</then>
		</while>

		<if>
			<isset var="eventNumber" />
			<then>
				<var name="key_eventNumber" value="${eventNumber}" />

				<if>
					<condition function="IsElementPresent" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_LINK" />
					<then>
						<execute function="AssertClick" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_LINK" value1="Show ${eventNumber} more" />
						<execute function="AssertElementPresent" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_DIALOG_BOX" />

						<while>
							<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
							<then>
								<execute function="AssertElementPresent" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
								<execute function="AssertTextEquals" locator1="xpath=(//div[contains(@class,'scheduler-view-table scheduler-view-month')]//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
								<var method="MathUtil#sum('${i}', '1')" name="i" />
							</then>
						</while>

						<execute function="AssertClick" locator1="PGCalendarMonthView#SCHEDULER_EVENT_MONTH_VIEW_SHOW_MORE_CLOSE_LINK" value1="Close" />
					</then>
				</if>
			</then>
		</if>
	</command>

	<command name="viewNewEventIframeCmd">
		<execute function="AssertElementPresent#assertVisible" locator1="PGCalendarAddevent#START_DATE" />
		<execute function="AssertElementPresent#assertVisible" locator1="PGCalendarAddevent#START_DATE_TIME" />
		<execute function="AssertElementPresent#assertVisible" locator1="PGCalendarAddevent#END_DATE" />
		<execute function="AssertElementPresent#assertVisible" locator1="PGCalendarAddevent#END_DATE_TIME" />
	</command>

	<command name="viewPG">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute macro="CalendarEvent#viewDayPG" />
		<execute macro="CalendarEvent#viewWeekPG" />
		<execute macro="CalendarEvent#viewMonthPG" />
		<execute macro="CalendarEvent#viewAgendaPG" />

		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>
	</command>

	<command name="viewRate4StarsPG">
		<execute macro="CalendarEvent#viewEventDetails">
			<var name="calendarName" value="${calendarName}" />
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<if>
			<equals arg1="${yourRating}" arg2="false" />
			<then>
				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#YOUR_RATING"  value1="Your Rating" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_1" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_2" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_3" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_4" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_5" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_5" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#YOUR_RATING"  value1="Your Rating" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_1" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_2" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_3" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_4" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_5" />
				<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_1" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_2" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_3" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_4" />
				<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#YOUR_RATING_STAR_EMPTY_5" />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#AVERAGE"  value1="Average (1 Vote)" />
		<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_1" />
		<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_2" />
		<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_3" />
		<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_4" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_5" />
		<execute function="AssertElementPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_1" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_2" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_3" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_4" />
		<execute function="AssertElementNotPresent" locator1="PGCalendarVieweventdetails#AVERAGE_STAR_EMPTY_5" />

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewRegularEventTitleViaMonthViewCmd">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Month" />
		</execute>

		<var name="key_endDate" value="${endDate}" />
		<var name="key_endDateTime" value="${endDateTime}" />
		<var name="key_startDate" value="${startDate}" />
		<var name="key_startDateTime" value="${startDateTime}" />

		<execute function="AssertElementPresent" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR" />
		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_REGULAR_TITLE_VIA_MONTH" value1="${eventTitle}" />
	</command>

	<command name="viewRepeatWeekStartDay">
		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#REPEAT_REPEAT_ON_DAY_OF_THE_WEEK_WEEKDAY_WEEK_START_DAY" value1="${weekStartDay}" />
	</command>

	<command name="viewRSVPAccepted">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_ACCEPTED" value1="${resourceName}" />
	</command>

	<command name="viewRSVPDeclined">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_DECLINED" value1="${resourceName}" />
	</command>

	<command name="viewRSVPMaybe">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_MAYBE" value1="${resourceName}" />
	</command>

	<command name="viewRSVPPending">
		<var name="key_resource" value="${resourceName}" />

		<execute function="AssertTextEquals" locator1="PGCalendarAddevent#INVITATIONS_PENDING" value1="${resourceName}" />
	</command>

	<command name="viewSpecificEventNotPresent">
		<var name="key_eventTitle" value="${eventTitle}" />

		<execute function="AssertElementNotPresent" locator1="PGCalendar#SCHEDULER_EVENT_SPECIFIC" />
		<execute function="AssertTextNotPresent" value1="${eventTitle}" />
	</command>

	<command name="viewTitleViaDetailsCmd">
		<execute function="AssertClick" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_VIEW_DETAILS_BUTTON" value1="View Details" />

		<execute function="SelectFrame" locator1="PGCalendarVieweventdetails#VIEW_EVENT_IFRAME" />

		<execute function="AssertTextEquals" locator1="PGCalendarVieweventdetails#EVENT_TITLE" value1="${eventTitle}" />
	</command>

	<command name="viewTitleViaSchedulerDialogBoxCmd">
		<if>
			<condition function="IsVisible" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" />
			<then>
				<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE" value1="${eventTitle}" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_EVENT_TITLE_GUEST" value1="${eventTitle}" />
			</else>
		</if>
	</command>

	<command name="viewUnavailableCalendarsNotPresent">
		<execute macro="CalendarEvent#expandDetailsPanelCmd" />

		<for list="${unavailableCalendarList}" param="unavailableCalendarName">
			<var name="key_calendarName" value="${unavailableCalendarName}" />

			<execute function="AssertElementNotPresent" locator1="PGCalendarAddevent#DETAILS_CALENDAR_SELECT_OPTION" />
		</for>
	</command>

	<command name="viewUsers">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<execute macro="CalendarEvent#selectViaSchedulerCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewTitleViaSchedulerDialogBoxCmd">
			<var name="eventTitle" value="${eventTitle}" />
		</execute>

		<execute macro="CalendarEvent#viewUsersViaSchedulerDialogBoxCmd">
			<var name="usersList" value="${usersList}" />
		</execute>
	</command>

	<command name="viewUsersViaSchedulerDialogBoxCmd">
		<execute function="AssertTextEquals" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_USERS_LABEL" value1="Users:" />

		<for list="${usersList}" param="user">
			<execute function="AssertTextEquals#assertPartialText" locator1="PGCalendar#SCHEDULER_EVENT_DIALOG_BOX_USERS_FIELD" value1="${user}" />
		</for>
	</command>

	<command name="viewWeekPG">
		<execute macro="CalendarEvent#changeViewPG">
			<var name="viewType" value="Week" />
		</execute>

		<var name="i" value="1" />
		<var name="key_eventTitle" value="${eventTitle}" />

		<while>
			<condition function="IsElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
			<then>
				<execute function="AssertElementPresent" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" />
				<execute function="AssertTextEquals" locator1="xpath=(//div[contains(@class,'calendar-portlet-event')]/div[contains(.,'${key_eventTitle}')])[${i}]" value1="${eventTitle}" />
				<var method="MathUtil#sum('${i}', '1')" name="i" />
			</then>
		</while>
	</command>
</definition>