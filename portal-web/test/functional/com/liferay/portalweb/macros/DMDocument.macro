<definition>
	<command name="addCommentPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="PGDocumentsandmediaDocument#COMMENTS_BE_THE_FIRST" value1="Be the first." />
		<execute function="Type" locator1="Comments#COMMENT_FIELD" value1="${commentBody}" />

		<if>
			<condition function="IsElementPresent" locator1="PGDocumentsandmediaDocument#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
			<then>
				<execute function="AssertClick" locator1="PGDocumentsandmediaDocument#COMMENTS_SUBMIT_BUTTON" value1="Submit" />
			</then>
			<else>
				<execute function="AssertClick" locator1="Button#REPLY" value1="Reply" />
			</else>
		</if>

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request processed successfully." />
	</command>

	<command name="addCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="NavBar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />

		<if>
			<equals arg1="${uploadTempFile}" arg2="true" />
			<then>
				<execute function="UploadTempFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
			</then>
			<elseif>
				<equals arg1="${nullFile}" arg2="true" />
				<then>
					<execute function="AssertElementPresent" locator1="TextInput#FILE" />
				</then>
			</elseif>
			<else>
				<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
			</else>
		</if>

		<if>
			<isset var="tagNameList" />
			<then>
				<execute macro="DMDocument#showCategorization" />

				<for list="${tagNameList}" param="tagName">
					<execute function="AssertClick" locator1="AssetCategorization#TAGS_ADD_BUTTON" value1="Add" />
					<execute function="Type" locator1="AssetCategorization#TAGS_FIELD" value1="${tagName}" />
				</for>

				<execute function="AssertClick" locator1="AssetCategorization#TAGS_ADD_BUTTON" value1="Add" />
			</then>
		</if>

		<if>
			<isset var="vocabularyName" />
			<then>
				<execute macro="DMDocument#showCategorization" />

				<var name="key_vocabularyName" value="${vocabularyName}" />

				<execute function="Click" locator1="AssetCategorization#VOCABULARY_SELECT" value1="${vocabularyName}" />

				<for list="${categoryNameList}" param="categoryName">
					<var name="key_categoryName" value="${categoryName}" />
					<execute function="AssertElementPresent" locator1="AssetCategorization#CATEGORIES_CATEGORY_CHECKBOX" value1="${categoryName}" />
					<execute function="Type" locator1="AssetCategorization#CATEGORIES_SEARCH_FIELD" value1="${categoryName}" />
					<execute function="Check" locator1="AssetCategorization#CATEGORIES_CATEGORY_SEARCH_RESULT_CHECKBOX" />
					<execute function="Type" locator1="AssetCategorization#CATEGORIES_SEARCH_FIELD" value1="" />
				</for>

				<execute function="Click" locator1="AssetCategorization#CATEGORIES_CLOSE_BUTTON" />
			</then>
		</if>

		<execute function="Type" locator1="TextInput#TITLE" value1="${dmDocumentTitle}" />

		<if>
			<isset var="dmDocumentDescription" />
			<then>
				<execute function="Type" locator1="TextArea#DESCRIPTION" value1="${dmDocumentDescription}" />
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addDMMarketingBannerCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="NavBar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#MARKETING_BANNER" value1="Marketing Banner" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="TextInput#TITLE" value1="${dmDocumentTitle}" />
		<execute function="Type" locator1="TextArea#DESCRIPTION" value1="${dmDocumentDescription}" />
		<execute function="Select" locator1="DocumentsAndMediaEditMarketingBanner#MARKETING_SELECT" value1="${marketingSelect}" />
		<execute function="Select" locator1="DocumentsAndMediaEditMarketingBanner#CAMPAIGN_THEME_SELECT" value1="${campaignTheme}" />
		<execute function="Select" locator1="DocumentsAndMediaEditMarketingBanner#BUSINESS_GOAL_SELECT" value1="${businessGoal}" />
		<execute function="Click" locator1="CPDocumentsandmediaAddMarketingbanner#NEEDS_LEGAL_REVIEW_${legalReview}_RADIO" />
		<execute function="Type" locator1="DocumentsAndMediaEditMarketingBanner#BANNER_NAME_FIELD" value1="${bannerName}" />
		<execute function="Type" locator1="DocumentsAndMediaEditMarketingBanner#BANNER_DESCRIPTION_FIELD" value1="${bannerDescription}" />

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="addDocumentTypeCmdCP">
		<var name="key_dmDocumentTypeName" value="${dmDocumentTypeName}" />

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="NavBar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#DOCUMENT_TYPE" value1="${dmDocumentTypeName}" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="TextInput#TITLE" value1="${dmDocumentTitle}" />
		<execute function="Type" locator1="TextArea#DESCRIPTION" value1="${dmDocumentDescription}" />

		<if>
			<isset var="selectOption" />
			<then>
				<execute function="Select" locator1="DocumentsAndMediaEditCustomDocumentType#SELECT_OPTIONS_SELECT" value1="${selectOption}" />
			</then>
		</if>

		<if>
			<isset var="textField" />
			<then>
				<var name="key_fieldName" value="Text" />

				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#TEXT_FIELD" value1="${textField}" />
			</then>
		</if>

		<if>
			<isset var="numberField" />
			<then>
				<var name="key_fieldName" value="Number" />

				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#NUMBER_FIELD" value1="${numberField}" />
			</then>
		</if>

		<if>
			<isset var="booleanField" />
			<then>
				<var name="key_fieldName" value="Boolean" />

				<execute function="Check" locator1="DocumentsAndMediaEditCustomDocumentType#BOOLEAN_CHECKBOX" value1="${booleanField}" />
			</then>
		</if>
	</command>

	<command name="addDocumentTypeCP">
		<execute macro="DMDocument#addDocumentTypeCmdCP">
			<var name="booleanField" value="${booleanField}" />
			<var name="dmDocumentDescription" value="${dmDocumentDescription}" />
			<var name="dmDocumentFile" value="${dmDocumentFile}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTypeName" value="${dmDocumentTypeName}" />
			<var name="numberField" value="${numberField}" />
			<var name="selectOption" value="${selectOption}" />
			<var name="textField" value="${textField}" />
		</execute>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addDocumentTypePG">
		<var name="key_dmDocumentTypeName" value="${dmDocumentTypeName}" />

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#DOCUMENT_TYPE" value1="${dmDocumentTypeName}" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTitle}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#DESCRIPTION_FIELD" value1="${dmDocumentDescription}" />

		<if>
			<isset var="selectOption" />
			<then>
				<execute function="Select" locator1="DocumentsAndMediaEditCustomDocumentType#SELECT_OPTIONS_SELECT" value1="${selectOption}" />
			</then>
		</if>

		<if>
			<isset var="textField" />
			<then>
				<var name="key_fieldName" value="Text" />

				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#TEXT_FIELD" value1="${textField}" />
			</then>
		</if>

		<if>
			<isset var="numberField" />
			<then>
				<var name="key_fieldName" value="Number" />

				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#NUMBER_FIELD" value1="${numberField}" />
			</then>
		</if>

		<if>
			<isset var="booleanField" />
			<then>
				<var name="key_fieldName" value="Boolean" />

				<execute function="Check" locator1="DocumentsAndMediaEditCustomDocumentType#BOOLEAN_CHECKBOX" value1="${booleanField}" />
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addDocumentTypeWithWorkflowCP">
		<execute macro="DMDocument#addDocumentTypeCmdCP">
			<var name="booleanField" value="${booleanField}" />
			<var name="dmDocumentDescription" value="${dmDocumentDescription}" />
			<var name="dmDocumentFile" value="${dmDocumentFile}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTypeName" value="${dmDocumentTypeName}" />
			<var name="numberField" value="${numberField}" />
			<var name="selectOption" value="${selectOption}" />
			<var name="textField" value="${textField}" />
		</execute>

		<execute function="AssertClick" locator1="Button#SUBMIT_FOR_PUBLICATION" value1="Submit for Publication" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addMultiplePG">
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#MULTIPLE_DOCUMENTS" value1="Multiple Documents" />

		<if>
			<isset var="dmDocumentFileList" />
			<then>
				<for list="${dmDocumentFileList}" param="dmDocumentFile">
					<var name="key_dmDocumentFile" value="${dmDocumentFile}" />

					<execute function="AssertClick" locator1="DynamicUploader#SELECT_FILES_BUTTON" value1="Select Files" />

					<if>
						<equals arg1="${uploadTempFile}" arg2="true" />
						<then>
							<execute function="SikuliUploadTempFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
						</then>
						<else>
							<execute function="SikuliUploadCommonFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
						</else>
					</if>

					<execute function="AssertChecked" locator1="DynamicUploader#SELECT_ALL_CHECKBOX" />
					<execute function="AssertElementPresent" locator1="DynamicUploader#ALL_FILES_READY_TO_BE_SAVED_DOCUMENT_TITLE" value1="${dmDocumentFile}" />
				</for>
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
		<execute function="AssertTextEquals#assertPartialText" locator1="DynamicUploader#ALL_FILES_READY_TO_BE_SAVED_DOCUMENT_SUCCESS_MESSAGE" value1="Successfully saved." />
	</command>

	<command name="addPG">
		<if>
			<equals arg1="${stagingActivated}" arg2="true" />
			<then>
				<execute function="AssertElementNotPresent" locator1="Message#WORKFLOW_UNAPPROVED" value1="The data of this portlet is not staged. Any data changes are immediately available to the Local Live site. The portlet's own workflow is still honored. Portlet setup is still managed from staging." />
			</then>
		</if>

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />

		<if>
			<isset var="dmDocumentTypeName" />
			<then>
				<var name="key_dmDocumentTypeName" value="${dmDocumentTypeName}" />

				<execute function="AssertClick" locator1="MenuItem#DOCUMENT_TYPE" value1="${dmDocumentTypeName}" />
			</then>
			<else>
				<execute function="AssertClick" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />
			</else>
		</if>

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTitle}" />

		<if>
			<isset var="dmDocumentDescription" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditDocument#DESCRIPTION_FIELD" value1="${dmDocumentDescription}" />
			</then>
		</if>

		<if>
			<isset var="categoryName" />
			<then>
				<var name="key_categoryName" value="${categoryName}" />

				<execute macro="PGDocumentsandmediaEditdocument#showCategorization" />
				<execute function="AssertClick" locator1="Button#SELECT" value1="Select" />

				<execute function="AssertClick" locator1="AssetCategorization#CATEGORIES_CATEGORY" value1="${categoryName}" />
				<execute function="AssertClick" locator1="Button#CLOSE_IFRAME" value1="×" />

				<execute function="AssertTextEquals" locator1="AssetCategorization#CATEGORY" value1="${categoryName}" />
			</then>
		</if>

		<if>
			<isset var="dmDocumentRelatedAsset" />
			<then>
				<execute macro="DMDocument#addRelatedAssetPG">
					<var name="assetTitle" value="${assetTitle}" />
					<var name="assetType" value="${assetType}" />
				</execute>
			</then>
		</if>

		<if>
			<isset var="tagNameList" />
			<then>
				<for list="${tagNameList}" param="tagName">
					<execute macro="DMDocument#showCategorization" />

					<execute function="Type" locator1="AssetCategorization#TAGS_FIELD" value1="${tagName}" />
					<execute function="AssertClick" locator1="AssetCategorization#TAGS_ADD_BUTTON" value1="Add" />
				</for>
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<if>
			<equals arg1="${dmDocument}" arg2="Duplicate" />
			<then>
				<execute function="AssertTextEquals" locator1="Message#ERROR" value1="Your request failed to complete." />
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaEditDocument#UNIQUE_DOCUMENT_ERROR_MESSAGE" value1="Please enter a unique document name." />
			</then>
			<elseif>
				<equals arg1="${dmDocument}" arg2="Invalid" />
				<then>
					<execute function="AssertTextEquals" locator1="Message#ERROR_1" value1="Your request failed to complete." />
					<execute function="AssertTextEquals" locator1="Message#ERROR_2" value1="Please enter a file with a valid file name." />
				</then>
			</elseif>
			<else>
				<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
			</else>
		</if>
	</command>

	<command name="addPGViaAP">
		<execute function="AssertClick" locator1="AP#ADD_NEW_DROPDOWN" value1="Add New" />
		<execute function="AssertClick" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />
		<execute function="SelectFrame" locator1="IFrame#EDIT_ASSET" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTitle}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#DESCRIPTION_FIELD" value1="${dmDocumentDescription}" />
		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="SelectFrame" locator1="relative=top" />
	</command>

	<command name="addPGViaFlashUploader">
		<if>
			<equals arg1="${stagingActivated}" arg2="true" />
			<then>
				<execute function="AssertElementNotPresent" locator1="Message#WORKFLOW_UNAPPROVED" value1="The data of this portlet is not staged. Any data changes are immediately available to the Local Live site. The portlet's own workflow is still honored. Portlet setup is still managed from staging." />
			</then>
		</if>

		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#MULTIPLE_DOCUMENTS" value1="Multiple Documents" />

		<if>
			<isset var="dmDocumentFileList" />
			<then>
				<for list="${dmDocumentFileList}" param="dmDocumentFile">
					<var name="key_dmDocumentFile" value="${dmDocumentFile}" />

					<execute function="AssertClick" locator1="DynamicUploader#SELECT_FILES_BUTTON" value1="Select Files" />

					<execute function="SikuliClick" locator1="OS#FILE_DIALOG_BOX_TYPE_FILE_NAME_ICON_PNG" />

					<if>
						<equals arg1="${uploadTempFile}" arg2="true" />
						<then>
							<execute function="SikuliUploadTempFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
						</then>
						<else>
							<execute function="SikuliUploadCommonFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
						</else>
					</if>

					<execute function="AssertChecked" locator1="DynamicUploader#SELECT_ALL_CHECKBOX" />
					<execute function="AssertTextEquals" locator1="DynamicUploader#ALL_FILES_READY_TO_BE_SAVED_DOCUMENT_TITLE" value1="${dmDocumentFile}" />
				</for>
			</then>
			<else>
				<var name="key_dmDocumentFile" value="${dmDocumentFile}" />

				<execute function="AssertClick" locator1="DynamicUploader#SELECT_FILES_BUTTON" value1="Select Files" />

				<if>
					<equals arg1="${uploadTempFile}" arg2="true" />
					<then>
						<execute function="SikuliUploadTempFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
					</then>
					<else>
						<execute function="SikuliUploadCommonFile" locator1="OS#FILE_DIALOG_BOX_FILE_NAME_FIELD_PNG" value1="${dmDocumentFile}" />
					</else>
				</if>

				<execute function="AssertChecked" locator1="DynamicUploader#SELECT_ALL_CHECKBOX" />
				<execute function="AssertTextEquals" locator1="DynamicUploader#ALL_FILES_READY_TO_BE_SAVED_DOCUMENT_TITLE" value1="${dmDocumentFile}" />
			</else>
		</if>

		<execute function="AssertClick" locator1="Button#SAVE" value1="Save" />
		<execute function="AssertTextEquals#assertPartialText" locator1="DynamicUploader#ALL_FILES_READY_TO_BE_SAVED_DOCUMENT_SUCCESS_MESSAGE" value1="Successfully saved." />
	</command>

	<command name="addPGViaMG">
		<execute function="AssertClick" locator1="PGMediagalleryFolder#FOLDER_MENU_ADD_MEDIA" value1="Add Media" />

		<execute function="SelectFrame" locator1="IFrame#SELECT_MEDIA_TYPE" />
		<execute function="AssertClick" locator1="MediaGallery#MEDIA_TABLE_BASIC_DOCUMENT" value1="Basic Document" />
		<execute function="SelectFrameTop" value1="relative=top" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${mgDocumentFile}" />
		<execute function="Type" locator1="TextInput#TITLE" value1="${mgDocumentTitle}" />
		<execute function="Type" locator1="TextArea#DESCRIPTION" value1="${mgDocumentDescription}" />
		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addRelatedAssetPG">
		<if>
			<condition function="IsElementNotPresent" locator1="PGDocumentsandmediaAdddocument#RELATED_ASSETS_SELECT" />
			<then>
				<execute function="Click" locator1="AssetRelatedAssets#HEADER_COLLAPSED" />
				<execute function="AssertElementPresent" locator1="AssetRelatedAssets#HEADER_EXPANDED" />
			</then>
		</if>

		<var name="key_assetType" value="${assetType}" />

		<execute function="AssertClick" locator1="PGDocumentsandmediaAdddocument#RELATED_ASSETS_SELECT" value1="Select" />
		<execute function="AssertClick" locator1="PGDocumentsandmediaAdddocument#RELATED_ASSETS_MENULIST_SELECTION" value1="${assetType}" />

		<var name="key_assetTitle" value="${assetTitle}" />

		<execute function="SelectFrame" locator1="IFrame#DIALOG" />
		<execute function="AssertClick" locator1="AssetRelatedAssets#ASSET_TABLE_CHOOSE" value1="Choose" />
		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="addShortcutPG">
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#SHORTCUT" value1="Shortcut" />

		<execute function="AssertClick" locator1="SitesSelectSite#SITES_TABLE_CHOOSE_BUTTON" value1="Select" />

		<execute function="SelectFrame" locator1="SitesSelectSite#SELECT_SITE_IFRAME" />

		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var name="key_siteName" value="${siteName}" />

		<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${siteName}" />
		<execute function="Click" locator1="Icon#ADVANCED_SEARCH" />
		<execute function="AssertTextEquals" locator1="SitesSelectSite#SITES_TABLE_NAME" value1="${siteName}" />
		<execute function="AssertClick" locator1="SitesSelectSite#SITES_TABLE_CHOOSE_BUTTON" value1="Choose" />
		<execute function="SelectFrameTop" value1="relative=top" />
		<execute function="AssertClick" locator1="DocumentsAndMediaSelectDocument#DOCUMENTS_TABLE_CHOOSE" value1="Select" />
		<execute function="SelectFrame" locator1="IFrame#SELECT_FILE" />

		<if>
			<isset var="dmFolderName" />
			<then>
				<var name="key_dmFolderName" value="${dmFolderName}" />

				<execute function="AssertClick" locator1="DocumentsAndMediaSelectDocument#FOLDER_TABLE_FOLDER" value1="${dmFolderName}" />
			</then>
		</if>

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaSelectDocument#DOCUMENTS_TABLE_DOCUMENT" value1="${dmDocumentTitle} ${dmDocumentDescription}" />
		<execute function="AssertClick" locator1="DocumentsAndMediaSelectDocument#DOCUMENTS_TABLE_CHOOSE" value1="Choose" />
		<execute function="SelectFrameTop" value1="relative=top" />
		<execute function="AssertClick" locator1="Button#SAVE" value1="Save" />

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="addWithWorkflowCP">
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="NavBar#ADD" value1="Add" />
		<execute function="AssertClick" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="TextInput#TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertClick" locator1="Button#SUBMIT_FOR_PUBLICATION" value1="Submit for Publication" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />

		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="cancelCheckoutPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="Message#CHECKOUT_SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />

		<execute function="AssertClick#assertTextClick" locator1="Button#CANCEL_CHECKOUT" value1="Cancel Checkout" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="cannotViewCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementNotPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
	</command>

	<command name="cannotViewDocumentMetadataCP">
		<var name="key_metadataData" value="${metadataData}" />
		<var name="key_metadataLabel" value="${metadataLabel}" />

		<execute function="AssertElementNotPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_EXTRACTED_METADATA_FIELD" />
	</command>

	<command name="checkDocumentCheckboxCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Check" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
	</command>

	<command name="checkinCP">
		<if>
			<equals arg1="${sharepointRepository}" arg2="true" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#SUCCESS_MESSAGE_DOCUMENT_VIEW" value1="You now have an indefinite lock on this document. No one else can edit this document until you unlock it. This lock will never expire." />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#SUCCESS_MESSAGE_DOCUMENT_VIEW" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
			</else>
		</if>

		<execute function="AssertClick" locator1="DocumentsAndMediaDocument#TOOLBAR_CHECKIN_BUTTON" value1="Checkin" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="checkinPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="Message#CHECKOUT_SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
		<execute function="AssertClick#assertTextClick" locator1="Button#CHECKIN" value1="Checkin" />

		<if>
			<condition function="IsElementPresent" locator1="PGDocumentsandmediaCheckin#MAJOR_REVISION" />
			<then>
				<if>
					<equals arg1="${revision}" arg2="Major" />
					<then>
						<execute function="Click" locator1="PGDocumentsandmediaCheckin#MAJOR_REVISION" />
					</then>
					<elseif>
						<equals arg1="${revision}" arg2="Minor" />
						<then>
							<execute function="Click" locator1="PGDocumentsandmediaCheckin#MINOR_REVISION" />
						</then>
					</elseif>
				</if>

				<if>
					<isset var="changeLog" />
					<then>
						<execute function="Type" locator1="PGDocumentsandmediaCheckin#CHANGE_LOG" value1="${changeLog}" />
					</then>
				</if>

				<execute function="AssertClick" locator1="Button#SAVE_AND_CHECKIN" value1="Save and Check In" />
			</then>
		</if>

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="checkinViaDocumentActionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#CHECKIN" value1="Checkin" />

		<if>
			<condition function="IsElementPresent" locator1="PGDocumentsandmediaCheckin#MAJOR_REVISION" />
			<then>
				<if>
					<equals arg1="${revision}" arg2="Major" />
					<then>
						<execute function="Click" locator1="PGDocumentsandmediaCheckin#MAJOR_REVISION" />
					</then>
					<elseif>
						<equals arg1="${revision}" arg2="Minor" />
						<then>
							<execute function="Click" locator1="PGDocumentsandmediaCheckin#MINOR_REVISION" />
						</then>
					</elseif>
				</if>

				<if>
					<isset var="changeLog" />
					<then>
						<execute function="Type" locator1="PGDocumentsandmediaCheckin#CHANGE_LOG" value1="${changeLog}" />
					</then>
				</if>

				<execute function="AssertClick" locator1="Button#SAVE_AND_CHECKIN" value1="Save and Checkin" />
			</then>
		</if>

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="checkoutCP">
		<execute function="AssertClick" locator1="DocumentsAndMediaDocument#TOOLBAR_CHECKOUT_BUTTON" value1="Checkout" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />

		<if>
			<equals arg1="${sharepointRepository}" arg2="true" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#SUCCESS_MESSAGE_DOCUMENT_VIEW" value1="You now have an indefinite lock on this document. No one else can edit this document until you unlock it. This lock will never expire." />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#SUCCESS_MESSAGE_DOCUMENT_VIEW" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
			</else>
		</if>
	</command>

	<command name="checkoutPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertClick#assertTextClick" locator1="Button#CHECKOUT" value1="Checkout" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="AssertTextEquals" locator1="Message#CHECKOUT_SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
	</command>

	<command name="checkoutViaDocumentActionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#CHECKOUT" value1="Checkout" />
		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="copyURL">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="deleteCommentPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="MakeVisible" locator1="PGDocumentsandmediaDocument#COMMENTS_DELETE" value1="Delete" />
		<execute function="AssertClickNoError" locator1="Comments#DELETE_LINK" value1="Delete" />
		<execute function="Confirm" value1="Are you sure you want to delete the selected comment?" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request processed successfully." />
	</command>

	<command name="deleteCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />

		<if>
			<isset var="recycleBinDisabled" />
			<then>
				<execute function="AssertClick" locator1="MenuItem#DELETE" value1="Delete" />
				<execute function="Confirm" value1="Are you sure you want to delete this? It will be deleted immediately." />
				<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
			</then>
			<else>
				<execute function="AssertClick" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
				<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="moved to the Recycle Bin. Undo" />
			</else>
		</if>
	</command>

	<command name="deletePG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentTitleCmdPG">
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
		</execute>

		<execute function="AssertClick#assertTextClick" locator1="Button#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="moved to the Recycle Bin. Undo" />
	</command>

	<command name="deletePGViaMG">
		<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

		<execute function="AssertClick" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />
		<execute function="Click" locator1="MediaGallery#ENTRY_RECYCLE_BIN_ICON" />
		<execute function="AssertTextEquals#assertPartialText" locator1="Message#RECYCLE_BIN_SUCCESS" value1="moved to the Recycle Bin. Undo" />
		<execute function="AssertElementNotPresent" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />
	</command>

	<command name="deleteViaActionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="Check" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="Click" locator1="Toolbar#ACTIONS" value1="Actions" />
		<execute function="AssertClick" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="moved to the Recycle Bin. Undo" />
	</command>

	<command name="downloadCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="MouseOver" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />

		<execute function="AssertClick" locator1="MenuItem#DOWNLOAD" value1="Download (${dmDocumentSize})" />
	</command>

	<command name="downloadPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertClick#assertTextClick" locator1="Button#DOWNLOAD" value1="Download" />
	</command>

	<command name="editCmdCP">
		<if>
			<not>
				<contains string="${checkedOut}" substring="{checkedOut}" />
			</not>
			<then>
				<if>
					<equals arg1="${sharepointRepository}" arg2="true" />
					<then>
						<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have an indefinite lock on this document. No one else can edit this document until you unlock it. This lock will never expire." />
					</then>
					<else>
						<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
					</else>
				</if>
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentFileEdit}" substring="{dmDocumentFileEdit}" />
			</not>
			<then>
				<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFileEdit}" />
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentTitleEdit}" substring="{dmDocumentTitleEdit}" />
			</not>
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTitleEdit}" />
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentDescriptionEdit}" substring="{dmDocumentDescriptionEdit}" />
			</not>
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditDocument#DESCRIPTION_FIELD" value1="${dmDocumentDescriptionEdit}" />
			</then>
		</if>
	</command>

	<command name="editCmdPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<if>
			<equals arg1="${checkedOut}" arg2="true" />
			<then>
				<execute function="AssertTextEquals#assertPartialText" locator1="Message#ERROR_2" value1="You cannot modify this document because it was locked by ${userName}" />
			</then>
			<else>
				<execute function="AssertClick#assertTextClick" locator1="Button#EDIT" value1="Edit" />
			</else>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentFileEdit}" substring="{dmDocumentFileEdit}" />
			</not>
			<then>
				<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFileEdit}" />
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentTitleEdit}" substring="{dmDocumentTitleEdit}" />
			</not>
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaEditdocument#TITLE_FIELD" value1="${dmDocumentTitleEdit}"  />
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentDescriptionEdit}" substring="{dmDocumentDescriptionEdit}" />
			</not>
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaEditdocument#DESCRIPTION_FIELD" value1="${dmDocumentDescriptionEdit}" />
			</then>
		</if>

		<if>
			<not>
				<contains string="${dmDocumentTagName}" substring="{dmDocumentTagName}" />
			</not>
			<then>
				<execute macro="DMDocument#showCategorization" />

				<execute function="Type" locator1="AssetCategorization#TAGS_FIELD" value1="${dmDocumentTagName}" />
			</then>
		</if>

		<if>
			<not>
				<contains string="${revision}" substring="{revision}" />
			</not>
			<then>
				<if>
					<equals arg1="${revision}" arg2="Major" />
					<then>
						<execute function="Click" locator1="PGDocumentsandmediaEditdocument#MAJOR_REVISION_BUTTON" />
					</then>
					<else>
						<execute function="Click" locator1="PGDocumentsandmediaEditdocument#MINOR_REVISION_BUTTON" />
					</else>
				</if>
			</then>
		</if>

		<if>
			<isset var="changeLog" />
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaCheckin#CHANGE_LOG" value1="${changeLog}" />
			</then>
		</if>
	</command>

	<command name="editCommentPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="MakeVisible" locator1="PGDocumentsandmediaDocument#COMMENTS_EDIT" value1="Edit" />
		<execute function="AssertClick" locator1="Comments#EDIT_LINK" value1="Edit" />
		<execute function="Type" locator1="PGDocumentsandmediaDocument#COMMENTS_COMMENT_EDIT_FIELD" value1="${commentBodyEdit}" />
		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request processed successfully." />
	</command>

	<command name="editCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="MouseOver" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#EDIT" value1="Edit" />

		<execute macro="DMDocument#editCmdCP">
			<var name="checkedOut" value="${checkedOut}" />
			<var name="dmDocumentDescriptionEdit" value="${dmDocumentDescriptionEdit}" />
			<var name="dmDocumentFileEdit" value="${dmDocumentFileEdit}" />
			<var name="dmDocumentTitleEdit" value="${dmDocumentTitleEdit}" />
			<var name="sharepointRepository" value="${sharepointRepository}" />
		</execute>

		<if>
			<equals arg1="${checkedOut}" arg2="true" />
			<then>
				<execute function="AssertClick" locator1="Button#SAVE" value1="Save" />
			</then>
			<else>
				<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="editPG">
		<execute macro="DMDocument#editCmdPG">
			<var name="changeLog" value="${changeLog}" />
			<var name="checkedOut" value="${checkedOut}" />
			<var name="dmDocumentDescriptionEdit" value="${dmDocumentDescriptionEdit}" />
			<var name="dmDocumentFileEdit" value="${dmDocumentFileEdit}" />
			<var name="dmDocumentTagName" value="${dmDocumentTagName}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTitleEdit" value="${dmDocumentTitleEdit}" />
			<var name="revision" value="${revision}" />
			<var name="userName" value="${userName}" />
		</execute>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="editPGViaAP">
		<var name="key_assetTitle" value="${assetTitle}" />

		<execute function="Click" locator1="AP#ASSET_ABSTRACT_EDIT" />

		<execute function="SelectFrame" locator1="IFrame#EDIT_ASSET" />

		<if>
			<not>
				<contains string="${dmDocumentTitleEdit}" substring="{dmDocumentTitleEdit}" />
			</not>
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaEditdocument#TITLE_FIELD" value1="${dmDocumentTitleEdit}"  />
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="SelectFrame" locator1="relative=top" />
	</command>

	<command name="editPGViaMG">
		<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

		<execute function="AssertClick" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="MediaGallery#MEDIA_CAPTION" value1="${mgDocumentTitle} - ${mgDocumentDescription}" />
		<execute function="Click" locator1="MediaGallery#ENTRY_EDIT_ICON" />

		<execute function="Type" locator1="TextInput#TITLE" value1="${mgDocumentTitleEdit}" />
		<execute function="Type" locator1="TextArea#DESCRIPTION" value1="${mgDocumentDescriptionEdit}" />
		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
		<execute function="AssertTextEquals" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitleEdit}" />
	</command>

	<command name="editPublishPG">
		<execute macro="DMDocument#editCmdPG">
			<var name="changeLog" value="${changeLog}" />
			<var name="checkedOut" value="${checkedOut}" />
			<var name="dmDocumentDescriptionEdit" value="${dmDocumentDescriptionEdit}" />
			<var name="dmDocumentFileEdit" value="${dmDocumentFileEdit}" />
			<var name="dmDocumentTagName" value="${dmDocumentTagName}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTitleEdit" value="${dmDocumentTitleEdit}" />
			<var name="revision" value="${revision}" />
			<var name="userName" value="${userName}" />
		</execute>

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />
		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="editSaveAndCheckinPG">
		<execute macro="DMDocument#editCmdPG">
			<var name="changeLog" value="${changeLog}" />
			<var name="checkedOut" value="${checkedOut}" />
			<var name="dmDocumentDescriptionEdit" value="${dmDocumentDescriptionEdit}" />
			<var name="dmDocumentFileEdit" value="${dmDocumentFileEdit}" />
			<var name="dmDocumentTagName" value="${dmDocumentTagName}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTitleEdit" value="${dmDocumentTitleEdit}" />
			<var name="revision" value="${revision}" />
			<var name="userName" value="${userName}" />
		</execute>

		<if>
			<isset var="changeLog" />
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaCheckin#CHANGE_LOG" value1="${changeLog}" />
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#SAVE_AND_CHECKIN" value1="Save and Check In" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="editSaveAsDraftPG">
		<execute macro="DMDocument#editCmdPG">
			<var name="changeLog" value="${changeLog}" />
			<var name="checkedOut" value="${checkedOut}" />
			<var name="dmDocumentDescriptionEdit" value="${dmDocumentDescriptionEdit}" />
			<var name="dmDocumentFileEdit" value="${dmDocumentFileEdit}" />
			<var name="dmDocumentTagName" value="${dmDocumentTagName}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="dmDocumentTitleEdit" value="${dmDocumentTitleEdit}" />
			<var name="revision" value="${revision}" />
			<var name="userName" value="${userName}" />
		</execute>

		<if>
			<isset var="changeLog" />
			<then>
				<execute function="Type" locator1="PGDocumentsandmediaCheckin#CHANGE_LOG" value1="${changeLog}" />
			</then>
		</if>

		<execute function="AssertClick" locator1="PGDocumentsandmediaEditdocument#SAVE_AS_DRAFT_BUTTON" value1="Save as Draft" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_WORKFLOW" value1="Status: Draft" />
	</command>

	<command name="gotoCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="gotoHomeCP">
		<execute function="AssertClick#assertTextClickAtAndWait" locator1="DocumentsAndMedia#BREADCRUMB_HOME" value1="Home" />
	</command>

	<command name="gotoPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="gotoRelatedAssetPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<var name="key_assetTitle" value="${key_assetTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RELATED_ASSETS_HEADER" value1="Related Assets:" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RELATED_ASSETS_TITLE" value1="${assetTitle}" />
		<execute function="AssertClick" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RELATED_ASSETS_TITLE" value1="${assetTitle}" />
	</command>

	<command name="linkImage">
		<execute function="Click#pauseClickAt" locator1="CKEditor#CONTENT_IMAGE_LINK" />
		<execute function="AssertClick#pauseAssertTextClickAt" locator1="CKEditor#CONTENT_IMAGE_LINK_BROWSE_SERVER_BUTTON" value1="Browse Server" />
		<execute function="SelectFrame" locator1="CKEditor#LINK_IMAGE_BROWSE_SERVER_IFRAME" />

		<if>
			<isset var="siteName" />
			<then>
				<execute function="Click" locator1="CKEditor#LINK_IMAGE_BROWSE_SERVER_SITE_BUTTON" />

				<var name="key_siteName" value="${siteName}" />

				<execute function="Click" locator1="CKEditor#LINK_IMAGE_BROWSE_SERVER_SITE_MENULIST_BUTTON" />
			</then>
		</if>

		<if>
			<isset var="key_folderName" />
			<then>
				<for list="${dmFolderNames}" param="folderName">
					<var name="key_folderName" value="${folderName}" />

					<execute function="Click" locator1="CKEditor#LINK_IMAGE_BROWSE_SERVER_FOLDER_NAME" />
				</for>
			</then>
		</if>

		<var name="key_documentName" value="${documentName}" />

		<execute function="AssertClick" locator1="CKEditor#LINK_IMAGE_BROWSE_SERVER_DOCUMENT_CHOOSE_BUTTON" value1="Choose" />
		<execute function="SelectFrame" value1="relative=top" />
		<execute function="AssertClick" locator1="CKEditor#CONTENT_IMAGE_LINK_OK_BUTTON" value1="OK" />
	</command>

	<command name="moveToFolderCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertElementPresent" locator1="MenuItem#MOVE" />
		<execute function="AssertClick" locator1="MenuItem#MOVE" value1="Move" />

		<execute function="AssertClick" locator1="Button#SELECT" value1="Select" />
		<execute function="SelectFrame" locator1="DocumentsAndMediaSelectFolder#SELECT_FOLDER_IFRAME" />

		<if>
			<equals arg1="${dmFolderName}" arg2="Home" />
			<then>
				<execute function="AssertClick" locator1="Button#CHOOSE_THIS_FOLDER" value1="Choose This Folder" />
			</then>
			<else>
				<execute function="AssertClick" locator1="CHOOSE_BUTTON_GENERIC" value1="Choose" />
			</else>
		</if>

		<execute function="SelectFrame" locator1="relative=top" />
		<execute function="AssertTextEquals" locator1="CPDocumentsandmediaMovefolder#NEW_FOLDER" value1="${dmFolderName}" />
		<execute function="AssertClick" locator1="Button#MOVE" value1="Move" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="moveToFolderPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#MOVE" value1="Move" />

		<execute function="AssertClick" locator1="Button#SELECT" value1="Select" />
		<execute function="SelectFrame" locator1="IFrame#SELECT_FOLDER" />

		<var name="key_dmFolderName" value="${dmFolderName}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaSelectFolder#FOLDER" value1="${dmFolderName}" />
		<execute function="AssertClick" locator1="DocumentsAndMediaSelectFolder#CHOOSE_BUTTON" value1="Choose" />
		<execute function="SelectFrameTop" />
		<execute function="AssertClick" locator1="Button#MOVE" value1="Move" />

		<if>
			<isset var="dmDuplicateDocument" />
			<then>
				<execute function="AssertTextEquals" locator1="Message#ERROR" value1="Your request failed to complete." />
				<execute function="AssertTextEquals" locator1="Message#ERROR_2" value1="The folder you selected already has an entry with this name. Please select a different folder." />
			</then>
			<else>
				<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
			</else>
		</if>
	</command>

	<command name="moveToHomePG">
		<var name="key_dmFolderName" value="${dmFolderName}" />

		<execute function="Check" locator1="PGDocumentsandmediaFolder#ENTRY_ICON_FOLDER_CHECKBOX" />
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="PGDocumentsandmediaFolder#TOOLBAR_ACTIONS" value1="Actions" />
		<execute function="AssertClick" locator1="PGDocumentsandmediaFolder#ACTIONS_MENULIST_MOVE" value1="Move" />

		<execute function="AssertClick" locator1="Button#SELECT" value1="Select" />
		<execute function="SelectFrame" locator1="IFrame#SELECT_FOLDER" />

		<if>
			<condition function="IsElementPresent" locator1="PGDocumentsandmediaMovefiles#SELECT_POP_UP_HOME" />
			<then>
				<execute function="AssertClick" locator1="PGDocumentsandmediaMovefiles#SELECT_POP_UP_HOME" value1="Home" />
			</then>
		</if>

		<execute function="AssertClick" locator1="Button#CHOOSE_THIS_FOLDER" value1="Choose This Folder" />
		<execute function="SelectFrameTop" />
		<execute function="AssertClick" locator1="Button#MOVE" value1="Move" />

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="moveToRecycleBinCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="MouseOver" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#TOOLBAR_ACTIONS" />
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="DocumentsAndMedia#TOOLBAR_ACTIONS" value1="Actions" />
		<execute function="AssertClick" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS_RECYCLE_BIN" value1="The ${assetType} ${dmDocumentTitle} was moved to the Recycle Bin. Undo" />

		<if>
			<condition function="IsElementNotPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_GENERIC" />
			<then>
				<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />
			</then>
		</if>
	</command>

	<command name="moveToSubFolderCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />

		<execute function="AssertElementPresent" locator1="MenuItem#MOVE" />

		<execute function="AssertClick" locator1="MenuItem#MOVE" value1="Move" />

		<execute function="AssertClick" locator1="Button#SELECT" value1="Select" />

		<execute function="SelectFrame" locator1="DocumentsAndMediaSelectFolder#SELECT_FOLDER_IFRAME" />

		<execute function="AssertClick" locator1="DocumentsAndMediaSelectFolder#FOLDER_GENERIC" value1="${dmFolderName}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaSelectFolder#FOLDER_GENERIC" value1="${dmSubFolderName}" />

		<execute function="AssertClick" locator1="CHOOSE_BUTTON_GENERIC" value1="Choose" />

		<execute function="SelectFrame" locator1="relative=top" />

		<execute function="AssertTextEquals" locator1="CPDocumentsandmediaMovefolder#NEW_FOLDER" value1="${dmSubFolderName}" />

		<execute function="AssertClick" locator1="Button#MOVE" value1="Move" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="navigateBackViaDocumentViewPG">
		<execute function="AssertClick" locator1="NavListItem#UP" value1="Up" />
	</command>

	<command name="populateField">
		<var name="key_fieldName" value="${fieldName}" />

		<if>
			<not>
				<equals arg1="${fieldShowLabel}" arg2="No" />
			</not>
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaEditCustomDocumentType#FIELD_LABEL" value1="${fieldFieldLabel}" />
			</then>
			<else>
				<execute function="AssertElementNotPresent" locator1="DocumentsAndMediaEditCustomDocumentType#FIELD_LABEL" />
			</else>
		</if>

		<if>
			<equals arg1="${field}" arg2="Boolean" />
			<then>
				<if>
					<equals arg1="${dmDocumentTypeFieldData}" arg2="false" />
					<then>
						<execute function="Uncheck" locator1="DocumentsAndMediaEditCustomDocumentType#BOOLEAN_CHECKBOX" />
					</then>
					<elseif>
						<equals arg1="${dmDocumentTypeFieldData}" arg2="true" />
						<then>
							<execute function="Check" locator1="DocumentsAndMediaEditCustomDocumentType#BOOLEAN_CHECKBOX" />
						</then>
					</elseif>
					<else>
						<fail message="Invalid var recordFieldData. Must be (true|false)." />
					</else>
				</if>
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Date" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#DATE_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Decimal" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#DECIMAL_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Documents and Media" />
			<then>
				<execute function="AssertClick" locator1="DocumentsAndMediaEditCustomDocumentType#DOCUMENTS_AND_MEDIA_SELECT" value1="Select" />

				<execute function="SelectFrame" locator1="DocumentsAndMediaSelectDocument#SELECT_DOCUMENT_IFRAME" />
				<execute function="AssertClick" locator1="Toolbar#ADD" value1="Add" />
				<execute function="AssertClick" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />

				<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${document}" />
				<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTypeFieldData}" />
				<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

				<var name="key_documentTitle" value="${dmDocumentTypeFieldData}" />

				<execute function="AssertTextEquals" locator1="DocumentsAndMediaSelectDocument#DOCUMENTS_TABLE_DOCUMENT" value1="${dmDocumentTypeFieldData}" />
				<execute function="Click" locator1="DocumentsAndMediaSelectDocument#DOCUMENTS_TABLE_CHOOSE" />

				<execute function="SelectFrame" value1="relative=top" />
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaEditCustomDocumentType#DOCUMENTS_AND_MEDIA_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="HTML" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#HTML_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Integer" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#INTEGER_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Link to Page" />
			<then>
				<var name="key_ddlRecordFieldData" value="${dmDocumentTypeFieldData}" />

				<execute function="Click" locator1="DocumentsAndMediaEditCustomDocumentType#LINK_TO_PAGE_SELECT" />
				<execute function="DoubleClick" locator1="DocumentsAndMediaEditCustomDocumentType#LINK_TO_PAGE_SELECT_OPTION" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Number" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#NUMBER_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Radio" />
			<then>
				<var name="key_ddlRecordFieldData" value="${dmDocumentTypeFieldData}" />

				<execute function="AssertTextEquals" locator1="DocumentsAndMediaEditCustomDocumentType#RADIO_OPTION_LABEL" value1="${dmDocumentTypeFieldData}" />
				<execute function="Click" locator1="DocumentsAndMediaEditCustomDocumentType#RADIO_OPTION_RADIO" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Select" />
			<then>
				<execute function="Select" locator1="DocumentsAndMediaEditCustomDocumentType#SELECT_SELECT" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Text" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#TEXT_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>

		<if>
			<equals arg1="${field}" arg2="Text Box" />
			<then>
				<execute function="Type" locator1="DocumentsAndMediaEditCustomDocumentType#TEXT_BOX_FIELD" value1="${dmDocumentTypeFieldData}" />
			</then>
		</if>
	</command>

	<command name="publishCP">
		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="Your request completed successfully." />
	</command>

	<command name="publishDraftPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_THUMBNAIL" />

		<execute function="AssertClick#assertTextClick" locator1="Button#EDIT" value1="Edit" />

		<execute function="AssertClick" locator1="Button#PUBLISH" value1="Publish" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="ratePG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_THUMBNAIL" />

		<if>
			<equals arg1="${soDocument}" arg2="true" />
			<then>
				<execute function="SikuliClick" locator1="PGDocumentsandmediaDocument#SOCIAL_OFFICE_AVERAGE_RATING_STAR_ICON_PNG" />
			</then>
			<else>
				<execute function="SikuliClick" locator1="Ratings#AVERAGE_RATING_STAR_ICON_PNG" />
			</else>
		</if>

		<execute function="SikuliClick" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_WORKFLOW_PNG" />
	</command>

	<command name="removeDocumentViewPermissionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var method="StringUtil#lowerCase('${key_roleName}')" name="key_roleName" />

		<execute function="Check" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#PERMISSIONS" value1="Permissions" />

		<execute function="SelectFrame" locator1="Permissions#PERMISSIONS_IFRAME" />
		<execute function="AssertTextEquals" locator1="Permissions#HEADER_TITLE" value1="${dmDocumentTitle}" />
		<execute function="Uncheck" locator1="Permissions#CONFIGURATION_PERMISSIONS_VIEW_CHECKBOX" />
		<execute function="AssertClick" locator1="Button#SAVE" value1="Save" />
		<execute function="AssertTextEquals" locator1="Permissions#SUCCESS_MESSAGE" value1="Your request completed successfully." />
		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="revertPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var name="key_dmDocumentVersionNumber" value="${dmDocumentVersionNumber}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#VERSION_HISTORY_TABLE_VERSION" value1="${dmDocumentVersionNumber}" />
		<execute function="Click" locator1="DocumentsAndMediaDocument#VERSION_HISTORY_TABLE_DROPDOWN" />
		<execute function="AssertClick" locator1="MenuItem#REVERT" value1="Revert" />
		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="saveAsDraftPG">
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="PGDocumentsandmediaFolder#TOOLBAR_ADD" value1="Add" />
		<execute function="AssertClick" locator1="PGDocumentsandmediaFolder#ADD_MENULIST_BASIC_DOCUMENT" value1="Basic Document" />

		<execute function="UploadCommonFile" locator1="TextInput#FILE" value1="${dmDocumentFile}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#TITLE_FIELD" value1="${dmDocumentTitle}" />
		<execute function="Type" locator1="DocumentsAndMediaEditDocument#DESCRIPTION_FIELD" value1="${dmDocumentDescription}" />
		<execute function="AssertClick" locator1="Button#SAVE_AS_DRAFT" value1="Save as Draft" />

		<execute function="AssertTextEquals" locator1="PGDocumentsandmediaFolder#SUCCESS_MESSAGE" value1="Your request completed successfully." />
	</command>

	<command name="searchCP">
		<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${dmDocumentKeyword}" />
		<execute function="AssertClick" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />
	</command>

	<command name="searchPG">
		<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${dmDocumentKeyword}" />
		<execute function="AssertClick" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#SEARCH_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="searchPGviaMG">
		<if>
			<equals arg1="${mediaGallerySearch}" arg2="Entry" />
			<then>
				<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

				<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${mgDocumentTitle}" />
				<execute function="Click" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

				<execute function="AssertTextEquals" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />
			</then>
			<elseif>
				<equals arg1="${mediaGallerySearch}" arg2="Null" />
				<then>
					<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

					<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="asdf" />
					<execute function="AssertClick" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

					<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no media files in this folder." />
				</then>
			</elseif>
			<elseif>
				<equals arg1="${mediaGallerySearch}" arg2="Quotes" />
				<then>
					<var name="quotes"><![CDATA["${mgDocumentTitle}"]]></var>
					<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

					<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${quotes}" />
					<execute function="Click" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

					<execute function="AssertTextEquals" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />
				</then>
			</elseif>
		</if>
	</command>

	<command name="showCategorization">
		<if>
			<condition function="IsElementNotPresent#isNotVisible" locator1="AssetCategorization#TAGS_FIELD" />
			<then>
				<execute function="AssertClick" locator1="PGDocumentsandmediaEditdocument#CATEGORIZATION_PANEL_COLLAPSED" value1="Categorization" />
			</then>
		</if>
	</command>

	<command name="tearDownCP">
		<execute macro="Page#gotoContentCP">
			<var name="portletName" value="Documents and Media" />
		</execute>

		<if>
			<condition function="IsElementNotPresent" locator1="Message#INFO" />
			<then>
				<execute function="Check" locator1="DocumentsAndMedia#TOOLBAR_SELECT_ALL_CHECKBOX" />
				<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="DocumentsAndMedia#TOOLBAR_ACTIONS" value1="Actions" />
				<execute function="AssertElementPresent" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" />
				<execute function="AssertClick" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
			</then>
		</if>

		<execute macro="Page#gotoContentCP">
			<var name="portletName" value="Recycle Bin" />
		</execute>

		<execute macro="RecycleBin#emptyCP" />
	</command>

	<command name="tearDownPG">
		<execute macro="Page#gotoPG">
			<var name="defaultURL" value="${defaultURL}" />
			<var name="nodePort" value="${nodePort}" />
			<var name="pageName" value="${pageName}" />
			<var name="soDashboard" value="${soDashboard}" />
			<var name="soPage" value="${soPage}" />
		</execute>

		<if>
			<condition function="IsElementPresent#isVisible" locator1="DocumentsAndMedia#ICON_DOCUMENT_THUMBNAIL_GENERIC" />
			<then>
				<execute function="Check" locator1="Checkbox#SELECT_ALL" />
				<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ACTIONS" value1="Actions" />
				<execute function="AssertElementPresent" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" />
				<execute function="AssertClick" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
				<execute function="AssertTextEquals#assertPartialText" locator1="Message#SUCCESS" value1="moved to the Recycle Bin. Undo" />
			</then>
		</if>

		<execute macro="Page#gotoContentCP">
			<var name="portletName" value="Recycle Bin" />
		</execute>

		<execute macro="RecycleBin#emptyCP" />
	</command>

	<command name="uncheckDocumentCheckboxCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="Uncheck" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
	</command>

	<command name="viewAllPG">
		<execute macro="DMDocument#viewPG">
			<var name="categoryName" value="${categoryName}" />
			<var name="dmDocumentDescription" value="${dmDocumentDescription}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="tagName" value="${tagName}" />
			<var name="tagNameList" value="${tagNameList}" />
		</execute>

		<if>
			<condition function="IsElementPresent" locator1="SODocuments#DOCUMENT_BREADCRUMBS" />
			<then>
				<execute function="AssertElementPresent" locator1="SODocuments#DOCUMENT_BREADCRUMBS" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="Button#BACK" value1="Back" />
			</else>
		</if>

		<execute macro="DMDocument#viewDocumentToolbarCmdPG" />

		<execute macro="DMDocument#viewDocumentAuthorCmdPG">
			<var name="dmDocumentAuthor" value="${dmDocumentAuthor}" />
		</execute>

		<if>
			<isset var="commentBody" />
			<then>
				<var name="key_commentBody" value="${commentBody}" />

				<execute function="AssertTextEquals" locator1="Comments#COMMENT_BODY" value1="${commentBody}" />
			</then>
			<else>
				<execute macro="DMDocument#viewDocumentNoCommentsCmdPG" />
			</else>
		</if>

		<execute macro="DMDocument#viewDocumentVersionNumberCmdPG">
			<var name="dmDocumentVersionNumber" value="${dmDocumentVersionNumber}" />
		</execute>

		<execute macro="DMDocument#viewDocumentDetailsCmdPG" />
	</command>

	<command name="viewCannotAddRepository">
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ADD" value1="Add" />

		<execute function="AssertElementNotPresent" locator1="HOME_MENULIST_ADD_REPOSITORY" />
	</command>

	<command name="viewCheckedinCP">
		<execute function="AssertVisible" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_VERSION" />
		<execute function="AssertElementNotPresent" locator1="Message#SUCCESS" />

		<if>
			<equals arg1="${sharepointRepository}" arg2="true" />
			<then>
				<execute function="AssertTextNotPresent" value1="You now have an indefinite lock on this document. No one else can edit this document until you unlock it. This lock will never expire." />
			</then>
			<else>
				<execute function="AssertTextNotPresent" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
			</else>
		</if>
	</command>

	<command name="viewCheckedoutCP">
		<execute function="AssertVisible" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_VERSION_LOCKED" />

		<if>
			<equals arg1="${sharepointRepository}" arg2="true" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#SUCCESS_MESSAGE_DOCUMENT_VIEW" value1="You now have an indefinite lock on this document. No one else can edit this document until you unlock it. This lock will never expire." />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
			</else>
		</if>
	</command>

	<command name="viewCheckedoutPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_ICON_LOCKED" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_WORKFLOW_STATUS" value1="Draft" />
		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
		<execute function="AssertClick#assertTextClick" locator1="Button#EDIT" value1="Edit" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
	</command>

	<command name="viewCP">
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />

		<if>
			<and>
				<isset var="dmDocumentSize" />
				<not>
					<contains string="${dmDocumentSize}" substring="{dmDocumentSize}" />
				</not>
			</and>
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#VERSION_HISTORY_TABLE_SIZE" value1="${dmDocumentSize}" />
			</then>
		</if>
	</command>

	<command name="viewCPStatus">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<if>
			<equals arg1="${dmDocumentStatus}" arg2="Approved" />
			<then>
				<execute function="Click" locator1="DocumentsAndMedia#TOOLBAR_DISPLAY_STYLE_BUTTON" />
				<execute function="AssertClick" locator1="MenuItem#DISPLAY_STYLE_LIST" value1="List" />
				<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_WORKFLOW_STATUS" value1="Approved" />
			</then>
			<else>
				<execute function="Click" locator1="DocumentsAndMedia#TOOLBAR_DISPLAY_STYLE_BUTTON" />
				<execute function="AssertClick" locator1="MenuItem#DISPLAY_STYLE_DESCRIPTIVE" value1="Descriptive" />
				<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_THUMBNAIL" />
				<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_WORKFLOW_STATUS" value1="${dmDocumentStatus}" />
				<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

				<execute function="AssertTextEquals" locator1="TextInput#TITLE" value1="${dmDocumentTitle}" />
			</else>
		</if>

		<execute function="Click" locator1="DocumentsAndMedia#TOOLBAR_DISPLAY_STYLE_BUTTON" />
		<execute function="AssertClick" locator1="MenuItem#DISPLAY_STYLE_ICON" value1="Icon" />
	</command>

	<command name="viewDefaultCP">
		<execute function="AssertElementNotPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_GENERIC" />
		<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />
	</command>

	<command name="viewDefaultPG">
		<execute function="AssertElementNotPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_THUMBNAIL_GENERIC" />
		<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />
	</command>

	<command name="viewDMMarketingBannerPG">
		<var name="key_assetTitle" value="${assetTitle}" />

		<execute function="AssertClick" locator1="AP#ASSET_ABSTRACT_TITLE" value1="${assetTitle}" />

		<var name="key_marketingSelect" value="${marketingSelect}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#MARKETING_SELECT" value1="${marketingSelect}" />

		<var name="key_campaignTheme" value="${campaignTheme}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#MARKETING_CAMPAIGN_THEME" value1="${campaignTheme}" />

		<var name="key_legalReview" value="${legalReview}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#MARKETING_NEEDS_LEGAL_REVIEW" value1="${legalReview}" />

		<var name="key_bannerName" value="${bannerName}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#MARKETING_BANNER_NAME" value1="${bannerName}" />

		<var name="key_bannerDescription" value="${bannerDescription}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGDocumentsandmediaDocument#MARKETING_BANNER_DESCRIPTION" value1="${bannerDescription}" />
	</command>

	<command name="viewDocumentAuthorCmdPG">
		<if>
			<not>
				<contains string="${dmDocumentAuthor}" substring="{dmDocumentAuthor}" />
			</not>
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_UPLOADED_BY" value1="${dmDocumentAuthor}" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_UPLOADED_BY" value1="Test Test" />
			</else>
		</if>
	</command>

	<command name="viewDocumentCheckoutOption">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<if>
			<equals arg1="${dmDocumentShortcut}" arg2="true" />
			<then>
				<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_SHORTCUT_ACTIONS" />
			</then>
			<elseif>
				<equals arg1="${dmDocumentShortcut}" arg2="false" />
				<then>
					<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
				</then>
			</elseif>
		</if>

		<if>
			<equals arg1="${viewCheckoutOption}" arg2="true" />
			<then>
				<execute function="AssertVisible" locator1="MenuItem#CHECKOUT" value1="Checkout" />
			</then>
			<elseif>
				<equals arg1="${viewCheckoutOption}" arg2="false" />
				<then>
					<execute function="AssertNotVisible" locator1="MenuItem#CHECKOUT" value1="Checkout" />
				</then>
			</elseif>
		</if>
	</command>

	<command name="viewDocumentDetailsCmdPG">
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DATE" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_WORKFLOW_STATUS" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DOWNLOAD_DOCUMENT" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_GET_URL_OR_WEBDAV_URL" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_AUTOMATICALLY_EXTRACTED_METADATA" value1="Automatically Extracted Metadata" />
	</command>

	<command name="viewDocumentMetadataCP">
		<var name="key_metadataData" value="${metadataData}" />
		<var name="key_metadataLabel" value="${metadataLabel}" />

		<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#DOCUMENT_EXTRACTED_METADATA_FIELD" value1="${metadataData}" />
	</command>

	<command name="viewDocumentNoCommentsCmdPG">
		<execute function="AssertTextEquals" locator1="Comments#SUBSCRIBE_TO_COMMENTS_LINK" value1="Subscribe to Comments" />
	</command>

	<command name="viewDocumentTitleCmdPG">
		<if>
			<condition function="IsElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="PGDocumentsandmediaDocument#DOCUMENT_HEADER_TITLE" value1="${dmDocumentTitle}" />
			</else>
		</if>
	</command>

	<command name="viewDocumentToolbarCmdAsGuestPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="Button#DOWNLOAD" value1="Download" />
		<execute function="AssertElementNotPresent" locator1="Button#EDIT" value1="Edit" />
		<execute function="AssertElementNotPresent" locator1="Button#MOVE" value1="Move" />
		<execute function="AssertElementNotPresent" locator1="Button#CHECKOUT" value1="Checkout" />
		<execute function="AssertElementNotPresent" locator1="Button#PERMISSIONS" value1="Permissions" />
		<execute function="AssertElementNotPresent" locator1="Button#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
	</command>

	<command name="viewDocumentToolbarCmdPG">
		<execute function="AssertTextEquals" locator1="Button#DOWNLOAD" value1="Download" />
		<execute function="AssertTextEquals" locator1="Button#EDIT" value1="Edit" />
		<execute function="AssertTextEquals" locator1="Button#MOVE" value1="Move" />
		<execute function="AssertTextEquals" locator1="Button#CHECKOUT" value1="Checkout" />
		<execute function="AssertTextEquals" locator1="Button#PERMISSIONS" value1="Permissions" />
		<execute function="AssertTextEquals" locator1="Button#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
	</command>

	<command name="viewDocumentTypePG">
		<if>
			<isset var="booleanValue" />
			<then>
				<var name="key_booleanValue" value="${booleanValue}" />

				<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#METADATA_PANEL_BOOLEAN" value1="${booleanValue}" />
			</then>
		</if>

		<if>
			<isset var="selectOption" />
			<then>
				<var name="key_selectOption" value="${selectOption}" />

				<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#METADATA_PANEL_SELECT" value1="Select ${selectOption}" />
			</then>
		</if>

		<if>
			<isset var="radioOption" />
			<then>
				<var name="key_radioOption" value="${radioOption}" />

				<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#METADATA_PANEL_RADIO" value1="${radioOption}" />
			</then>
		</if>

		<if>
			<isset var="textContent" />
			<then>
				<var name="key_textContent" value="${textContent}" />

				<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#METADATA_PANEL_TEXT" value1="${textContent}" />
			</then>
		</if>

		<if>
			<isset var="numberValue" />
			<then>
				<var name="key_numberValue" value="${numberValue}" />

				<execute function="AssertTextEquals#assertValue" locator1="DocumentsAndMediaDocument#METADATA_PANEL_NUMBER" value1="${numberValue}" />
			</then>
		</if>
	</command>

	<command name="viewDocumentVersionNumberCmdPG">
		<if>
			<not>
				<contains string="${dmDocumentVersionNumber}" substring="{dmDocumentVersionNumber}" />
			</not>
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_VERSION" value1="Version ${dmDocumentVersionNumber}" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_VERSION" value1="Version 1.0" />
			</else>
		</if>
	</command>

	<command name="viewDocumentVersionNumberPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentVersionNumberCmdPG" />
	</command>

	<command name="viewDocumentViewPermissionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var method="StringUtil#lowerCase('${key_roleName}')" name="key_roleName" />

		<execute function="Check" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#PERMISSIONS" value1="Permissions" />

		<execute function="SelectFrame" locator1="Permissions#PERMISSIONS_IFRAME" />
		<execute function="AssertTextEquals" locator1="Permissions#HEADER_TITLE" value1="${dmDocumentTitle}" />

		<if>
			<equals arg1="${viewPermissionValue}" arg2="checked" />
			<then>
				<execute function="AssertChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
			</then>
			<elseif>
				<equals arg1="${viewPermissionValue}" arg2="unchecked" />
				<then>
					<execute function="AssertNotChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
				</then>
			</elseif>
			<else>
				<execute function="AssertChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewEditCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitleEdit}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitleEdit}" />

		<var name="key_dmDocumentTitle" value="${dmDocumentTitleEdit}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitleEdit}" />
	</command>

	<command name="viewEditedDraftPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var name="key_dmDocumentVersionNumber" value="${dmDocumentVersionNumberEdit}" />

		<execute function="AssertTextPresent" locator1="DocumentsAndMedia#BREADCRUMB_HOME" value1="Home" />
		<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${dmDocumentTitle}" />
		<execute function="AssertClick" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

		<execute function="AssertClick#assertPartialTextClickAt" locator1="DocumentsAndMedia#SEARCH_TITLE" value1="${dmDocumentTitle} Draft" />

		<execute macro="DMDocument#viewDocumentToolbarCmdPG" />

		<execute macro="DMDocument#viewDocumentTitleCmdPG">
			<var name="dmDocumentTitle" value="${dmDocumentTitleEdit}" />
		</execute>

		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_THUMBNAIL" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_UPLOADED_BY" value1="${dmDocumentUploader}" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RATING" value1="Ratings" />

		<if>
			<condition function="IsElementPresent" locator1="SODocuments#VERSION_HISTORY_TITLE" />
			<then>
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_TITLE" value1="Version History" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_NUMBER" value1="Version ${dmDocumentVersionNumberEdit}" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_UPLOADER_NAME" value1="By: ${dmDocumentUploader}" />
				<execute function="AssertElementPresent" locator1="SODocuments#VERSION_HISTORY_DATE" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_SIZE" value1="Size: ${dmDocumentSizeSO}" />
			</then>
		</if>

		<execute function="AssertTextEquals" locator1="Comments#SUBSCRIBE_TO_COMMENTS_LINK" value1="Subscribe to Comments" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_VERSION" value1="Version ${dmDocumentVersionNumberEdit}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_UPLOADER" value1="Last Updated by ${dmDocumentUploader}" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_DATE" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_WORKFLOW" value1="Status: Draft" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_DOWNLOAD" value1="Download (${dmDocumentSize2})" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_URL" value1="Get URL or WebDAV URL." />
	</command>

	<command name="viewFolderViewPermissionsPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var method="StringUtil#lowerCase('${key_roleName}')" name="key_roleName" />

		<execute function="Check" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertClick" locator1="MenuItem#PERMISSIONS" value1="Permissions" />

		<execute function="SelectFrame" locator1="Permissions#PERMISSIONS_IFRAME" />
		<execute function="AssertTextEquals" locator1="Permissions#HEADER_TITLE" value1="${dmDocumentTitle}" />

		<if>
			<equals arg1="${viewPermissionValue}" arg2="checked" />
			<then>
				<execute function="AssertChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
			</then>
			<elseif>
				<equals arg1="${viewPermissionValue}" arg2="unchecked" />
				<then>
					<execute function="AssertNotChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
				</then>
			</elseif>
			<else>
				<execute function="AssertChecked" locator1="Permissions#CONTENT_PERMISSIONS_VIEW_CHECKBOX" value1="${roleName}" />
			</else>
		</if>

		<execute function="SelectFrame" value1="relative=top" />
	</command>

	<command name="viewIconLockedCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertVisible" locator1="DocumentsAndMedia#ICON_DOCUMENT_ICON_LOCKED" />
	</command>

	<command name="viewIconNotLockedCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertVisible" locator1="DocumentsAndMedia#ICON_DOCUMENT_ICON_NOT_LOCKED" />
	</command>

	<command name="viewLockPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="PGDocumentsandmediaFolder#ENTRY_ICON_FOLDER_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
		<execute function="AssertClick#assertTextClick" locator1="Button#EDIT" value1="Edit" />
		<execute function="AssertTextEquals" locator1="Message#SUCCESS" value1="You now have a lock on this document. No one else can edit this document until you unlock it. This lock will automatically expire in 1 day." />
	</command>

	<command name="viewMovedToFolderCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />
		<var name="key_dmFolderName" value="${dmFolderName}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_FOLDER_THUMBNAIL" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_FOLDER_THUMBNAIL" value1="${dmFolderName}" />
		<execute function="Click" locator1="DocumentsAndMedia#ICON_FOLDER_THUMBNAIL" value1="${dmFolderName}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#BREADCRUMB_LAST" value1="${dmFolderName}" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
	</command>

	<command name="viewOlderVersionPG">
		<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
		<var name="key_dmDocumentDescription" value="${dmDocumentDescription}" />
		<var name="key_dmDocumentVersionNumber" value="${dmDocumentVersionNumber}" />

		<execute function="Click" locator1="DocumentsAndMediaDocument#VERSION_HISTORY_TABLE_DROPDOWN" value1="${dmDocumentVersionNumber}" />
		<execute function="Click" locator1="MenuItem#VIEW" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DESCRIPTION" value1="${dmDocumentDescription}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_VERSION" value1="Version ${dmDocumentVersionNumber}" />
	</command>

	<command name="viewPG">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentTitleCmdPG">
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
		</execute>

		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_THUMBNAIL" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RATING" value1="Rating" />

		<if>
			<isset var="dmDocumentDescription" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DESCRIPTION" value1="${dmDocumentDescription}" />
			</then>
		</if>

		<if>
			<isset var="tagNameList" />
			<then>
				<for list="${tagNameList}" param="tagName">
					<execute function="AssertTextEquals#assertPartialText" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TAGS" value1="${tagName}" />
				</for>
			</then>
		</if>

		<if>
			<isset var="categoryName" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_CATEGORIES" value1="Topic: ${categoryName}" />
			</then>
		</if>
	</command>

	<command name="viewPGDetails">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertTextPresent" locator1="DocumentsAndMedia#BREADCRUMB_HOME" value1="Home" />
		<execute function="Type" locator1="NavBar#BASIC_SEARCH_FIELD" value1="${dmDocumentTitle}" />
		<execute function="AssertClick" locator1="NavBar#BASIC_SEARCH_BUTTON" value1="Search" />

		<execute function="AssertClick#assertPartialTextClickAt" locator1="DocumentsAndMedia#SEARCH_TITLE" value1="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentToolbarCmdPG" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_THUMBNAIL" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_UPLOADED_BY" value1="${dmDocumentUploader}" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RATING" value1="Ratings" />

		<if>
			<condition function="IsElementPresent" locator1="SODocuments#VERSION_HISTORY_TITLE" />
			<then>
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_TITLE" value1="Version History" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_NUMBER" value1="Version ${dmDocumentVersionNumber}" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_UPLOADER_NAME" value1="By: ${dmDocumentUploader}" />
				<execute function="AssertElementPresent" locator1="SODocuments#VERSION_HISTORY_DATE" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_SIZE" value1="Size: ${dmDocumentSizeSO}" />
				<execute function="AssertTextEquals" locator1="SODocuments#VERSION_HISTORY_CHANGE_LOG" value1="${changeLog}" />
			</then>
		</if>

		<execute function="AssertTextEquals" locator1="Comments#SUBSCRIBE_TO_COMMENTS_LINK" value1="Subscribe to Comments" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_VERSION" value1="Version ${dmDocumentVersionNumber}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_UPLOADER" value1="Last Updated by ${dmDocumentUploader}" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_DATE" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_WORKFLOW" value1="${workflow}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_DOWNLOAD" value1="Download (${dmDocumentSize})" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_DETAILS_URL" value1="Get URL or WebDAV URL." />
	</command>

	<command name="viewPGMetadata">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentTitleCmdPG">
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
		</execute>

		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_THUMBNAIL" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RATING" value1="Rating" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DESCRIPTION" value1="${dmDocumentDescription}" />
	</command>

	<command name="viewPGNonAuthor">
		<execute macro="DMDocument#viewPG">
			<var name="categoryName" value="${categoryName}" />
			<var name="dmDocumentDescription" value="${dmDocumentDescription}" />
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
			<var name="tagName" value="${tagName}" />
			<var name="tagNameList" value="${tagNameList}" />
		</execute>

		<if>
			<condition function="IsElementPresent" locator1="SODocuments#DOCUMENT_BREADCRUMBS" />
			<then>
				<execute function="AssertElementPresent" locator1="SODocuments#DOCUMENT_BREADCRUMBS" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="Button#BACK" value1="Back" />
			</else>
		</if>

		<execute function="AssertTextEquals" locator1="Button#DOWNLOAD" value1="Download" />

		<execute macro="DMDocument#viewDocumentAuthorCmdPG">
			<var name="dmDocumentAuthor" value="${dmDocumentAuthor}" />
		</execute>

		<execute macro="DMDocument#viewDocumentNoCommentsCmdPG" />

		<if>
			<isset var="dmDocumentVersionNumber" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_VERSION" value1="Version ${dmDocumentVersionNumber}" />
			</then>
			<else>
				<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_VERSION" value1="Version 1.0" />
			</else>
		</if>

		<execute macro="DMDocument#viewDocumentDetailsCmdPG" />
	</command>

	<command name="viewPGRating">
		<execute function="AssertTextEquals" locator1="Ratings#AVERAGE_LABEL" value1="Average (1 Vote)" />

		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_1" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_2" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_3" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_4" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_4" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_5" />
		<execute function="AssertElementPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_1" />
		<execute function="AssertElementNotPresent" locator1="Ratings#AVERAGE_STAR_EMPTY_2" />
	</command>

	<command name="viewPGViaAP">
		<var name="key_assetTitle" value="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="AP#ASSET_ABSTRACT_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals#assertPartialText" locator1="AP#ASSET_ABSTRACT_DESCRIPTION" value1="${dmDocumentDescription}" />

		<if>
			<condition function="IsElementPresent" locator1="Link#READ_MORE" />
			<then>
				<execute function="AssertClick#assertPartialTextClickAtAndWait" locator1="Link#READ_MORE" value1="Read More" />
				<execute function="AssertTextEquals" locator1="APAsset#ASSET_TITLE" value1="${dmDocumentTitle}" />
				<execute function="AssertTextEquals#assertPartialText" locator1="APAsset#ASSET_CONTENT" value1="${dmDocumentDescription}" />
			</then>
		</if>
	</command>

	<command name="viewPGViaMG">
		<var name="key_mgDocumentTitle" value="${mgDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="MediaGallery#ENTRY_THUMBNAIL" />
		<execute function="AssertElementPresent" locator1="MediaGallery#ENTRY_TITLE" value1="${mgDocumentTitle}" />
	</command>

	<command name="viewPGViaSearch">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute macro="DMDocument#viewDocumentTitleCmdPG">
			<var name="dmDocumentTitle" value="${dmDocumentTitle}" />
		</execute>

		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_THUMBNAIL" />
		<execute function="AssertElementPresent" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_RATING" value1="Rating" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_DESCRIPTION" value1="${dmDocumentDescription}" />
	</command>

	<command name="viewPGviaStagingLocalLive">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<if>
			<equals arg1="${documentAdded}" arg2="true" />
			<then>
				<execute function="AssertTextEquals" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
				<execute function="AssertClick" locator1="DocumentsAndMedia#LIVE_BUTTON" value1="Live" />

				<execute function="AssertTextNotPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />
				<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />
			</then>
			<elseif>
				<equals arg1="${documentAdded}" arg2="false" />
				<then>
					<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />

					<execute function="AssertClick" locator1="DocumentsAndMedia#LIVE_BUTTON" value1="Live" />
					<execute function="AssertTextEquals" locator1="Message#INFO" value1="There are no documents or media files in this folder." />
				</then>
			</elseif>
		</if>
	</command>

	<command name="viewSearchResultsCP">
		<var name="key_dmRepositoryName" value="${dmRepositoryName}" />

		<if>
			<isset var="dmRepositoryName" />
			<then>
				<execute function="AssertClick" locator1="DocumentsAndMedia#SEARCH_REPOSITORY_TAB" value1="${dmRepositoryName}" />
			</then>
		</if>

		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#SEARCH_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMedia#SEARCH_PARENT_FOLDER" value1="${dmParentFolder}" />
	</command>

	<command name="viewStagingDetailsPG">
		<execute function="Click" locator1="Toolbar#ADD" />
		<execute function="AssertTextEquals" locator1="MenuItem#FOLDER_DM" value1="Folder" />
		<execute function="AssertTextEquals" locator1="MenuItem#SHORTCUT" value1="Shortcut" />
		<execute function="AssertTextEquals" locator1="MenuItem#REPOSITORY" value1="Repository" />
		<execute function="AssertTextEquals" locator1="MenuItem#MULTIPLE_DOCUMENTS" value1="Multiple Documents" />
		<execute function="AssertTextEquals" locator1="MenuItem#BASIC_DOCUMENT" value1="Basic Document" />
		<execute function="AssertTextEquals" locator1="MenuItem#CONTRACT" value1="Contract" />
		<execute function="AssertTextEquals" locator1="MenuItem#MARKETING_BANNER" value1="Marketing Banner" />
		<execute function="AssertTextEquals" locator1="MenuItem#ONLINE_TRAINING" value1="Online Training" />
		<execute function="AssertTextEquals" locator1="MenuItem#SALES_PRESENTATION" value1="Sales Presentation" />

		<var name="key_dmDocumentTitle" value="Document_1.jpeg" />
		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertTextEquals#assertPartialText" locator1="MenuItem#DOWNLOAD" value1="Download" />
		<execute function="AssertTextEquals" locator1="MenuItem#EDIT" value1="Edit" />
		<execute function="AssertTextEquals" locator1="MenuItem#MOVE" value1="Move" />
		<execute function="AssertTextEquals" locator1="MenuItem#CHECKOUT" value1="Checkout" />
		<execute function="AssertTextEquals" locator1="MenuItem#PERMISSIONS" value1="Permissions" />
		<execute function="AssertTextEquals" locator1="MenuItem#DELETE" value1="Move to the Recycle Bin" />

		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ACTIONS" value1="Actions" />
		<execute function="AssertTextEquals" locator1="MenuItem#CANCEL_CHECKOUT" value1="Cancel Checkout" />
		<execute function="AssertTextEquals" locator1="MenuItem#CHECKIN" value1="Checkin" />
		<execute function="AssertTextEquals" locator1="MenuItem#CHECKOUT" value1="Checkout" />
		<execute function="AssertTextEquals" locator1="MenuItem#MOVE" value1="Move" />
		<execute function="AssertTextEquals" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />

		<execute macro="Page#gotoPG">
			<var name="defaultURL" value="${defaultURL}" />
			<var name="nodePort" value="${nodePort}" />
			<var name="pageName" value="Staging Test Page" />
			<var name="siteName" value="Site Name" />
			<var name="siteURL" value="true" />
			<var name="soDashboard" value="${soDashboard}" />
			<var name="soPage" value="${soPage}" />
		</execute>

		<execute function="AssertElementNotPresent" locator1="Toolbar#ADD" />
		<execute function="Click#makeVisibleClickAt" locator1="DocumentsAndMedia#ICON_DOCUMENT_ACTIONS" />
		<execute function="AssertTextEquals#assertPartialText" locator1="MenuItem#DOWNLOAD" value1="Download" />
		<execute function="AssertTextEquals" locator1="MenuItem#DELETE" value1="Move to the Recycle Bin" />
		<execute function="Click" locator1="DocumentsAndMedia#ICON_DOCUMENT_CHECKBOX" />
		<execute function="AssertClick#waitForDMHomeAssertTextEqualsClick" locator1="Toolbar#ACTIONS" value1="Actions" />
		<execute function="AssertTextEquals" locator1="MenuItem#MOVE_TO_THE_RECYCLE_BIN" value1="Move to the Recycle Bin" />
	</command>

	<command name="viewWithWorkflowCP">
		<var name="key_dmDocumentTitle" value="${dmDocumentTitle}" />

		<execute function="AssertElementPresent" locator1="DocumentsAndMedia#ICON_DOCUMENT" />
		<execute function="AssertClick" locator1="DocumentsAndMedia#ICON_DOCUMENT_TITLE" value1="${dmDocumentTitle}" />

		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_TITLE" value1="${dmDocumentTitle}" />
		<execute function="AssertTextEquals" locator1="DocumentsAndMediaDocument#DOCUMENT_INFO_WORKFLOW_STATUS" value1="${workflowStatus}" />
	</command>
</definition>