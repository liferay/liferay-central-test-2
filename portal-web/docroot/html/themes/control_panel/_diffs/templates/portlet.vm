#set ($portlet_display = $portletDisplay)

#set ($portlet_id = $htmlUtil.escapeAttribute($portlet_display.getId()))
#set ($portlet_title = $portlet_display.getTitle())
#set ($portlet_title_icon_css_class = "")
#set ($portlet_description = $portlet_display.getDescription())
#set ($portlet_description_css_class = "portlet-description lfr-message-help")
#set ($portlet_back_url = $htmlUtil.escapeAttribute($portlet_display.getURLBack()))
#set ($enable_portlet_descriptions = $sessionClicks.get($request, "enable-portlet-descriptions", "1"))
#set ($show_portlet_description = $enable_portlet_descriptions == "1" && $sessionClicks.get($request, "show-portlet-description-$portlet_id", "1") == "1")
#set ($valid_portlet_description = $validator.isNotNull($portlet_description) && $portlet_description.indexOf('javax.portlet.description') == -1)

#if ($show_portlet_description)
	#set ($portlet_title_icon_css_class = "aui-helper-hidden")
#else
	#set ($portlet_description_css_class = "${portlet_description_css_class} aui-helper-hidden")
#end

<section class="portlet" id="portlet_$portlet_id">
	<header class="portlet-topper">
		<h1 class="portlet-title" id="cpPortletTitle">
			<span class="portlet-title-text">$portlet_title</span>

			#if ($valid_portlet_description)
				<img class="$portlet_title_icon_css_class" id="cpPortletTitleHelpIcon" src="$themeDisplay.getPathThemeImages()/portlet/help.png" />
			#end
		</h1>

		#if ($valid_portlet_description)
			<div class="$portlet_description_css_class" data-portlet-id="$portlet_id" data-visible-panel="$show_portlet_description" id="cpContextPanelTemplate">
				$portlet_description
			</div>
		#end

		<menu class="portlet-topper-toolbar" id="portlet-topper-toolbar_$portlet_id" type="portlet-topper-toolbar">
			#if ($portlet_display.isShowBackIcon())
				<a class="portlet-icon-back" href="$portlet_back_url">#language ("return-to-full-page")</a>
			#else
				$theme.iconOptions()
			#end
		</menu>
	</header>

	<div class="portlet-content">
		$portlet_display.writeContent($writer)
	</div>
</section>