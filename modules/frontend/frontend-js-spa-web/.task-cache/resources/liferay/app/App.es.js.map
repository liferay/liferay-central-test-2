{"version":3,"sources":["/source/App.es.js"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAQM;;;AACL,WADK,UACL,GAAc;yBADT,YACS;;gDACb,iBADa;;AAGb,SAAK,SAAL,GAAiB,EAAjB,CAHa;;AAKb,OAAI,qBAAqB,yEAArB,CALS;;AAOb,SAAK,eAAL,CAAqB,SAAS,kBAAT,CAArB,CAPa;AAQb,SAAK,eAAL,CAAqB,MAAM,kBAAN,CAArB,CARa;;AAUb,SAAK,EAAL,CAAQ,gBAAR,EAA0B,MAAK,gBAAL,CAA1B,CAVa;AAWb,SAAK,EAAL,CAAQ,aAAR,EAAuB,MAAK,aAAL,CAAvB,CAXa;AAYb,SAAK,EAAL,CAAQ,eAAR,EAAyB,MAAK,eAAL,CAAzB,CAZa;;AAcb,WAAQ,EAAR,CAAW,aAAX,EAA0B,MAAK,mBAAL,OAA1B,EAda;;AAgBb,SAAK,WAAL,CAAiB,SAAS,IAAT,CAAc,EAAd,CAAjB,CAhBa;;AAkBb,iBAAI,MAAJ,CAAW,SAAS,IAAT,EAAe,6CAA1B,EAlBa;;GAAd;;AADK,uBAsBL,6CAAiB,OAAO;AACvB,WAAQ,IAAR,CACC,gBADD,EAEC;AACC,SAAK,IAAL;AACA,UAAM,MAAM,IAAN;IAJR,EADuB;;;AAtBnB,uBAgCL,mDAAoB,OAAO;AAC1B,OAAI,cAAc,KAAd,CADsB;;AAG1B,UAAO,IAAP,CAAY,KAAK,SAAL,CAAZ,CAA4B,GAA5B,CACC,UAAC,SAAD,EAAe;AACd,QAAI,aAAa,gBAAM,oBAAN,CAA2B,SAA3B,CAAb,CADU;AAEd,QAAI,WAAW,SAAS,gBAAT,CAA0B,WAAW,UAAX,GAAyB,IAAzB,CAArC,CAFU;;AAId,UAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,QAA3B,EAAqC,OAArC,CACC,UAAC,OAAD,EAAa;AACZ,SAAI,cAAI,QAAJ,CAAa,OAAb,EAAsB,MAAM,cAAN,CAA1B,EAAiD;AAChD,oBAAc,IAAd,CADgD;AAEhD,aAFgD;MAAjD;KADD,CADD,CAJc;IAAf,CADD,CAH0B;;AAmB1B,OAAI,WAAJ,EAAiB;AAChB,WADgB;IAAjB;;AAIA,kBAAM,mBAAN,YAA0B,KAA1B,EAvB0B;;;AAhCtB,uBA0DL,uCAAc,OAAO;AACpB,WAAQ,IAAR,CACC,aADD,EAEC;AACC,SAAK,IAAL;AACA,WAAO,MAAM,KAAN;AACP,UAAM,MAAM,IAAN;IALR,EADoB;;AAUpB,OAAI,CAAC,MAAM,KAAN,IAAe,QAAQ,MAAR,IAAkB,QAAQ,IAAR,CAAa,YAAb,EAA2B;AAChE,YAAQ,MAAR,CAAe,IAAf,GADgE;IAAjE;;AAIA,OAAI,MAAM,IAAN,EAAY;AACf,SAAK,iBAAL,GADe;IAAhB;;AAIA,iBAAI,aAAJ,CAAkB,SAAS,IAAT,EAAe,qBAAjC,EAlBoB;;;AA1DhB,uBA+EL,qDAAsB;AACrB,QAAK,iBAAL,GADqB;;;AA/EjB,uBAmFL,2CAAgB,OAAO;AACtB,WAAQ,IAAR,CACC,eADD,EAEC;AACC,SAAK,IAAL;AACA,UAAM,MAAM,IAAN;IAJR,EADsB;;AAStB,iBAAI,UAAJ,CAAe,SAAS,IAAT,EAAe,qBAA9B,EATsB;;;AAnFlB,uBA+FL,qCAAa,WAAW;AACvB,QAAK,SAAL,GAAiB,SAAjB,CADuB;;;SA/FnB;;;;mBAoGS","sourcesContent":["'use strict';\r\n\r\nimport App from 'senna/src/app/App';\r\nimport dom from 'metal-dom/src/dom'\r\nimport Uri from 'metal-uri/src/Uri'\r\nimport globals from 'senna/src/globals/globals'\r\nimport Utils from '../util/Utils.es';\r\n\r\nclass LiferayApp extends App {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.blacklist = {};\r\n\r\n\t\tvar exceptionsSelector = ':not([target=\"_blank\"]):not([data-senna-off]):not([data-resource-href])';\r\n\r\n\t\tthis.setFormSelector('form' + exceptionsSelector);\r\n\t\tthis.setLinkSelector('a' + exceptionsSelector);\r\n\r\n\t\tthis.on('beforeNavigate', this.onBeforeNavigate);\r\n\t\tthis.on('endNavigate', this.onEndNavigate);\r\n\t\tthis.on('startNavigate', this.onStartNavigate);\r\n\r\n\t\tLiferay.on('io:complete', this.onLiferayIOComplete, this);\r\n\r\n\t\tthis.addSurfaces(document.body.id);\r\n\r\n\t\tdom.append(document.body, '<div class=\"lfr-surface-loading-bar\"></div>');\r\n\t}\r\n\r\n\tonBeforeNavigate(event) {\r\n\t\tLiferay.fire(\r\n\t\t\t'beforeNavigate',\r\n\t\t\t{\r\n\t\t\t\tapp: this,\r\n\t\t\t\tpath: event.path\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tonDocClickDelegate_(event) {\r\n\t\tvar inBlacklist = false;\r\n\r\n\t\tObject.keys(this.blacklist).map(\r\n\t\t\t(portletId) => {\r\n\t\t\t\tvar boundaryId = Utils.getPortletBoundaryId(portletId);\r\n\t\t\t\tvar portlets = document.querySelectorAll('[id^=\"' + boundaryId +  '\"]');\r\n\r\n\t\t\t\tArray.prototype.slice.call(portlets).forEach(\r\n\t\t\t\t\t(portlet) => {\r\n\t\t\t\t\t\tif (dom.contains(portlet, event.delegateTarget)) {\r\n\t\t\t\t\t\t\tinBlacklist = true;\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif (inBlacklist) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsuper.onDocClickDelegate_(event);\r\n\t}\r\n\r\n\tonEndNavigate(event) {\r\n\t\tLiferay.fire(\r\n\t\t\t'endNavigate',\r\n\t\t\t{\r\n\t\t\t\tapp: this,\r\n\t\t\t\terror: event.error,\r\n\t\t\t\tpath: event.path\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif (!event.error && Liferay.Layout && Liferay.Data.layoutConfig) {\r\n\t\t\tLiferay.Layout.init();\r\n\t\t}\r\n\r\n\t\tif (event.form) {\r\n\t\t\tthis.clearScreensCache();\r\n\t\t}\r\n\r\n\t\tdom.removeClasses(document.body, 'lfr-surface-loading');\r\n\t}\r\n\r\n\tonLiferayIOComplete() {\r\n\t\tthis.clearScreensCache();\r\n\t}\r\n\r\n\tonStartNavigate(event) {\r\n\t\tLiferay.fire(\r\n\t\t\t'startNavigate',\r\n\t\t\t{\r\n\t\t\t\tapp: this,\r\n\t\t\t\tpath: event.path\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tdom.addClasses(document.body, 'lfr-surface-loading');\r\n\t}\r\n\r\n\tsetBlacklist(blacklist) {\r\n\t\tthis.blacklist = blacklist;\r\n\t}\r\n}\r\n\r\nexport default LiferayApp;"]}