task jar(type: Jar, overwrite: true)

dependencies {
	compile group: "org.apache.felix", name: "org.apache.felix.configadmin", transitive: false, version: "1.8.8"
}

jar {
	exclude "OSGI-INF/permissions.perm"
	includeEmptyDirs = false

	from zipTree(
		{
			configurations.compile.singleFile
		})

	manifest {
		from {
			copy {
				from zipTree(configurations.compile.singleFile)
				include "META-INF/MANIFEST.MF"
				into temporaryDir
			}

			new File(temporaryDir, "META-INF/MANIFEST.MF")
		}
	}
}