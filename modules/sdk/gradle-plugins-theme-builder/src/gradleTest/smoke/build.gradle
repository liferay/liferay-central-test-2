apply plugin: "com.liferay.portal.tools.theme.builder"

task runGradleTest

repositories {
	mavenLocal()

	maven {
		url "https://cdn.lfrs.sl/repository.liferay.com/nexus/content/groups/public"
	}
}

runGradleTest {
	dependsOn buildTheme

	doLast {
		File generatedCustomCssFile = file("build/buildTheme/css/_custom.scss")
		File expectedCustomCssFile = file("src/main/webapp/css/_custom.scss")

		assert expectedCustomCssFile.text.normalize() == generatedCustomCssFile.text.normalize()

		String[] fileNames = [
			"build/buildTheme/WEB-INF/liferay-look-and-feel.xml",
			"build/buildTheme/css/main.scss",
			"build/buildTheme/images/screenshot.png",
			"build/buildTheme/images/thumbnail.png",
			"build/buildTheme/js/main.js",
			"build/buildTheme/templates/init.ftl"
		]

		for (String fileName in fileNames) {
			File generatedFile = file(fileName)

			assert generatedFile.exists()
		}
	}
}