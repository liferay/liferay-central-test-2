{"version":3,"sources":["/source/Dropdown.js"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nimport { core, object } from 'metal';\nimport dom from 'metal-dom';\nimport { Align } from 'metal-position';\nimport DropdownBase from './Dropdown.soy';\nimport { EventHandler } from 'metal-events';\n\n/**\n * Dropdown component.\n */\nclass Dropdown extends DropdownBase {\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(opt_config) {\n\t\tsuper(opt_config);\n\t\tthis.eventHandler_ = new EventHandler();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tattached() {\n\t\tsuper.attached();\n\t\tthis.eventHandler_.add(dom.on(document, 'click', this.handleDocClick_.bind(this)));\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdetached() {\n\t\tsuper.detached();\n\t\tthis.eventHandler_.removeAllListeners();\n\t}\n\n\t/**\n\t * Closes the dropdown.\n\t */\n\tclose() {\n\t\tthis.expanded = false;\n\t}\n\n\t/**\n\t * Checks if the dropdown is currently open.\n\t * @return {boolean}\n\t */\n\tisOpen() {\n\t\treturn this.expanded;\n\t}\n\n\t/**\n\t * Handles document click in order to hide menu.\n\t * @param {!Event} event\n\t * @protected\n\t */\n\thandleDocClick_(event) {\n\t\tif (this.element.contains(event.target)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.close();\n\t}\n\n\t/**\n\t * Opens the dropdown.\n\t */\n\topen() {\n\t\tthis.expanded = true;\n\t}\n\n\t/**\n\t * The setter function for the `classMap` attribute.\n\t * @param {Object} val\n\t * @return {!Object}\n\t * @protected\n\t */\n\tsetterClassMapFn_(val) {\n\t\treturn object.mixin(this.valueClassMapFn_(), val);\n\t}\n\n\t/**\n\t * The setter function for the `position` attribute. Converts the supported\n\t * string positions into the appropriate `Align` position constants.\n\t * @param {string|number} val\n\t * @return {number}\n\t * @protected\n\t */\n\tsetterPositionFn_(val) {\n\t\tif (core.isNumber(val)) {\n\t\t\treturn val;\n\t\t}\n\t\treturn val.toLowerCase() === 'up' ? Align.TopLeft : Align.BottomLeft;\n\t}\n\n\t/**\n\t * Synchronization logic for `expanded` attribute.\n\t * @param {boolean} expanded\n\t */\n\tsyncExpanded(expanded) {\n\t\tif (expanded) {\n\t\t\tdom.addClasses(this.element, 'open');\n\t\t\tif (this.alignElementSelector) {\n\t\t\t\tvar alignElement = this.element.querySelector(this.alignElementSelector);\n\t\t\t\tif (alignElement) {\n\t\t\t\t\tvar bodyElement = this.getRenderer().getSurfaceElement('body');\n\t\t\t\t\tvar position = Align.align(bodyElement, alignElement, this.position);\n\t\t\t\t\tthis.updatePositionCss_(position);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tdom.removeClasses(this.element, 'open');\n\t\t}\n\t}\n\n\t/**\n\t * Synchronization logic for `position` attribute.\n\t * @param {string} position\n\t */\n\tsyncPosition(position) {\n\t\tthis.updatePositionCss_(position);\n\t}\n\n\t/**\n\t * Toggles the dropdown, closing it when open or opening it when closed.\n\t */\n\ttoggle() {\n\t\tthis.expanded = !this.expanded;\n\t}\n\n\t/**\n\t * Updates the component's css class according to the position it's aligned to.\n\t * @param {string} position\n\t * @protected\n\t */\n\tupdatePositionCss_(position) {\n\t\tvar element = this.element;\n\t\tif (this.positionClassOnMenu) {\n\t\t\telement = element.querySelector('.dropdown-menu');\n\t\t}\n\t\tif (this.alignedPosition_) {\n\t\t\tdom.removeClasses(element, this.classMap[this.alignedPosition_]);\n\t\t}\n\t\tdom.addClasses(element, this.classMap[position]);\n\t\tthis.alignedPosition_ = position;\n\t}\n\n\t/**\n\t * Validator for the `position` attribute.\n\t * @param {string|number} position\n\t * @return {boolean}\n\t * @protected\n\t */\n\tvalidatePosition_(position) {\n\t\tif (Align.isValidPosition(position)) {\n\t\t\treturn true;\n\t\t}\n\t\tswitch (position.toLowerCase()) {\n\t\t\tcase 'up':\n\t\t\tcase 'down':\n\t\t\t\treturn true;\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Gets the default value for the `body` attribute. Retrieves existing\n\t * html for the body from the element, if there is any.\n\t * @return {?string}\n\t * @protected\n\t */\n\tvalueBodyFn_() {\n\t\tvar dropdownMenu = this.element && this.element.querySelector('.dropdown-menu');\n\t\treturn dropdownMenu ? dropdownMenu.innerHTML : '';\n\t}\n\n\t/**\n\t * Gets the default value for the `classMap` attribute.\n\t * @return {!Object}\n\t * @protected\n\t */\n\tvalueClassMapFn_() {\n\t\treturn {\n\t\t\t[Align.TopLeft]: 'dropup',\n\t\t\t[Align.TopCenter]: 'dropup',\n\t\t\t[Align.TopRight]: 'dropup',\n\t\t\t[Align.BottomLeft]: 'dropdown',\n\t\t\t[Align.BottomCenter]: 'dropdown',\n\t\t\t[Align.BottomRight]: 'dropdown',\n\t\t\t[Align.RightCenter]: 'dropright',\n\t\t\t[Align.LeftCenter]: 'dropleft'\n\t\t};\n\t}\n\n\t/**\n\t * Gets the default value for the `header` attribute. Retrieves existing\n\t * html for the header from the element, if there is any.\n\t * @return {?string}\n\t * @protected\n\t */\n\tvalueHeaderFn_() {\n\t\tif (this.element) {\n\t\t\tvar wrapper = document.createElement('div');\n\t\t\tfor (var i = 0; i < this.element.childNodes.length; i++) {\n\t\t\t\tif (dom.hasClass(this.element.childNodes[i], 'dropdown-menu')) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\twrapper.appendChild(this.element.childNodes[i].cloneNode(true));\n\t\t\t}\n\t\t\treturn wrapper.innerHTML;\n\t\t}\n\t\treturn '';\n\t}\n}\n\n/**\n * Attrbutes definition.\n * @type {!Object}\n * @static\n */\nDropdown.ATTRS = {\n\t/**\n\t * Optional selector for finding the element that the dropdown should be\n\t * aligned to. If given, the dropdown will automatically find the best position\n\t * to align, when the specified position doesn't work. Otherwise it will\n\t * always just follow the given position, even if it's not ideal.\n\t * @type {string}\n\t */\n\talignElementSelector: {\n\t\tvalidator: core.isString\n\t},\n\n\t/**\n\t * The dropdown's body content.\n\t * @type {string}\n\t */\n\tbody: {\n\t\tisHtml: true,\n\t\tvalueFn: 'valueBodyFn_'\n\t},\n\n\t/**\n\t * A map from `Align` position constants to the CSS class that should be\n\t * added to the dropdown when it's aligned in that position.\n\t * @type {!Object}\n\t */\n\tclassMap: {\n\t\tsetter: 'setterClassMapFn_',\n\t\tvalidator: core.isObject,\n\t\tvalueFn: 'valueClassMapFn_'\n\t},\n\n\t/**\n\t * The dropdown's header content.\n\t * @type {string}\n\t */\n\theader: {\n\t\tisHtml: true,\n\t\tvalueFn: 'valueHeaderFn_'\n\t},\n\n\t/**\n\t * Flag indicating if the dropdown is expanded (open) or not.\n\t * @type {boolean}\n\t * @default false\n\t */\n\texpanded: {\n\t\tvalue: false\n\t},\n\n\t/**\n\t * The position of the dropdown (either 'up', 'down' or any of the position\n\t * constants available in `Align`).\n\t * @type {string|number}\n\t * @default Align.BottomLeft\n\t */\n\tposition: {\n\t\tsetter: 'setterPositionFn_',\n\t\tvalue: Align.BottomLeft,\n\t\tvalidator: 'validatePosition_'\n\t},\n\n\t/**\n\t * Flag indicating if the position class (specified by `classMap` attribute)\n\t * should be added on the \"dropdown-menu\" element, instead of the main element.\n\t * @type {boolean}\n\t */\n\tpositionClassOnMenu: {\n\t\tvalue: false\n\t}\n};\n\n/**\n * Default dropdown elementClasses.\n * @default dropdown\n * @type {string}\n * @static\n */\nDropdown.ELEMENT_CLASSES = 'dropdown';\n\nexport default Dropdown;\nimport JQueryAdapter from 'metal-jquery-adapter/src/JQueryAdapter';JQueryAdapter.register('dropdown', Dropdown);"]}