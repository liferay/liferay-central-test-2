{"version":3,"sources":["/source/Affix.js"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nimport core from 'metal';\nimport { dom, DomEventEmitterProxy } from 'metal-dom';\nimport Attribute from 'metal-attribute';\nimport EventEmitter from 'metal-events';\nimport Position from 'metal-position';\n\n/**\n * Affix utility.\n */\nclass Affix extends Attribute {\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(opt_config) {\n\t\tsuper(opt_config);\n\n\t\tif (!Affix.emitter_) {\n\t\t\tAffix.emitter_ = new EventEmitter();\n\t\t\tAffix.proxy_ = new DomEventEmitterProxy(document, Affix.emitter_, null, {\n\t\t\t\tscroll: true\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Holds the last position.\n\t\t * @type {Position.Bottom|Position.Default|Position.Top}\n\t\t * @private\n\t\t */\n\t\tthis.lastPosition_ = null;\n\n\t\t/**\n\t\t * Holds event handle that listens scroll shared event emitter proxy.\n\t\t * @type {EventHandle}\n\t\t * @protected\n\t\t */\n\t\tthis.scrollHandle_ = Affix.emitter_.on('scroll', this.checkPosition.bind(this));\n\n\t\tthis.on('elementChanged', this.checkPosition);\n\t\tthis.on('offsetTopChanged', this.checkPosition);\n\t\tthis.on('offsetBottomChanged', this.checkPosition);\n\t\tthis.checkPosition();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdisposeInternal() {\n\t\tdom.removeClasses(this.element, Affix.Position.Bottom + ' ' + Affix.Position.Default + ' ' + Affix.Position.Top);\n\t\tthis.scrollHandle_.dispose();\n\t\tsuper.disposeInternal();\n\t}\n\n\t/**\n\t * Synchronize bottom, top and element regions and checks if position has\n\t * changed. If position has changed syncs position.\n\t */\n\tcheckPosition() {\n\t\tif (this.intersectTopRegion()) {\n\t\t\tthis.syncPosition(Affix.Position.Top);\n\t\t} else if (this.intersectBottomRegion()) {\n\t\t\tthis.syncPosition(Affix.Position.Bottom);\n\t\t} else {\n\t\t\tthis.syncPosition(Affix.Position.Default);\n\t\t}\n\t}\n\n\t/**\n\t * Whether the element is intersecting with bottom region defined by\n\t * offsetBottom.\n\t * @return {boolean}\n\t */\n\tintersectBottomRegion() {\n\t\tif (!core.isDef(this.offsetBottom)) {\n\t\t\treturn false;\n\t\t}\n\t\tvar clientHeight = Position.getHeight(this.scrollElement);\n\t\tvar scrollElementClientHeight = Position.getClientHeight(this.scrollElement);\n\t\treturn Position.getScrollTop(this.scrollElement) + scrollElementClientHeight >= clientHeight - this.offsetBottom;\n\t}\n\n\t/**\n\t * Whether the element is intersecting with top region defined by\n\t * offsetTop.\n\t * @return {boolean}\n\t */\n\tintersectTopRegion() {\n\t\tif (!core.isDef(this.offsetTop)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Position.getScrollTop(this.scrollElement) <= this.offsetTop;\n\t}\n\n\t/**\n\t * Synchronizes element css classes to match with the specified position.\n\t * @param {Position.Bottom|Position.Default|Position.Top} position\n\t */\n\tsyncPosition(position) {\n\t\tif (this.lastPosition_ !== position) {\n\t\t\tdom.addClasses(this.element, position);\n\t\t\tdom.removeClasses(this.element, this.lastPosition_);\n\t\t\tthis.lastPosition_ = position;\n\t\t}\n\t}\n}\n\n/**\n * Holds positions enum.\n * @enum {string}\n */\nAffix.Position = {\n\tTop: 'affix-top',\n\tBottom: 'affix-bottom',\n\tDefault: 'affix'\n};\n\nAffix.ATTRS = {\n\t/**\n\t * The scrollElement element to be used as scrollElement area for affix. The scrollElement is\n\t * where the scroll event is listened from.\n\t * @type {Element|Window}\n\t */\n\tscrollElement: {\n\t\tsetter: dom.toElement,\n\t\tvalue: document\n\t},\n\n\t/**\n\t * Defines the offset bottom that triggers affix.\n\t * @type {number}\n\t */\n\toffsetTop: {\n\t\tvalidator: core.isNumber\n\t},\n\n\t/**\n\t * Defines the offset top that triggers affix.\n\t * @type {number}\n\t */\n\toffsetBottom: {\n\t\tvalidator: core.isNumber\n\t},\n\n\t/**\n\t * Element to be used as alignment reference of affix.\n\t * @type {Element}\n\t */\n\telement: {\n\t\tsetter: dom.toElement\n\t}\n};\n\nexport default Affix;\nimport JQueryAdapter from 'metal-jquery-adapter/src/JQueryAdapter';JQueryAdapter.register('affix', Affix);"]}