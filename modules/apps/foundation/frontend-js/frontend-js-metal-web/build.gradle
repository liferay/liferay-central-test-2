configJSModules {
	dependsOn transpileJS
	include "**/*.js*"
	moduleFormat "/.soy/g,.soy.js"

	doLast {
		FileTree jsFileTree = fileTree(dir: "classes/META-INF/resources", include: "**/*.js")

		jsFileTree.each {
			File jsFile ->

			jsFile.text = jsFile.text.replace("define(", "Liferay.Loader.define(")
		}
	}
}

transpileJS {
	skipWhenEmpty = false
	sourceDir = npmInstall.nodeModulesDir
	srcIncludes = "metal*/src/**/*.js"
}