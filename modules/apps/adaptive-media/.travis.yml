language: java
install: /bin/true
sudo: false

jdk:
  - oraclejdk8

install:
  - ./scripts/install_bundle.sh
  - ./gradlew setupTestableTomcat

script:
  - ./scripts/run_unit_tests.sh
  - ../bundles/tomcat-8.0.32/bin/startup.sh
  - ./scripts/deploy_modules.sh
  - travis_wait ./scripts/wait_until_startup.sh
  - cd adaptive-media-image-test && ../gradlew clean testIntegration

after_success:
  - cd .. && ./gradlew coveralls
